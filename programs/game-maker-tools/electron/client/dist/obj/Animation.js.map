{"version":3,"sources":["../../../ecma/obj/Animation.js"],"names":["Animation","args","_anime","name","$Q","getArg","description","frames","image","GameImage","src","domElement","type","delay","cix","frameSize","Vector3","frameBounds","VectorFrameBounds","frameOffset","apply2DFrames","parent","flipX","priority","selected_frame","earlyTerm","hang","duration","size","effects","timer","__gameLogic","setType","__frametype","framePos","x","y","key","fallback","hasOwnProperty","fcount","quitLoop","min","max","push","termPoint","Math","round","length","resetFrames","update","engage","complete","__inst","tween","TWEEN","Tween","easing","curve","Easing","Linear","None","to","onUpdate","onComplete","isComplete","start","fun","Quazar","log"],"mappings":"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","file":"Animation.js","sourcesContent":["/**\r\n * Created by The Blakes on 04-13-2017\r\n *\r\n */\r\n\r\n\r\n\r\nclass Animation {\r\n    constructor(args) {\r\n\r\n        args = args || {};\r\n\r\n        var _anime = this;\r\n\r\n        this.name = $Q.getArg(args, 'name', '_blank'),\r\n\r\n        this.description =  $Q.getArg(args, 'description', '_blank')\r\n\r\n        this.frames = $Q.getArg(args, 'frames', []);\r\n\r\n        this.image = new GameImage( $Q.getArg(args, 'src',  $Q.getArg(args, 'image', false)));\r\n\r\n\r\n        this.src = this.image.domElement.src;\r\n\r\n        this.domElement = this.image.domElement;\r\n\r\n        this.type = $Q.getArg(args, 'type', 'basic');\r\n\r\n        this.delay = $Q.getArg(args, 'delay', 0);\r\n\r\n        this.cix = 0;\r\n\r\n        this.frameSize = this.getArg(args, 'frameSize', new Vector3(0, 0, 0));\r\n\r\n        this.frameBounds = this.getArg(args, 'frameBounds', new VectorFrameBounds(new Vector3(0, 0, 0), new Vector3(0, 0, 0), new Vector3(0, 0, 0)));\r\n\r\n        this.frameOffset = this.getArg(args, 'frameOffset', new Vector3(0, 0, 0));\r\n\r\n\r\n        this.apply2DFrames(args.parent || {});\r\n\r\n        this.flipX = $Q.getArg(args, 'flipX', false);\r\n\r\n        this.priority = $Q.getArg(args, 'priority', 0);\r\n\r\n        this.cix = 0;\r\n\r\n        this.selected_frame = this.frames[0];\r\n\r\n        this.earlyTerm = this.getArg(args, 'earlyTerm', false);\r\n\r\n        this.hang =this.getArg(args, 'hang', false);\r\n\r\n        this.duration = this.getArg(args, 'duration', 1000);\r\n\r\n        this.size =  this.getArg(args, 'size', new Vector3(20, 20, 20));\r\n\r\n        this.effects = [];\r\n\r\n        this.timer = 0;\r\n\r\n        this.__gameLogic = false;\r\n\r\n        this.setType = function(){  };\r\n\r\n    }\r\n\r\n    singleFrame(frameSize, size)\r\n    {\r\n\r\n        this.__frametype = 'single';\r\n\r\n        this.frameSize = frameSize;\r\n\r\n        this.size = size;\r\n\r\n        this.selected_frame = {\r\n            image: this.image,\r\n            frameSize: this.frameSize,\r\n            framePos: {x: 0, y: 0}\r\n        };\r\n\r\n        this.frames[0] = this.selected_frame;\r\n\r\n\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n        if (args.hasOwnProperty(key)) {\r\n\r\n            return args[key];\r\n\r\n        }\r\n        else {\r\n            return fallback;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    apply2DFrames() {\r\n\r\n        this.frames = [];\r\n\r\n        var fcount = 0;\r\n\r\n\r\n        var quitLoop = false;\r\n\r\n        for (let y = this.frameBounds.min.y; y <= this.frameBounds.max.y; y++) {\r\n\r\n            for (let x = this.frameBounds.min.x; x <= this.frameBounds.max.x; x++) {\r\n\r\n                let framePos = {x: x * this.frameSize.x + this.frameOffset.x, y: y * this.frameSize.y + this.frameOffset.y};\r\n\r\n                this.frames.push({image: this.image, frameSize: this.frameSize, framePos: framePos});\r\n\r\n                if( x >= this.frameBounds.termPoint.x && y >= this.frameBounds.termPoint.y)\r\n                {\r\n\r\n                    quitLoop = true;\r\n\r\n                    break;\r\n                }\r\n\r\n                fcount += 1;\r\n\r\n                if(quitLoop)\r\n                    break;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        this.frames[0] = !this.frames[0] ? {\r\n                image: this.image,\r\n                frameSize: this.frameSize,\r\n                framePos: {x: this.frameBounds.min.x, y: this.frameBounds.min.y}\r\n            } : this.frames[0];\r\n\r\n       // this.selected_frame = this.frames[this.cix % this.frames.length] || this.frames[0];\r\n\r\n    }\r\n\r\n    resetFrames() //special reset function:: frames are re-rendered each reset()\r\n    {\r\n\r\n        this.apply2DFrames();\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        this.selected_frame = this.frames[Math.round(this.cix) % this.frames.length];\r\n\r\n\r\n    }\r\n\r\n    reset()\r\n{\r\n\r\n    this.resetFrames();\r\n\r\n    this.cix = 0;\r\n\r\n}\r\n\r\ncontinuous(duration)\r\n{\r\n\r\n    if(this.__frametype == 'single')\r\n    {\r\n        return 0;\r\n\r\n    }\r\n\r\n  this.apply2DFrames();\r\n\r\n    //update once:\r\n    this.update();\r\n\r\n\r\n    if(this.cix == 0)\r\n  {\r\n\r\n      this.engage();\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\nengage(duration, complete)\r\n{\r\n\r\n    if(this.__frametype == 'single')\r\n    {\r\n        return 0;\r\n\r\n    }\r\n\r\n\r\n    let __inst = this;\r\n\r\n    this.complete = complete || this.complete || function(){  };\r\n\r\n    var duration = duration || typeof(this.duration) == 'number' ? this.duration : this.frames.length * 20;\r\n\r\n    //we have a target\r\n  this.tween = new TWEEN.Tween(this)\r\n        .easing(__inst.curve || TWEEN.Easing.Linear.None)\r\n\r\n        .to({cix:__inst.frames.length - 1}, duration)\r\n        .onUpdate(function() {\r\n            //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n         //   __inst.cix = Math.ceil(__inst.cix);\r\n\r\n        __inst.update();\r\n\r\n        })\r\n        .onComplete(function() {\r\n            //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n            if(__inst.complete)\r\n            {\r\n\r\n                __inst.complete();\r\n\r\n            }\r\n\r\n            __inst.cix = 0;\r\n\r\n            __inst.isComplete = true;\r\n\r\n        });\r\n\r\n\r\n  this.tween.start();\r\n\r\n\r\n}\r\n\r\nonComplete(fun)\r\n{\r\n    this.complete = fun;\r\n\r\n}\r\n\r\n    animate() {\r\n\r\n        this.apply2DFrames();\r\n\r\n        this.timer += 1;\r\n\r\n        Quazar.log('ANIMATING with frame count:' + this.frames.length);\r\n\r\n        if(this.timer % this.delay == 0) {\r\n\r\n            if(this.hang)\r\n            {\r\n                this.cix = this.cix + 1;\r\n\r\n                if(this.cix > this.frames.length - 1)\r\n                {\r\n                    this.cix =  this.frames.length - 1;\r\n\r\n                }\r\n\r\n            }\r\n            else\r\n            {\r\n\r\n                this.cix = this.cix >= this.frames.length - 1 ? this.frameBounds.min.x : this.cix + 1;\r\n            }\r\n\r\n            this.update();\r\n\r\n        }\r\n\r\n    }\r\n\r\n};\r\n"]}