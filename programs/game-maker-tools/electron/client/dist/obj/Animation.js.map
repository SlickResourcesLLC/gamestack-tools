{"version":3,"sources":["../../../ecma/obj/Animation.js"],"names":["Animation","args","_anime","name","$Q","getArg","description","frames","image","GameImage","src","domElement","type","delay","cix","frameSize","Vector3","frameBounds","VectorFrameBounds","frameOffset","apply2DFrames","parent","flipX","priority","selected_frame","earlyTerm","hang","duration","effects","timer","key","fallback","hasOwnProperty","fcount","y","min","max","x","framePos","push","isNaN","length","resetFrames","__inst","tween","TWEEN","Tween","easing","curve","Easing","Linear","to","onUpdate","onComplete","complete","fun","Quazar","log","update"],"mappings":";;;;;;AAAA;;;;;IAMMA,S;AACF,2BAAYC,IAAZ,EAAkB;AAAA;;AAEdA,uBAAOA,QAAQ,EAAf;;AAEA,oBAAIC,SAAS,IAAb;;AAEA,qBAAKC,IAAL,GAAYC,GAAGC,MAAH,CAAUJ,IAAV,EAAgB,MAAhB,EAAwB,QAAxB,CAAZ,EAEA,KAAKK,WAAL,GAAoBF,GAAGC,MAAH,CAAUJ,IAAV,EAAgB,aAAhB,EAA+B,QAA/B,CAFpB;;AAIA,qBAAKM,MAAL,GAAcH,GAAGC,MAAH,CAAUJ,IAAV,EAAgB,QAAhB,EAA0B,EAA1B,CAAd;;AAEA,qBAAKO,KAAL,GAAa,IAAIC,SAAJ,CAAeL,GAAGC,MAAH,CAAUJ,IAAV,EAAgB,KAAhB,EAAwBG,GAAGC,MAAH,CAAUJ,IAAV,EAAgB,OAAhB,EAAyB,KAAzB,CAAxB,CAAf,CAAb;;AAGA,qBAAKS,GAAL,GAAW,KAAKF,KAAL,CAAWG,UAAX,CAAsBD,GAAjC;;AAEA,qBAAKC,UAAL,GAAkB,KAAKH,KAAL,CAAWG,UAA7B;;AAEA,qBAAKC,IAAL,GAAYR,GAAGC,MAAH,CAAUJ,IAAV,EAAgB,MAAhB,EAAwB,OAAxB,CAAZ;;AAEA,qBAAKY,KAAL,GAAaT,GAAGC,MAAH,CAAUJ,IAAV,EAAgB,OAAhB,EAAyB,CAAzB,CAAb;;AAEA,qBAAKa,GAAL,GAAW,CAAX;;AAEA,qBAAKC,SAAL,GAAiB,KAAKV,MAAL,CAAYJ,IAAZ,EAAkB,WAAlB,EAA+B,IAAIe,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA/B,CAAjB;;AAEA,qBAAKC,WAAL,GAAmB,KAAKZ,MAAL,CAAYJ,IAAZ,EAAkB,aAAlB,EAAiC,IAAIiB,iBAAJ,CAAsB,IAAIF,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAtB,EAA4C,IAAIA,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA5C,EAAkE,IAAIA,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAlE,CAAjC,CAAnB;;AAEA,qBAAKG,WAAL,GAAmB,KAAKd,MAAL,CAAYJ,IAAZ,EAAkB,aAAlB,EAAiC,IAAIe,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAjC,CAAnB;;AAGA,qBAAKI,aAAL,CAAmBnB,KAAKoB,MAAL,IAAe,EAAlC;;AAEA,qBAAKC,KAAL,GAAalB,GAAGC,MAAH,CAAUJ,IAAV,EAAgB,OAAhB,EAAyB,KAAzB,CAAb;;AAEA,qBAAKsB,QAAL,GAAgBnB,GAAGC,MAAH,CAAUJ,IAAV,EAAgB,UAAhB,EAA4B,CAA5B,CAAhB;;AAEA,qBAAKa,GAAL,GAAW,CAAX;;AAEA,qBAAKU,cAAL,GAAsB,KAAKjB,MAAL,CAAY,CAAZ,CAAtB;;AAEA,qBAAKkB,SAAL,GAAiB,KAAKpB,MAAL,CAAYJ,IAAZ,EAAkB,WAAlB,EAA+B,KAA/B,CAAjB;;AAEA,qBAAKyB,IAAL,GAAW,KAAKrB,MAAL,CAAYJ,IAAZ,EAAkB,MAAlB,EAA0B,KAA1B,CAAX;;AAEA,qBAAK0B,QAAL,GAAgB,KAAKtB,MAAL,CAAYJ,IAAZ,EAAkB,UAAlB,EAA8B,KAA9B,CAAhB;;AAEA,qBAAK2B,OAAL,GAAe,EAAf;;AAEA,qBAAKC,KAAL,GAAa,CAAb;AAEH;;;;uCAEM5B,I,EAAM6B,G,EAAKC,Q,EAAU;;AAExB,4BAAI9B,KAAK+B,cAAL,CAAoBF,GAApB,CAAJ,EAA8B;;AAE1B,uCAAO7B,KAAK6B,GAAL,CAAP;AAEH,yBAJD,MAKK;AACD,uCAAOC,QAAP;AAEH;AAEJ;;;8CAEaV,M,EAAQ;;AAElB,6BAAKd,MAAL,GAAc,EAAd;;AAEA,4BAAI0B,SAAS,CAAb;;AAEA,6BAAK,IAAIC,IAAI,KAAKjB,WAAL,CAAiBkB,GAAjB,CAAqBD,CAAlC,EAAqCA,KAAK,KAAKjB,WAAL,CAAiBmB,GAAjB,CAAqBF,CAA/D,EAAkEA,GAAlE,EAAuE;;AAEnE,qCAAK,IAAIG,IAAI,KAAKpB,WAAL,CAAiBkB,GAAjB,CAAqBE,CAAlC,EAAqCA,KAAK,KAAKpB,WAAL,CAAiBmB,GAAjB,CAAqBC,CAA/D,EAAkEA,GAAlE,EAAuE;;AAEnE,4CAAIC,WAAW,EAACD,GAAGA,IAAI,KAAKtB,SAAL,CAAesB,CAAnB,GAAuB,KAAKlB,WAAL,CAAiBkB,CAA5C,EAA+CH,GAAGA,IAAI,KAAKnB,SAAL,CAAemB,CAAnB,GAAuB,KAAKf,WAAL,CAAiBe,CAA1F,EAAf;;AAEA,6CAAK3B,MAAL,CAAYgC,IAAZ,CAAiB,EAAC/B,OAAO,KAAKA,KAAb,EAAoBO,WAAW,KAAKA,SAApC,EAA+CuB,UAAUA,QAAzD,EAAjB;;AAGAL,kDAAU,CAAV;;AAEA,4CAAG,CAACO,MAAM,KAAKf,SAAX,CAAJ,EACA;;AAEI,oDAAGQ,UAAU,KAAKR,SAAlB,EAA6B;AACzB,+DAAO,CAAP;AACH;AACJ;AAEJ;AAEJ;;AAED,6BAAKlB,MAAL,CAAY,CAAZ,IAAiB,CAAC,KAAKA,MAAL,CAAY,CAAZ,CAAD,GAAkB;AAC3BC,uCAAO,KAAKA,KADe;AAE3BO,2CAAW,KAAKA,SAFW;AAG3BuB,0CAAU,EAACD,GAAG,KAAKpB,WAAL,CAAiBkB,GAAjB,CAAqBE,CAAzB,EAA4BH,GAAG,KAAKjB,WAAL,CAAiBkB,GAAjB,CAAqBD,CAApD;AAHiB,yBAAlB,GAIT,KAAK3B,MAAL,CAAY,CAAZ,CAJR;;AAMA,6BAAKiB,cAAL,GAAsB,KAAKjB,MAAL,CAAY,CAAZ,CAAtB;AAEH;;;8CAEa;AACd;;AAEI,6BAAKa,aAAL;AAEH;;;yCAEQ;;AAEL,6BAAKI,cAAL,GAAsB,KAAKjB,MAAL,CAAY,KAAKO,GAAL,GAAW,KAAKP,MAAL,CAAYkC,MAAnC,CAAtB;AAGH;;;wCAGL;;AAEI,6BAAKC,WAAL;;AAEA,6BAAK5B,GAAL,GAAW,CAAX;AAEH;;;8CAGD;;AAEI,4BAAI6B,SAAS,IAAb;;AAEA;AACF,6BAAKC,KAAL,GAAa,IAAIC,MAAMC,KAAV,CAAgB,IAAhB,EACNC,MADM,CACCJ,OAAOK,KAAP,IAAgBH,MAAMI,MAAN,CAAaC,MAD9B,EAGNC,EAHM,CAGH,EAACrC,KAAI,KAAKP,MAAL,CAAYkC,MAAZ,GAAqB,CAA1B,EAHG,EAG2B,KAAKd,QAAL,IAAiB,KAAKpB,MAAL,CAAYkC,MAAZ,GAAqB,EAHjE,EAINW,QAJM,CAIG,YAAW;AACjB;;;AAIH,yBATM,EAUNC,UAVM,CAUK,YAAW;AACnB;;AAEA,oCAAGV,OAAOW,QAAV,EACA;;AAEIX,+CAAOW,QAAP;AAEH;AAEJ,yBApBM,CAAb;AAuBD;;;2CAEUC,G,EACX;AACI,6BAAKD,QAAL,GAAgBC,GAAhB;AAEH;;;0CAEa;;AAEN,6BAAK1B,KAAL,IAAc,CAAd;;AAEA2B,+BAAOC,GAAP,CAAW,gCAAgC,KAAKlD,MAAL,CAAYkC,MAAvD;;AAEA,4BAAG,KAAKZ,KAAL,GAAa,KAAKhB,KAAlB,IAA2B,CAA9B,EAAiC;;AAE7B,oCAAG,KAAKa,IAAR,EACA;AACI,6CAAKZ,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;;AAEA,4CAAG,KAAKA,GAAL,GAAW,KAAKP,MAAL,CAAYkC,MAAZ,GAAqB,CAAnC,EACA;AACI,qDAAK3B,GAAL,GAAY,KAAKP,MAAL,CAAYkC,MAAZ,GAAqB,CAAjC;AAEH;AAEJ,iCAVD,MAYA;;AAEI,6CAAK3B,GAAL,GAAW,KAAKA,GAAL,IAAY,KAAKP,MAAL,CAAYkC,MAAZ,GAAqB,CAAjC,GAAqC,KAAKxB,WAAL,CAAiBkB,GAAjB,CAAqBE,CAA1D,GAA8D,KAAKvB,GAAL,GAAW,CAApF;AACH;;AAED,qCAAK4C,MAAL;AAEH;AAEJ;;;;;;AAEJ","file":"Animation.js","sourcesContent":["/**\r\n * Created by The Blakes on 04-13-2017\r\n *\r\n */\r\n\r\n\r\nclass Animation {\r\n    constructor(args) {\r\n\r\n        args = args || {};\r\n\r\n        var _anime = this;\r\n\r\n        this.name = $Q.getArg(args, 'name', '_blank'),\r\n\r\n        this.description =  $Q.getArg(args, 'description', '_blank')\r\n\r\n        this.frames = $Q.getArg(args, 'frames', []);\r\n\r\n        this.image = new GameImage( $Q.getArg(args, 'src',  $Q.getArg(args, 'image', false)));\r\n\r\n\r\n        this.src = this.image.domElement.src;\r\n\r\n        this.domElement = this.image.domElement;\r\n\r\n        this.type = $Q.getArg(args, 'type', 'basic');\r\n\r\n        this.delay = $Q.getArg(args, 'delay', 0);\r\n\r\n        this.cix = 0;\r\n\r\n        this.frameSize = this.getArg(args, 'frameSize', new Vector3(0, 0, 0));\r\n\r\n        this.frameBounds = this.getArg(args, 'frameBounds', new VectorFrameBounds(new Vector3(0, 0, 0), new Vector3(0, 0, 0), new Vector3(0, 0, 0)));\r\n\r\n        this.frameOffset = this.getArg(args, 'frameOffset', new Vector3(0, 0, 0));\r\n\r\n\r\n        this.apply2DFrames(args.parent || {});\r\n\r\n        this.flipX = $Q.getArg(args, 'flipX', false);\r\n\r\n        this.priority = $Q.getArg(args, 'priority', 0);\r\n\r\n        this.cix = 0;\r\n\r\n        this.selected_frame = this.frames[0];\r\n\r\n        this.earlyTerm = this.getArg(args, 'earlyTerm', false);\r\n\r\n        this.hang =this.getArg(args, 'hang', false);\r\n\r\n        this.duration = this.getArg(args, 'duration', false);\r\n\r\n        this.effects = [];\r\n\r\n        this.timer = 0;\r\n\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n        if (args.hasOwnProperty(key)) {\r\n\r\n            return args[key];\r\n\r\n        }\r\n        else {\r\n            return fallback;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    apply2DFrames(parent) {\r\n\r\n        this.frames = [];\r\n\r\n        var fcount = 0;\r\n\r\n        for (let y = this.frameBounds.min.y; y <= this.frameBounds.max.y; y++) {\r\n\r\n            for (let x = this.frameBounds.min.x; x <= this.frameBounds.max.x; x++) {\r\n\r\n                let framePos = {x: x * this.frameSize.x + this.frameOffset.x, y: y * this.frameSize.y + this.frameOffset.y};\r\n\r\n                this.frames.push({image: this.image, frameSize: this.frameSize, framePos: framePos});\r\n\r\n\r\n                fcount += 1;\r\n\r\n                if(!isNaN(this.earlyTerm))\r\n                {\r\n\r\n                    if(fcount >= this.earlyTerm) {\r\n                        return 0;\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        this.frames[0] = !this.frames[0] ? {\r\n                image: this.image,\r\n                frameSize: this.frameSize,\r\n                framePos: {x: this.frameBounds.min.x, y: this.frameBounds.min.y}\r\n            } : this.frames[0];\r\n\r\n        this.selected_frame = this.frames[0];\r\n\r\n    }\r\n\r\n    resetFrames() //special reset function:: frames are re-rendered each reset()\r\n    {\r\n\r\n        this.apply2DFrames();\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        this.selected_frame = this.frames[this.cix % this.frames.length];\r\n\r\n\r\n    }\r\n\r\n    reset()\r\n{\r\n\r\n    this.resetFrames();\r\n\r\n    this.cix = 0;\r\n\r\n}\r\n\r\nengage_once()\r\n{\r\n\r\n    let __inst = this;\r\n\r\n    //we have a target\r\n  this.tween = new TWEEN.Tween(this)\r\n        .easing(__inst.curve || TWEEN.Easing.Linear)\r\n\r\n        .to({cix:this.frames.length - 1}, this.duration || this.frames.length * 20)\r\n        .onUpdate(function() {\r\n            //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n\r\n\r\n        })\r\n        .onComplete(function() {\r\n            //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n            if(__inst.complete)\r\n            {\r\n\r\n                __inst.complete();\r\n\r\n            }\r\n\r\n        });\r\n\r\n\r\n}\r\n\r\nonComplete(fun)\r\n{\r\n    this.complete = fun;\r\n\r\n}\r\n\r\n    animate() {\r\n\r\n        this.timer += 1;\r\n\r\n        Quazar.log('ANIMATING with frame count:' + this.frames.length);\r\n\r\n        if(this.timer % this.delay == 0) {\r\n\r\n            if(this.hang)\r\n            {\r\n                this.cix = this.cix + 1;\r\n\r\n                if(this.cix > this.frames.length - 1)\r\n                {\r\n                    this.cix =  this.frames.length - 1;\r\n\r\n                }\r\n\r\n            }\r\n            else\r\n            {\r\n\r\n                this.cix = this.cix >= this.frames.length - 1 ? this.frameBounds.min.x : this.cix + 1;\r\n            }\r\n\r\n            this.update();\r\n\r\n        }\r\n\r\n    }\r\n\r\n};\r\n"]}