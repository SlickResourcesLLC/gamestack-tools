{"version":3,"sources":["../../../ecma/GameStack/concat/GameStack.js"],"names":["Sound","src","x","sound","Audio","onLoad","play","GameImage","onCreate","Object","image","document","createElement","ext","substring","lastIndexOf","length","error","onerror","__error","domElement","onload","GameStackLibrary","lib","DEBUG","gui_mode","__gameWindow","__sprites","__animations","samples","log_modes","log_mode","recursionCount","__gameWindowList","create_id","d","Date","getTime","performance","now","replace","c","r","Math","random","floor","toString","getActionablesCheckList","__inst","actionables","$Q","each","sprites","ix","item","concat","sounds","motionstacks","animations","interlog","message","div","isNaN","quit","Error","console","info","m","GameStack","log","animate","time","__gameStack","isAtPlay","TWEEN","update","requestAnimationFrame","ctx","clearRect","canvas","width","height","draw","start","Collision","spriteRectanglesCollide","obj1","obj2","padding","paddingX","size","paddingY","y","left","position","right","top","bottom","_gameWindow","setGameWindow","gameWindow","getGameWindow","assignAll","object","args","keys","list","onResult","onComplete","i","ready_callstack","ready","callback","push","callReady","funx","call","InputEvents","init","getArg","key","fallback","hasOwnProperty","add","obj","GameWindow","Force","forces","Camera","camera","Sprite","collect","remove","indexOf","splice","all_objects","isNormalStringMatch","str1","str2","toLowerCase","instance_type_pairs","objectList","constructor_name","constructor","name","type","select","objects_out","normalizedType","Quick2d","Quazar","QUAZAR","__gameInstance","jstr","JSON","stringify","selector","$GFunx","objects","on","evt_key","selectorObject","controller_ix","criterion","between","cparts","split","__targetType","__targetName","before","trim","parseFloat","alert","evt_profile","cix","contains_any","button_mode","GamepadAdapter","item1","iy","item2","onUpdate","sprite","collidesRectangular","condition","evt_parts","run","mykey","number","e","propkey","spr","object_out","s","mainSelector","msfChar","__targetClassName","output","cleanSelectorString","str","after","getParts","complete","c1","test_str","start_pos","end_pos","contains","contains_all","cList","c2","test_selector_method","Q_TestStrings","test","mousemove","leftclick","rightclick","middleclick","wheelup","wheelDown","space","tab","shift","enter","extend","onFinish","cleanKey","down","up","getMousePos","pageX","pageY","clientX","body","scrollLeft","documentElement","clientY","scrollTop","offsetLeft","style","fullMoveInputEvents","event","pos","Array","el","onkeydown","value","String","fromCharCode","keyCode","onkeyup","onmousedown","which","preventDefault","onmouseup","addEventListener","window","_preGameStack_windowLoad","Canvas","__levelMaker","active","onScreen","WIDTH","HEIGHT","drawPortion","drawFrameWithRotation","img","fx","fy","fw","fh","deg","canvasContextObj","flip","save","round","rad","PI","translate","rotate","scale","drawImage","restore","frame","selected_animation","selected_frame","p","z","targetSize","realWidth","realHeight","offset","rotation","framePos","frameSize","flipX","backgrounds","interactives","append","background","adjustSize","getContext","onresize","target","w","h","clientWidth","clientHeight","listout","id","player","def_update","filepath","$","getJSON","data","_gw","TextDisplay","ItemDisplay","font","fontSize","text","color","BarDisplay","VideoDisplay","undefined","Vector3","Animation","_anime","description","frames","delay","frameBounds","VectorFrameBounds","frameOffset","extras","apply2DFrames","parent","priority","earlyTerm","hang","duration","effects","timer","__gameLogic","setType","__frametype","fcount","quitLoop","min","max","termPoint","resetFrames","engage","tween","Tween","easing","curve","Easing","Linear","None","to","isComplete","fun","Controls","__controller","controller","extension","formerCall","extendedCall","Extras","items","fire","process","GravityForce","subjects","origin","massObjects","minSpeed","accel","itemx","accelY","__inAir","itemy","collide_stop","StatEffect","__is","collideables","GameLogic","gameEffectList","gameEffects","gameeffect","__gamepads","intervals","controller_stack","_gpinst","events","setInterval","gps","navigator","getGamepads","clearInterval","game_pad_index","game_pad","gp","stick_left","stick_right","buttons","extendFunc","f1","f2","fc","current_cb","parts","parseInt","gpEvents","process_buttons","process_axes","axes","axis1","axia2","ceil","pressed","clearance_1","gpc","bkey","gamepads","gpix","GamepadEvents","GravityAction","Graviton","GravitationalRay","Motion","distance","curvesList","curvesObject","parent_id","object_id","Quadratic","InOut","targetRotation","curveString","getCurveString","setCurve","line","easeType","cps","s1","s2","tweens","Game","targetR","Elastic","__tweenObject","setTimeout","t","f","context","fillStyle","fillRect","lineWidth","strokeStyle","beginPath","moveTo","lineTo","closePath","stroke","position_old","Rectangle","VectorBounds","Circle","radius","getArgs","__initializers","_spr","motions","collision_bounds","speed","acceleration","rot_speed","rot_accel","onInit","__clippedX","__clippedY","setAnimation","options","SpriteInitializers","f_init","framesize","__mapSize","anime","keyString1","keyString2","extendedFunc","ef","prep_key","animation","bullet","rot_offset","bx","by","bw","bh","shot","stats","damage","cos","sin","subsprite","__parent","abs","assertSpeed","diff","prop","rate","amt","diff_min_y","diff_min_x","diff_max_y","diff_max_x","dimens","minkey","apart","ct","diffX","center","sub","distX","overlap_x","diffY","distY","overlap_y","collide_stop_x","file_path","SpriteInitializersOptions","ControllerStickMotion","__args","player_move_x","__lib","accelX","decelX","__falling","decelY","player_move_xy","decel","player_rotate_x","v","v1","v2","Pos","Size","Position","Vector2","Vector","Rotation","InterfaceCallback","SpeechInterfaceStructure","options_structure","scroll","create_object_resource","constructors","IF","__allConstructors","selectedType","selectByName","apply_speech_value","applySpeechValue","save_object_resource","selected_object","confirm","confirmation","retrieve_object_resource","browse_object_resources","search_object_resources","delete_object_resources","apply_value"],"mappings":"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","file":"GameStack.js","sourcesContent":["\r\n/**\r\n * Sound\r\n * :Simple Sound object:: uses Jquery: audio\r\n * @param   {string} src : source path / name of the targeted sound-file\r\n\r\n * @returns {Sound} object of Sound()\r\n * */\r\n\r\nclass Sound {\r\n\r\n    constructor(src) {\r\n\r\n        if (typeof(src) == 'object') {\r\n\r\n            for (var x in src) {\r\n                this[x] = src[x];\r\n\r\n            }\r\n\r\n            this.sound = new Audio(src.src);\r\n\r\n            this.onLoad = src.onLoad || function () {\r\n                };\r\n\r\n        }\r\n\r\n        else if (typeof(src) == 'string') {\r\n\r\n            this.src = src;\r\n\r\n            this.sound = new Audio(this.src);\r\n\r\n        }\r\n\r\n        this.onLoad = this.onLoad || function () {\r\n            };\r\n\r\n        if (typeof(this.onLoad) == 'function') {\r\n\r\n            this.onLoad(this.sound);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    play() {\r\n        if (typeof(this.sound) == 'object' && typeof(this.sound.play) == 'function') {\r\n\r\n            this.sound.play();\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * GameImage\r\n *\r\n * Simple GameImage\r\n * @param   {string} src : source path / name of the targeted image-file\r\n\r\n * @returns {GameImage} object of GameImage()\r\n\r\n * */\r\n\r\nclass GameImage {\r\n\r\n    constructor(src, onCreate) {\r\n\r\n        // GameStack.log('initializing image');\r\n\r\n        if (src instanceof Object) {\r\n\r\n            //alert('getting image from image');\r\n\r\n            this.image = document.createElement('IMG');\r\n\r\n            this.image.src = src.src;\r\n\r\n            this.src = src.src;\r\n\r\n        }\r\n\r\n        else if (typeof(src) == 'string') {\r\n\r\n            let ext = src.substring(src.lastIndexOf('.'), src.length);\r\n\r\n            this.image = document.createElement('IMG');\r\n\r\n            this.image.src = src;\r\n\r\n            this.src = this.image.src;\r\n\r\n\r\n        }\r\n\r\n\r\n        if (!this.image) {\r\n            this.image = {error: \"Image not instantiated, set to object by default\"};\r\n\r\n        }\r\n        else {\r\n            this.image.onerror = function () {\r\n                this.__error = true;\r\n            };\r\n\r\n        }\r\n\r\n        this.domElement = this.image;\r\n\r\n        this.image.onload = function () {\r\n\r\n            if (typeof(this.onCreate) == 'function') {\r\n\r\n                this.onCreate(this.image);\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    getImage() {\r\n        return this.image;\r\n    }\r\n\r\n}\r\n\r\n\r\nlet GameStackLibrary = function () {\r\n\r\n\r\n    var lib = {\r\n\r\n        DEBUG: false,\r\n\r\n        gui_mode: true,\r\n\r\n        __gameWindow: {}\r\n        ,\r\n\r\n        __sprites: [],\r\n\r\n        __animations: [],\r\n\r\n        samples: {}\r\n        ,\r\n\r\n        log_modes: ['reqs', 'info', 'warning'],\r\n\r\n        log_mode: \"all\",\r\n\r\n        recursionCount: 0,\r\n\r\n        __gameWindowList: [],\r\n\r\n\r\n        create_id: function () {\r\n\r\n            var d = new Date().getTime();\r\n            if (typeof performance !== 'undefined' && typeof performance.now === 'function') {\r\n                d += performance.now(); //use high-precision timer if available\r\n            }\r\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n                var r = (d + Math.random() * 16) % 16 | 0;\r\n                d = Math.floor(d / 16);\r\n                return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\r\n            });\r\n\r\n        }\r\n\r\n        ,\r\n\r\n        getActionablesCheckList: function () {\r\n            //every unique sound, animation, tweenmotion in the game\r\n\r\n            let __inst = {};\r\n\r\n            let actionables = [];\r\n\r\n            $Q.each(this.sprites, function (ix, item) {\r\n\r\n                actionables.concat(item.sounds);\r\n\r\n                actionables.concat(item.motionstacks);\r\n\r\n                actionables.concat(item.animations);\r\n\r\n\r\n            });\r\n\r\n\r\n        }\r\n        ,\r\n\r\n        interlog: function (message, div) //recursive safe :: won't go crazy with recursive logs\r\n        {\r\n            this.recursionCount++;\r\n\r\n            if (!isNaN(div) && this.recursionCount % div == 0) {\r\n                //   console.log('Interval Log:'+  message);\r\n\r\n            }\r\n\r\n        }\r\n        ,\r\n\r\n        error: function (quit, message) {\r\n\r\n            if (quit) {\r\n                throw new Error(message);\r\n\r\n            }\r\n            else {\r\n                console.error('E!' + message);\r\n\r\n            }\r\n\r\n        }\r\n        ,\r\n\r\n        info: function (m) {\r\n\r\n            if (GameStack.DEBUG) {\r\n\r\n                console.info('Info:' + m);\r\n\r\n            }\r\n        }\r\n        ,\r\n\r\n\r\n        log: function (m) {\r\n\r\n            if (GameStack.DEBUG) {\r\n\r\n                console.log('GameStack:' + m);\r\n\r\n            }\r\n        }\r\n        ,\r\n\r\n        //animate() : main animation call, run the once and it will recurse with requestAnimationFrame(this.animate);\r\n\r\n        animate: function (time) {\r\n\r\n            __gameStack.isAtPlay = true;\r\n\r\n\r\n            TWEEN.update(time);\r\n\r\n            requestAnimationFrame(__gameStack.animate);\r\n\r\n            __gameStack.__gameWindow.update();\r\n\r\n            __gameStack.__gameWindow.ctx.clearRect(0, 0, __gameStack.__gameWindow.canvas.width, __gameStack.__gameWindow.canvas.height);\r\n\r\n            __gameStack.__gameWindow.draw();\r\n\r\n        }\r\n        ,\r\n\r\n        start: function () {\r\n\r\n            this.animate();\r\n\r\n        }\r\n        ,\r\n\r\n\r\n        Collision: {\r\n\r\n            spriteRectanglesCollide(obj1, obj2, padding)\r\n            {\r\n                if(!padding)\r\n                {\r\n                    padding = 0;\r\n                }\r\n\r\n               var paddingX = padding * obj1.size.x,\r\n\r\n                   paddingY = padding * obj1.size.y, left = obj1.position.x + paddingX, right = obj1.position.x + obj1.size.x - paddingX,\r\n\r\n               top = obj1.position.y + paddingY, bottom = obj1.position.y + obj1.size.y - paddingY;\r\n\r\n                if (right > obj2.position.x && left < obj2.position.x + obj2.size.x &&\r\n                   bottom > obj2.position.y && top < obj2.position.y + obj2.size.y) {\r\n\r\n                    return true;\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n        ,\r\n\r\n        TWEEN: TWEEN,\r\n\r\n        _gameWindow: {}\r\n        ,\r\n\r\n        setGameWindow: function (gameWindow) {\r\n\r\n            this._gameWindow = gameWindow;\r\n\r\n        }\r\n        ,\r\n\r\n        getGameWindow: function () {\r\n\r\n\r\n            return this._gameWindow;\r\n\r\n        }\r\n        ,\r\n\r\n        assignAll: function (object, args, keys) {\r\n\r\n            __gameStack.each(keys, function (ix, item) {\r\n\r\n                object[ix] = args[ix];\r\n\r\n            });\r\n\r\n\r\n        }\r\n        ,\r\n\r\n\r\n        each: function (list, onResult, onComplete) {\r\n            for (var i in list) {\r\n                onResult(i, list[i]);\r\n            }\r\n\r\n            if (typeof(onComplete) === 'function') {\r\n                onComplete(false, list)\r\n            }\r\n            ;\r\n\r\n        }\r\n        ,\r\n\r\n        ready_callstack: [],\r\n\r\n        ready: function (callback) {\r\n\r\n            this.ready_callstack.push(callback);\r\n\r\n        }\r\n\r\n        ,\r\n\r\n        callReady: function () {\r\n\r\n            var funx = this.ready_callstack;\r\n\r\n            var gameWindow = this._gameWindow, lib = this, sprites = this.__gameWindow.sprites;\r\n\r\n            //call every function in the ready_callstack\r\n\r\n            this.each(funx, function (ix, call) {\r\n\r\n                call(lib, gameWindow, sprites);\r\n\r\n            });\r\n\r\n            this.InputEvents.init();\r\n\r\n        }\r\n        ,\r\n\r\n        getArg: function (args, key, fallback) {\r\n            if (args && args.hasOwnProperty(key)) {\r\n                return args[key];\r\n            }\r\n            else {\r\n                return fallback;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        ,\r\n\r\n        add: function (obj) {\r\n            //1: if Sprite(), Add object to the existing __gameWindow\r\n\r\n            if (obj instanceof GameWindow) {\r\n\r\n                this.__gameWindow = obj;\r\n\r\n            }\r\n\r\n            if (obj instanceof Force) {\r\n\r\n                this.__gameWindow.forces.push(obj);\r\n\r\n            }\r\n\r\n\r\n            if (obj instanceof Camera) {\r\n\r\n                this.__gameWindow.camera = obj;\r\n\r\n            }\r\n\r\n\r\n            if (obj instanceof Sprite) {\r\n\r\n                this.__gameWindow.sprites.push(obj);\r\n\r\n            }\r\n\r\n            this.collect(obj);\r\n\r\n            return obj;\r\n\r\n        }\r\n\r\n        ,\r\n\r\n        remove: function (obj) {\r\n            //1: if Sprite(), Add object to the existing __gameWindow\r\n\r\n\r\n            if (obj instanceof Sprite) {\r\n\r\n                var ix = this.__gameWindow.sprites.indexOf(obj);\r\n\r\n                this.__gameWindow.sprites.splice(ix, 1);\r\n\r\n            }\r\n\r\n        },\r\n\r\n        all_objects: [],\r\n\r\n        collect: function (obj) {\r\n\r\n            this.all_objects.push(obj);\r\n\r\n        },\r\n\r\n\r\n        isNormalStringMatch: function (str1, str2) {\r\n\r\n            return str1.toLowerCase().replace(' ', '') == str2.toLowerCase().replace(' ', '');\r\n\r\n        },\r\n\r\n        instance_type_pairs: function () {\r\n            //get an array of all instance/type pairs added to the library\r\n\r\n            //example : [ {constructor_name:Sprite, type:enemy_basic}, {constructor_name:Animation, type:enemy_attack}  ];\r\n\r\n            var objectList = [];\r\n\r\n            this.each(this.all_objects, function (ix, item) {\r\n\r\n\r\n                objectList.push({constructor_name: item.constructor.name, type: item.type});\r\n\r\n            });\r\n\r\n            return objectList;\r\n\r\n        },\r\n\r\n        select: function (constructor_name, name, type /*ignoring spaces and CAPS/CASE on type match*/) {\r\n\r\n            var objects_out = [];\r\n\r\n            var normalizedType\r\n\r\n            var __inst = this;\r\n\r\n            this.each(this.all_objects, function (ix, item) {\r\n\r\n                if (constructor_name == '*' || item.constructor.name == constructor_name) {\r\n\r\n                    if (type == '*' || __inst.isNormalStringMatch(type, item.type)) {\r\n\r\n                        if (name == '*' || __inst.isNormalStringMatch(name, item.name)) {\r\n\r\n                            objects_out.push(item);\r\n\r\n\r\n                        }\r\n\r\n                    }\r\n\r\n                }\r\n\r\n            });\r\n\r\n            return objects_out;\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    return lib;\r\n\r\n};\r\n\r\n//GameStack: a main / game lib object::\r\n//TODO: fix the following set of mixed references:: only need to refer to (1) lib instance\r\n\r\nlet GameStack = new GameStackLibrary();\r\nlet __gameStack = GameStack;\r\n\r\nlet Quick2d = GameStack; //Exposing 'Quick2d' as synonymous reference to GameStack\r\n\r\nlet Quazar = GameStack; //Exposing 'Quazar' as synonymous reference to GameStack\r\n\r\nlet QUAZAR = GameStack; //Exposing 'QUAZAR' as synonymous reference to GameStack\r\n\r\nlet __gameInstance = GameStack;\r\n\r\n/***************\r\n * TODO : fix the above duplicate references, which exist now for backward compatibility with previouslyh authored code\r\n *\r\n *  -apply find and replace accross the codebase\r\n *\r\n * ****************/\r\n\r\n/********\r\n * jstr() : public function for stringified objects and arrays (uses pretty print style)\r\n * *********/\r\n\r\nfunction jstr(obj) {\r\n\r\n    return JSON.stringify(obj);\r\n\r\n};\r\n\r\n/**********\r\n * $Q : Selector Function *in development\r\n *  -allows string selection of library collections, etc...\r\n * Example Calls\r\n * **********/\r\n\r\nfunction $Q(selector) {\r\n\r\n    //declare events:\r\n\r\n\r\n    var $GFunx = {};\r\n\r\n    $GFunx.each = function(callback)\r\n    {\r\n\r\n        var objects = [];\r\n\r\n        for(var x = 0; x < this.length; x++)\r\n        {\r\n            if(typeof x == 'number')\r\n            {\r\n\r\n                callback(x, this[x]);\r\n            }\r\n\r\n        }\r\n\r\n\r\n    };\r\n\r\n    $GFunx.on = function (evt_key, selectorObject, controller_ix, callback) //handle each event such as on('collide') OR on('stick_left_0') << first controller stick_left\r\n    {\r\n\r\n\r\n        if(__gameStack.isAtPlay)\r\n        {\r\n            return console.error('Cannot call $Q().on while game is at play. Please rig your events before gameplay.');\r\n\r\n        }\r\n\r\n        var criterion = $Q.between('[', ']', evt_key);\r\n\r\n        if(criterion.indexOf('===') >= 0)\r\n        {\r\n            criterion = criterion.replace('===', '=');\r\n        }\r\n\r\n        if(criterion.indexOf('==') >= 0)\r\n        {\r\n            criterion =  criterion.replace('==', '=').replace('==', 0);\r\n        }\r\n\r\n       var cparts = criterion.split('=');\r\n\r\n        var  __targetType = \"*\", __targetName = \"*\";\r\n\r\n        if(evt_key.indexOf('[') >= 0)\r\n        {\r\n            evt_key = $Q.before('[', evt_key).trim();\r\n\r\n        }\r\n\r\n\r\n        var padding = 0;\r\n\r\n        if(cparts[0].toLowerCase() == 'padding')\r\n        {\r\n\r\n            padding = parseFloat(cparts[1]);\r\n\r\n            alert('padding:' + padding);\r\n\r\n        }\r\n\r\n        //if controller_ix is function, and callback not present, then controller_ix is the callback aka optional argument\r\n\r\n        if(controller_ix && typeof controller_ix == 'function' && !callback)\r\n        {\r\n            callback = controller_ix;\r\n            controller_ix = 0;\r\n        }\r\n\r\n        //if controller_ix is function, and callback not present, then selectorObject is the callback aka optional argument\r\n\r\n        if(selectorObject && typeof selectorObject == 'function' && !callback)\r\n        {\r\n            callback = selectorObject;\r\n\r\n            selectorObject = $Q('*');\r\n\r\n            controller_ix = 0;\r\n        }\r\n\r\n        var evt_profile = {};\r\n\r\n        //which controller?\r\n\r\n        evt_profile.cix = controller_ix;\r\n\r\n        //Need the control key: 'left_stick', 'button_0', etc..\r\n\r\n        evt_profile.evt_key = evt_key;\r\n\r\n        if($Q.contains_any(['stick', 'button', 'click', 'key'], evt_profile.evt_key))\r\n        {\r\n\r\n            var button_mode = evt_profile.evt_key.indexOf('button') >= 0;\r\n\r\n            Quazar.GamepadAdapter.on(evt_profile.evt_key, 0, function (x, y) {\r\n\r\n                if(!button_mode){callback(x, y);}\r\n                else if(x){callback(x);};\r\n\r\n            });\r\n\r\n            console.info('detected input event key in:' + evt_profile.evt_key);\r\n\r\n            console.info('TODO: rig events');\r\n\r\n        }\r\n\r\n        //TODO: test collision events:\r\n\r\n      else if($Q.contains_any(['collide', 'collision', 'hit', 'touch'],  evt_profile.evt_key))\r\n        {\r\n\r\n            console.info('Rigging a collision event');\r\n\r\n            console.info('detected collision event key in:' +  evt_profile.evt_key);\r\n\r\n            console.info('TODO: rig collision events');\r\n\r\n            this.each(function(ix, item1){\r\n\r\n                selectorObject.each(function(iy, item2){\r\n\r\n\r\n                    if(typeof(item1.onUpdate) == 'function')\r\n                    {\r\n\r\n                        item1.onUpdate(function(sprite){\r\n\r\n                            if(item1.collidesRectangular(item2, padding))\r\n                            {\r\n\r\n                              callback(item1, item2);\r\n\r\n                            };\r\n\r\n                        });\r\n\r\n                    }\r\n\r\n\r\n                });\r\n\r\n            });\r\n\r\n\r\n        }\r\n\r\n\r\n       else {\r\n            console.info('Rigging a property event');\r\n\r\n            //TODO: test property-watch events:\r\n\r\n            console.info('detected property threshhold event key in:' + evt_profile.evt_key);\r\n\r\n            console.info('TODO: rig property events');\r\n\r\n            var condition = \"_\", key = evt_profile.evt_key;\r\n\r\n            if(key.indexOf('[') >= 0 || key.indexOf(']') >= 0)\r\n            {\r\n                key = key.replace('[', '').replace('[', ']');\r\n\r\n            }\r\n\r\n            var evt_parts = [];\r\n\r\n            var run = function()\r\n            {\r\n                console.error('Sprite property check was not set correctly');\r\n\r\n            };\r\n\r\n            if(key.indexOf('>=') >= 0)\r\n            {\r\n                condition = \">=\";\r\n\r\n\r\n            }\r\n           else if(key.indexOf('<=') >= 0)\r\n            {\r\n                condition = \"<=\";\r\n            }\r\n           else if(key.indexOf('>') >= 0)\r\n            {\r\n                condition = \">\";\r\n            }\r\n          else if(key.indexOf('<') >= 0)\r\n            {\r\n                condition = \"<\";\r\n            }\r\n\r\n            else if(key.indexOf('=') >= 0)\r\n            {\r\n                condition = \"=\";\r\n            }\r\n\r\n            evt_parts = key.split(condition);\r\n\r\n            for(var x = 0; x < evt_parts.length; x++)\r\n            {\r\n                evt_parts[x] = evt_parts[x].replace('=', '').replace('=', '').trim(); //remove any trailing equals and trim()\r\n\r\n            }\r\n\r\n            var mykey, number;\r\n\r\n           // alert(evt_parts[0]);\r\n\r\n            try{\r\n\r\n            mykey = evt_parts[0];\r\n\r\n            number = parseFloat(evt_parts[1]);\r\n\r\n            }\r\n            catch(e)\r\n            {\r\n                console.log(e);\r\n            }\r\n\r\n            console.info('Processing condition with:' + condition);\r\n\r\n            switch(condition)\r\n            {\r\n\r\n                case \">=\":\r\n\r\n\r\n                    run = function(obj, key){ if(obj[key] >= number){ callback(); } };\r\n\r\n                    break;\r\n\r\n                case \"<=\":\r\n\r\n                    run = function(obj, key){ if(obj[key] <= number){ callback(); } };\r\n\r\n                    break;\r\n\r\n\r\n                case \">\":\r\n\r\n                    run = function(obj, key){ if(obj[key] > number){ callback(); } };\r\n\r\n                    break;\r\n\r\n                case \"<\":\r\n\r\n                    run = function(obj, key){ if(obj[key] < number){ callback(); } };\r\n\r\n                    break;\r\n\r\n                case \"=\":\r\n\r\n                    run = function(obj, key){ if(obj[key] == number){ callback(); } };\r\n\r\n                    break;\r\n\r\n            }\r\n\r\n\r\n            /************\r\n             * Attach update to each member\r\n             *\r\n             * **************/\r\n\r\n            var keys = mykey.split('.'), propkey = \"\";\r\n\r\n            this.each(function(ix, item){\r\n\r\n                var object = {};\r\n\r\n                if(keys.length == 1)\r\n                {\r\n                    object = item;\r\n\r\n                    propkey = mykey;\r\n\r\n                }\r\n                else if(keys.length == 2)\r\n                {\r\n                    object = item[keys[0]];\r\n\r\n                    propkey = keys[1];\r\n\r\n\r\n                }\r\n\r\n                else if(keys.length == 3)\r\n                {\r\n                    object = item[keys[0]][keys[1]];\r\n\r\n                    propkey = keys[2];\r\n\r\n                }\r\n                else\r\n                {\r\n                    console.error(\":length of '.' notation out of range. We use max length of 3 or prop.prop.key.\");\r\n\r\n                }\r\n\r\n                if(typeof item.onUpdate == 'function')\r\n                {\r\n\r\n\r\n                    var spr = item;\r\n\r\n                    item.onUpdate(function(sprite){\r\n\r\n                        run(object, propkey);\r\n\r\n                    });\r\n\r\n                }\r\n\r\n            });\r\n\r\n\r\n\r\n\r\n        }\r\n\r\n    };\r\n\r\n\r\n    var object_out = {};\r\n\r\n    //handle selector / selection of objects:\r\n\r\n    if(selector && selector !== '*')\r\n    {\r\n\r\n    var s = selector || '';\r\n\r\n    console.info('selector:' + s);\r\n\r\n    var mainSelector = $Q.before('[', s).trim(), msfChar = mainSelector.substring(0, 1);\r\n\r\n    var __targetClassName = \"*\";\r\n\r\n    var output = [];\r\n\r\n    var cleanSelectorString = function(str)\r\n    {\r\n        return str.replace(\",\", \"\");\r\n    };\r\n\r\n    switch (msfChar.toLowerCase()) {\r\n        case \".\":\r\n\r\n            console.info('Selecting by \".\" or class');\r\n\r\n            __targetClassName = cleanSelectorString($Q.after('.', mainSelector));\r\n\r\n            console.info('Target class is:' + __targetClassName);\r\n\r\n            break;\r\n\r\n        case \"*\":\r\n\r\n            console.info('Selecting by \"*\" or ANY object in the library instance');\r\n\r\n            __targetClassName = \"*\";\r\n\r\n            break;\r\n\r\n    }\r\n\r\n         var criterion = $Q.between('[', ']', s), cparts = criterion.split('=');\r\n\r\n        var  __targetType = \"*\", __targetName = \"*\";\r\n\r\n  var getParts = function() {\r\n\r\n      if(cparts.length >= 2) {\r\n\r\n          switch (cparts[0].toLowerCase()) {\r\n\r\n              case \"name\":\r\n\r\n                  //get all objects according to name=name\r\n\r\n                  console.log('Detected parts in selector:' + jstr(cparts));\r\n\r\n                  __targetName =  cleanSelectorString(cparts[1]);\r\n\r\n                  break;\r\n\r\n              case  \"type\":\r\n\r\n                  console.log('Detected parts in selector:' + jstr(cparts));\r\n\r\n                  __targetType =  cleanSelectorString(cparts[1]);\r\n\r\n                  break;\r\n\r\n          }\r\n\r\n      }\r\n\r\n      if(cparts.length >= 4) {\r\n\r\n          cparts[2] = cparts[2].replace(\",\", \"\");\r\n\r\n          switch (cparts[2].toLowerCase()) {\r\n\r\n              case \"name\":\r\n\r\n                  //get all objects according to name=name\r\n\r\n                  console.log('Detected parts in selector:' + jstr(cparts));\r\n\r\n                  __targetName =  cleanSelectorString(cparts[3]);\r\n\r\n                  break;\r\n\r\n              case  \"type\":\r\n\r\n                  console.log('Detected parts in selector:' + jstr(cparts));\r\n\r\n                  __targetType =  cleanSelectorString(cparts[3]);\r\n\r\n                  break;\r\n\r\n          }\r\n\r\n      }\r\n\r\n      };\r\n\r\n  getParts(cparts);\r\n\r\n\r\n        object_out = GameStack.select(__targetClassName, __targetName, __targetType);\r\n    }\r\n   else if(selector == '*')\r\n    {\r\n        object_out = GameStack.all_objects;\r\n\r\n    }\r\n\r\n   for(var x in $GFunx)\r\n   {\r\n       object_out[x] = $GFunx[x];\r\n\r\n   };\r\n\r\n   return object_out;\r\n\r\n}\r\n\r\n\r\n$Q.each = function (obj, callback, complete) {\r\n\r\n    for(var x in obj)\r\n    {\r\n        callback(obj);\r\n\r\n    }\r\n\r\n    if(typeof(complete) == 'function')\r\n    {\r\n        complete(obj);\r\n\r\n    }\r\n\r\n};\r\n\r\n\r\n\r\n$Q.before = function (c1, test_str) {\r\n    var start_pos = 0;\r\n    var end_pos = test_str.indexOf(c1, start_pos);\r\n    return test_str.substring(start_pos, end_pos);\r\n};\r\n\r\n\r\n$Q.contains = function (c1, test_str) {\r\n    return test_str.indexOf(c1) >= 0;\r\n};\r\n\r\n$Q.contains_all = function (cList, test_str) {\r\n    for (var x = 0; x < cList.length; x++) {\r\n        if (test_str.indexOf(cList[x]) < 0) {\r\n            return false;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n};\r\n\r\n$Q.contains_any = function (cList, test_str) {\r\n\r\n    for (var x = 0; x < cList.length; x++) {\r\n        if (test_str.indexOf(cList[x]) >= 0) {\r\n            return true;\r\n\r\n        }\r\n    }\r\n\r\n    return false;\r\n\r\n};\r\n\r\n$Q.after = function (c1, test_str) {\r\n    var start_pos = test_str.indexOf(c1) + 1;\r\n    var end_pos = test_str.length;\r\n    return test_str.substring(start_pos, end_pos);\r\n};\r\n\r\n$Q.between = function (c1, c2, test_str) {\r\n    var start_pos = test_str.indexOf(c1) + 1;\r\n    var end_pos = test_str.indexOf(c2, start_pos);\r\n    return test_str.substring(start_pos, end_pos)\r\n};\r\n\r\n\r\n$Q.test_selector_method =  function () {\r\n    var Q_TestStrings = ['*', '.Sprite', '*[type=\"enemy_type_0\"]', '.Sprite[type=\"enemy_type_0\"]'];\r\n\r\n    for (var x = 0; x < Q_TestStrings.length; x++) {\r\n        var test = Q_TestStrings[x];\r\n\r\n        console.info('testing:' + test);\r\n\r\n        $Q(test);\r\n    }\r\n\r\n    console.log('Testing stick left');\r\n\r\n    this.on('stick_left_0');\r\n\r\n    console.log('Testing button');\r\n\r\n    this.on('button_0');\r\n\r\n\r\n    console.log('Testing collide');\r\n\r\n    this.on('collide');\r\n\r\n\r\n    console.log('Testing button');\r\n\r\n    this.on('collide');\r\n\r\n    console.log('Testing prop');\r\n\r\n    this.on('health>=0');\r\n\r\n\r\n};\r\n\r\n\r\n/********************\r\n * GameStack.InputEvents\r\n * -Various PC Input Events\r\n ********************/\r\n\r\nGameStack.InputEvents = { //PC input events\r\n    mousemove: [],\r\n    leftclick: [],\r\n    rightclick: [],\r\n    middleclick: [],\r\n    wheelup: [],\r\n    wheelDown: [],\r\n    space: [],\r\n    tab: [],\r\n    shift: [],\r\n    1: [], 2: [], 3: [],\r\n    enter: [],\r\n    extend: function (evt_key, callback, onFinish) {\r\n\r\n        if (evt_key.toLowerCase().indexOf('key_') >= 0) {\r\n            //process this as a key event\r\n\r\n            var cleanKey = evt_key.toLowerCase();\r\n            GameStack.InputEvents[cleanKey] = GameStack.InputEvents[cleanKey] || [];\r\n            return GameStack.InputEvents[cleanKey].push({down: callback, up: onFinish});\r\n        } else {\r\n\r\n            GameStack.InputEvents[evt_key] = GameStack.InputEvents[evt_key] || [];\r\n            return GameStack.InputEvents[evt_key].push({down: callback, up: onFinish});\r\n        }\r\n\r\n    },\r\n    init: function () {\r\n\r\n\r\n        function getMousePos(e) {\r\n\r\n            var x;\r\n            var y;\r\n            if (e.pageX || e.pageY) {\r\n                x = e.pageX;\r\n                y = e.pageY;\r\n            } else {\r\n                x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n                y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n            }\r\n            x -= GameStack.canvas.offsetLeft;\r\n            y -= GameStack.canvas.style.top;\r\n            return {x: x, y: y};\r\n        }\r\n\r\n\r\n        function fullMoveInputEvents(event) {\r\n\r\n            var pos = getMousePos(event);\r\n            var InputEvents = GameStack.InputEvents;\r\n            for (var x in InputEvents) {\r\n\r\n\r\n                if (InputEvents[x] instanceof Array && x == 'mousemove') {\r\n\r\n\r\n                    GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                        el.down(pos.x, pos.y);\r\n                    });\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n        ;\r\n        document.onkeydown = function (e) {\r\n\r\n            //    alert(JSON.stringify(GameStack.InputEvents, true, 2));\r\n\r\n            GameStack.log('Got e');\r\n\r\n            var value = 'key_' + String.fromCharCode(e.keyCode).toLowerCase();\r\n            if (GameStack.InputEvents[value] instanceof Array) {\r\n\r\n                GameStack.log('Got []');\r\n\r\n                GameStack.each(GameStack.InputEvents[value], function (ix, item) {\r\n\r\n                    if (typeof (item.down) == 'function') {\r\n\r\n                        //   alert('RUNNING');\r\n\r\n                        item.down();\r\n                    }\r\n\r\n\r\n                });\r\n            }\r\n\r\n        }\r\n\r\n\r\n        document.onkeyup = function (e) {\r\n\r\n            //    alert(JSON.stringify(GameStack.InputEvents, true, 2));\r\n\r\n            var value = 'key_' + String.fromCharCode(e.keyCode).toLowerCase();\r\n            if (GameStack.InputEvents[value] instanceof Array) {\r\n\r\n                GameStack.each(GameStack.InputEvents[value], function (ix, item) {\r\n\r\n                    if (typeof (item.up) == 'function') {\r\n\r\n                        //   alert('RUNNING');\r\n\r\n                        item.up();\r\n                    }\r\n\r\n\r\n                });\r\n            }\r\n\r\n        };\r\n\r\n\r\n        GameStack.canvas.onmousedown = function (e) {\r\n\r\n            //    alert(JSON.stringify(GameStack.InputEvents, true, 2));\r\n\r\n            var value = e.which;\r\n            var pos = getMousePos(e);\r\n            var InputEvents = GameStack.InputEvents;\r\n\r\n\r\n            e.preventDefault();\r\n\r\n            switch (e.which) {\r\n                case 1:\r\n\r\n                    for (var x in InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'leftclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n\r\n                                el.down(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                case 2:\r\n                    // alert('Middle Mouse button pressed.');\r\n\r\n\r\n                    for (var x in GameStack.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'middleclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.down(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n                    break;\r\n                case 3:\r\n                    //  alert('Right Mouse button pressed.');\r\n\r\n\r\n                    for (var x in GameStack.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.down(pos.x, pos.y);\r\n                            });\r\n\r\n                            return false;\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                default:\r\n\r\n                    return 0;\r\n                //alert('You have a strange Mouse!');\r\n\r\n            }\r\n\r\n\r\n            e.preventDefault();\r\n            return 0;\r\n        };\r\n        GameStack.canvas.onmouseup = function (e) {\r\n\r\n            //    alert(JSON.stringify(GameStack.InputEvents, true, 2));\r\n\r\n            var value = e.which;\r\n            var pos = getMousePos(e);\r\n            var InputEvents = GameStack.InputEvents;\r\n\r\n\r\n            e.preventDefault();\r\n\r\n            switch (e.which) {\r\n                case 1:\r\n\r\n                    for (var x in InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'leftclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n\r\n                                el.up(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                case 2:\r\n                    // alert('Middle Mouse button pressed.');\r\n\r\n\r\n                    for (var x in GameStack.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'middleclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.up(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n                    break;\r\n                case 3:\r\n                    //  alert('Right Mouse button pressed.');\r\n\r\n\r\n                    for (var x in GameStack.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.up(pos.x, pos.y);\r\n                            });\r\n\r\n\r\n                            return false;\r\n\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                default:\r\n\r\n                    return 0;\r\n                //alert('You have a strange Mouse!');\r\n\r\n            }\r\n\r\n\r\n        };\r\n        document.addEventListener(\"mousemove\", fullMoveInputEvents);\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n__gameStack = QUAZAR;\r\n\r\n//Override the existing window.onload function\r\n\r\nwindow._preGameStack_windowLoad = window.onload;\r\n\r\nwindow.onload = function () {\r\n\r\n    if (typeof(window._preGameStack_windowLoad) == 'function') {\r\n        window._preGameStack_windowLoad();\r\n    }\r\n\r\n    __gameStack.callReady();\r\n\r\n}\r\n\r\n\r\n/*\r\n * Canvas\r\n *    draw animations, textures to the screen\r\n * */\r\n\r\n\r\nvar Canvas = {\r\n\r\n    __levelMaker:false,\r\n\r\n    draw: function (sprite, ctx) {\r\n\r\n        if (sprite.active && (this.__levelMaker || sprite.onScreen(__gameStack.WIDTH, __gameStack.HEIGHT))) {\r\n\r\n            this.drawPortion(sprite, ctx);\r\n\r\n        }\r\n\r\n    },\r\n    drawFrameWithRotation: function (img, fx, fy, fw, fh, x, y, width, height, deg, canvasContextObj, flip) {\r\n\r\n        canvasContextObj.save();\r\n        deg = Math.round(deg);\r\n        deg = deg % 360;\r\n        var rad = deg * Math.PI / 180;\r\n        //Set the origin to the center of the image\r\n        canvasContextObj.translate(x, y);\r\n        canvasContextObj.rotate(rad);\r\n        //Rotate the canvas around the origin\r\n\r\n        canvasContextObj.translate(0, canvasContextObj.width);\r\n        if (flip) {\r\n\r\n            canvasContextObj.scale(-1, 1);\r\n        } else {\r\n\r\n        }\r\n\r\n        //draw the image\r\n        canvasContextObj.drawImage(img, fx, fy, fw, fh, width / 2 * (-1), height / 2 * (-1), width, height);\r\n        //reset the canvas\r\n\r\n        canvasContextObj.restore();\r\n    },\r\n\r\n\r\n    /*\r\n     * drawPortion:\r\n     *\r\n     *   expects: (sprite{selected_animation{selected_frame{frameSize, framePos } offset?, gameSize? }  })\r\n     *\r\n     *\r\n     * */\r\n\r\n\r\n    drawPortion: function (sprite, ctx) {\r\n\r\n        var frame;\r\n\r\n        if (sprite.active) {\r\n\r\n            if (sprite.selected_animation && sprite.selected_animation.selected_frame) {\r\n\r\n                frame = sprite.selected_animation.selected_frame;\r\n\r\n            }\r\n            else {\r\n\r\n                console.error('Sprite is missing arguments');\r\n\r\n            }\r\n\r\n            var p = sprite.position;\r\n\r\n            var camera = __gameStack.__gameWindow.camera || {pos: {x: 0, y: 0, z: 0}};\r\n\r\n            var x = p.x, y = p.y;\r\n\r\n\r\n            x -= camera.position.x || 0;\r\n            y -= camera.position.y  || 0;\r\n            //optional animation : gameSize\r\n\r\n            var targetSize = sprite.size || sprite.selected_animation.size;\r\n\r\n            var realWidth = targetSize.x;\r\n            var realHeight = targetSize.y;\r\n\r\n            //optional animation : offset\r\n\r\n            if (sprite.selected_animation.offset) {\r\n                x += sprite.selected_animation.offset.x;\r\n\r\n                y += sprite.selected_animation.offset.y;\r\n\r\n            }\r\n\r\n            var rotation;\r\n\r\n            if (typeof(sprite.rotation) == 'object') {\r\n\r\n                rotation = sprite.rotation.x;\r\n\r\n\r\n            }\r\n            else {\r\n                rotation = sprite.rotation;\r\n\r\n            }\r\n\r\n\r\n            this.drawFrameWithRotation(sprite.selected_animation.image.domElement, frame.framePos.x, frame.framePos.y, frame.frameSize.x, frame.frameSize.y, Math.round(x + (realWidth / 2)), Math.round(y + (realHeight / 2)), realWidth, realHeight, rotation % 360, ctx, sprite.flipX);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nGameStack.ready(function (lib) {\r\n\r\n    GameStack.log('GameStack:lib :: ready');\r\n\r\n\r\n});\r\n\r\n\r\n/**\r\n *\r\n *  class: GameWindow:\r\n *  args{canvas, ctx, sprites, backgrounds, interactives, forces, update}\r\n */\r\n\r\n\r\nclass GameWindow {\r\n\r\n    constructor({canvas, ctx, sprites, backgrounds, interactives, forces, update, camera}) {\r\n\r\n        this.sprites = sprites instanceof Array ? sprites : [];\r\n\r\n        this.backgrounds = backgrounds instanceof Array ? backgrounds : [];\r\n\r\n        this.interactives = interactives instanceof Array ? interactives : [];\r\n\r\n        this.forces = forces instanceof Array ? forces : [];\r\n\r\n        this.canvas = canvas|| false;\r\n\r\n\r\n        if(!this.canvas)\r\n        {\r\n            console.info('creating new canvas');\r\n            this.canvas = document.createElement('CANVAS');\r\n\r\n            document.body.append(this.canvas);\r\n\r\n            this.canvas.style.position = 'absolute';\r\n\r\n\r\n            this.canvas.style.width = '100%';\r\n\r\n            this.canvas.style.height = '100%';\r\n\r\n            this.canvas.style.background = 'black';\r\n\r\n            var c = this.canvas;\r\n\r\n            this.adjustSize();\r\n        }\r\n\r\n        this.ctx = this.canvas.getContext('2d');\r\n\r\n\r\n        window.onresize = function(){\r\n\r\n            __gameStack.__gameWindow.adjustSize();\r\n\r\n        };\r\n\r\n        this.camera = new Camera();\r\n\r\n        this.camera.target = false;\r\n\r\n        __gameStack.camera = this.camera;\r\n\r\n        if (typeof update == 'function') {\r\n            this.onUpdate(update);\r\n\r\n        }\r\n\r\n\r\n        __gameStack.canvas = this.canvas;\r\n\r\n        __gameStack.ctx = this.ctx;\r\n\r\n       __gameStack.__gameWindow = this;\r\n\r\n    }\r\n\r\n\r\n    adjustSize(w, h)\r\n    {\r\n        w = w || this.canvas.clientWidth;\r\n\r\n        h = h || this.canvas.clientHeight;\r\n\r\n        __gameStack.WIDTH = w;\r\n\r\n        __gameStack.HEIGHT = h;\r\n\r\n        this.canvas.width = w;\r\n\r\n        this.canvas.height = h;\r\n\r\n    }\r\n\r\n    uniques(list) {\r\n\r\n        var listout = [];\r\n\r\n        $Q.each(list, function (ix, item) {\r\n\r\n            if (!listout.indexOf(item.id) >= 0) {\r\n\r\n                var str = item.name;\r\n\r\n                listout.push({\"sprite\": item});\r\n\r\n            }\r\n\r\n        });\r\n\r\n        return listout;\r\n\r\n    }\r\n\r\n    setPlayer(player) {\r\n        this.player = player;\r\n\r\n        if (!this.sprites.indexOf(player) >= 0) {\r\n            this.sprites.push(player);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n\r\n        GameStack.each(this.sprites, function (ix, item) {\r\n\r\n            if (typeof(item.update) == 'function') {\r\n                item.update(item);\r\n\r\n            }\r\n\r\n            if (typeof(item.def_update) == 'function') {\r\n                //  console.log('def_update');\r\n\r\n                item.def_update(item);\r\n\r\n            }\r\n\r\n        });\r\n\r\n\r\n\r\n        GameStack.each(this.forces, function (ix, item) {\r\n\r\n            if (typeof(item.update) == 'function') {\r\n\r\n                item.update(item);\r\n\r\n            }\r\n\r\n            if (typeof(item.def_update) == 'function') {\r\n                //  console.log('def_update');\r\n\r\n                item.def_update(item);\r\n\r\n            }\r\n\r\n        });\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    loadLevelFile(filepath, callback)\r\n    {\r\n\r\n        $.getJSON(filepath, function(data) {\r\n\r\n            callback(false, data);\r\n\r\n        });\r\n    }\r\n\r\n\r\n    draw() {\r\n\r\n        var _gw = this;\r\n\r\n        GameStack.each(this.sprites, function (ix, item) {\r\n\r\n            Canvas.draw(item, _gw.ctx);\r\n\r\n        });\r\n\r\n    }\r\n\r\n}\r\n;\r\n\r\n\r\nclass TextDisplay {\r\n\r\n\r\n}\r\n\r\n\r\n/**TODO:complete the following\r\n *  class: StatDisplay:\r\n *  class: BarDisplay\r\n *  class: VideoDisplay\r\n */\r\n\r\n\r\nclass ItemDisplay //show an item display (image with text/number to the right\r\n{\r\n    constructor({font, fontSize}) {\r\n\r\n    }\r\n\r\n    set(text, image, color, font) {\r\n\r\n\r\n    }\r\n\r\n    size() {\r\n\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nclass BarDisplay //show a display bar such as health bar\r\n{\r\n    constructor({font, fontSize}) {\r\n\r\n    }\r\n\r\n    set(text, image, color, font) {\r\n\r\n\r\n    }\r\n\r\n    size() {\r\n\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n    }\r\n\r\n}\r\n\r\nclass VideoDisplay //show a video\r\n{\r\n    constructor({src, size}) {\r\n\r\n        this.domElement = undefined;\r\n\r\n        this.src = src;\r\n\r\n        this.size = new Vector3(size.x, size.y, size.z || 0);\r\n\r\n        GameStack.log('VideoDisplay():: TODO: create dom element');\r\n\r\n    }\r\n\r\n    play() {\r\n\r\n    }\r\n}\r\n\r\n;\r\n/**\r\n * Animation({name:string,description:string,frames:[],image:GameImage(),src:string,domElement:Image(),type:string})\r\n * [See Live Demo with Usage-Example]{@link http://www.google.com}\r\n * @returns {Animation} object of Animation()\r\n * */\r\n\r\nclass Animation {\r\n    constructor(args) {\r\n\r\n        args = args || {};\r\n\r\n        var _anime = this;\r\n\r\n        this.name = this.getArg(args, 'name', '_blank'),\r\n\r\n        this.description =  this.getArg(args, 'description', '_blank')\r\n\r\n        this.frames = this.getArg(args, 'frames', []);\r\n\r\n        this.image = new GameImage(__gameStack.getArg(args, 'src', __gameStack.getArg(args, 'image', false)));\r\n\r\n        this.src = this.image.domElement.src;\r\n\r\n        this.domElement = this.image.domElement;\r\n\r\n        this.type = this.getArg(args, 'type', 'basic');\r\n\r\n        this.delay = this.getArg(args, 'delay', 0);\r\n\r\n        this.cix = 0;\r\n\r\n        this.frameSize = this.getArg(args, 'frameSize', new Vector3(44, 44, 0));\r\n\r\n        this.frameBounds = this.getArg(args, 'frameBounds', new VectorFrameBounds(new Vector3(0, 0, 0), new Vector3(0, 0, 0), new Vector3(0, 0, 0)));\r\n\r\n        this.frameOffset = this.getArg(args, 'frameOffset', new Vector3(0, 0, 0));\r\n\r\n        this.extras = this.getArg(args, 'extras', false);\r\n\r\n      if(typeof(args) == 'object' && args.frameBounds && args.frameSize){  this.apply2DFrames(args.parent || {}) };\r\n\r\n        this.flipX = this.getArg(args, 'flipX', false);\r\n\r\n        this.priority = this.getArg(args, 'priority', 0);\r\n\r\n        this.cix = 0;\r\n\r\n        this.selected_frame = this.frames[0];\r\n\r\n        this.earlyTerm = this.getArg(args, 'earlyTerm', false);\r\n\r\n        this.hang =this.getArg(args, 'hang', false);\r\n\r\n        this.duration = this.getArg(args, 'duration', 1000);\r\n\r\n        this.size =  this.getArg(args, 'size', new Vector3(20, 20, 20));\r\n\r\n        this.effects = [];\r\n\r\n        this.timer = 0;\r\n\r\n        this.__gameLogic = false;\r\n\r\n        this.setType = function(){  };\r\n\r\n    }\r\n\r\n    singleFrame(frameSize, size)\r\n    {\r\n\r\n        this.__frametype = 'single';\r\n\r\n        this.frameSize = frameSize;\r\n\r\n        this.size = size;\r\n\r\n        this.selected_frame = {\r\n            image: this.image,\r\n            frameSize: this.frameSize,\r\n            framePos: {x: 0, y: 0}\r\n        };\r\n\r\n        this.frames[0] = this.selected_frame;\r\n\r\n\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n        if (args.hasOwnProperty(key)) {\r\n\r\n            return args[key];\r\n\r\n        }\r\n        else {\r\n            return fallback;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    apply2DFrames() {\r\n\r\n        this.frames = [];\r\n\r\n        var fcount = 0;\r\n\r\n\r\n        var quitLoop = false;\r\n\r\n        for (let y = this.frameBounds.min.y; y <= this.frameBounds.max.y; y++) {\r\n\r\n            for (let x = this.frameBounds.min.x; x <= this.frameBounds.max.x; x++) {\r\n\r\n                let framePos = {x: x * this.frameSize.x + this.frameOffset.x, y: y * this.frameSize.y + this.frameOffset.y};\r\n\r\n                this.frames.push({image: this.image, frameSize: this.frameSize, framePos: framePos});\r\n\r\n                if( x >= this.frameBounds.termPoint.x && y >= this.frameBounds.termPoint.y)\r\n                {\r\n\r\n                    quitLoop = true;\r\n\r\n                    break;\r\n                }\r\n\r\n                fcount += 1;\r\n\r\n                if(quitLoop)\r\n                    break;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        this.frames[0] = !this.frames[0] ? {\r\n                image: this.image,\r\n                frameSize: this.frameSize,\r\n                framePos: {x: this.frameBounds.min.x, y: this.frameBounds.min.y}\r\n            } : this.frames[0];\r\n\r\n       // this.selected_frame = this.frames[this.cix % this.frames.length] || this.frames[0];\r\n\r\n    }\r\n\r\n    resetFrames() //special reset function:: frames are re-rendered each reset()\r\n    {\r\n\r\n        this.apply2DFrames();\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        this.selected_frame = this.frames[Math.round(this.cix) % this.frames.length];\r\n\r\n\r\n    }\r\n\r\n    reset()\r\n{\r\n\r\n    this.resetFrames();\r\n\r\n    this.cix = 0;\r\n\r\n}\r\n\r\ncontinuous(duration)\r\n{\r\n\r\n    if(this.__frametype == 'single')\r\n    {\r\n        return 0;\r\n\r\n    }\r\n\r\n  this.apply2DFrames();\r\n\r\n    //update once:\r\n    this.update();\r\n\r\n\r\n    if(this.cix == 0)\r\n  {\r\n\r\n      this.engage();\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\nengage(duration, complete)\r\n{\r\n\r\n    if(this.__frametype == 'single')\r\n    {\r\n        return 0;\r\n\r\n    }\r\n\r\n\r\n    let __inst = this;\r\n\r\n    this.complete = complete || this.complete || function(){  };\r\n\r\n    var duration = duration || typeof(this.duration) == 'number' ? this.duration : this.frames.length * 20;\r\n\r\n    if(this.cix == 0 && this.extras)\r\n    {\r\n        this.extras.call(); //fire any extras attached\r\n\r\n    }\r\n\r\n    //we have a target\r\n  this.tween = new TWEEN.Tween(this)\r\n        .easing(__inst.curve || TWEEN.Easing.Linear.None)\r\n\r\n        .to({cix:__inst.frames.length - 1}, duration)\r\n        .onUpdate(function() {\r\n            //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n         //   __inst.cix = Math.ceil(__inst.cix);\r\n\r\n        __inst.update();\r\n\r\n        })\r\n        .onComplete(function() {\r\n            //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n            if(__inst.complete)\r\n            {\r\n\r\n                __inst.complete();\r\n\r\n            }\r\n\r\n            __inst.cix = 0;\r\n\r\n            __inst.isComplete = true;\r\n\r\n        });\r\n\r\n\r\n  this.tween.start();\r\n\r\n\r\n}\r\n\r\nonComplete(fun)\r\n{\r\n    this.complete = fun;\r\n\r\n}\r\n\r\n    animate() {\r\n\r\n        this.apply2DFrames();\r\n\r\n        this.timer += 1;\r\n\r\n        if(this.delay == 0 || this.timer % this.delay == 0) {\r\n\r\n            if(this.hang)\r\n            {\r\n                this.cix = this.cix + 1;\r\n\r\n                if(this.cix > this.frames.length - 1)\r\n                {\r\n                    this.cix =  this.frames.length - 1;\r\n\r\n                }\r\n\r\n            }\r\n            else\r\n            {\r\n\r\n                if(this.cix == 0 && this.extras)\r\n                {\r\n                    this.extras.call(); //fire any extras attached\r\n\r\n                }\r\n\r\n                if(this.cix >= this.frames.length - 1 && typeof(this.complete) == 'function')\r\n                {\r\n                    this.complete(this);\r\n\r\n                }\r\n\r\n                this.cix = this.cix >= this.frames.length - 1 ? this.frameBounds.min.x : this.cix + 1;\r\n            }\r\n\r\n            this.update();\r\n\r\n        }\r\n\r\n    }\r\n\r\n};\r\n;/**\r\n * Camera : has simple x, y, z, position / Vector, follows a specific sprite\r\n *\r\n * *TODO : implement camera class\r\n */\r\n\r\n\r\nclass Camera\r\n{\r\n\r\n    constructor(args)\r\n    {\r\n\r\n      this.position = new Vector3(0, 0, 0);\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n;\r\n/*****************\r\n *  Controls():\r\n *\r\n *  Dependencies: (1) :\r\n *      -Quick2d.GamepadAdapter, HTML5 Gamepad Api\r\n ******************/\r\n\r\nclass Controls {\r\n\r\n    constructor(args) {\r\n\r\n\r\n        this.__controller = args.controller;\r\n\r\n    }\r\n\r\n    extendedCall(call, extension)\r\n    {\r\n\r\n        var formerCall = call;\r\n\r\n        call = function(){ call(); extension(); };\r\n\r\n        return call;\r\n\r\n    }\r\n\r\n    on(key, callback)\r\n    {\r\n\r\n        if(typeof(this.__controller) == 'object' && typeof(this.__controller[key]) == 'function')\r\n        {\r\n\r\n            console.info('applying controller function:' + key);\r\n\r\n            this.__controller[key] = this.extendedCall(this.__controller[key], callback);\r\n\r\n        }\r\n        else\r\n        {\r\n            console.error('could not apply controller function');\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n\r\n\r\n;\r\nclass Extras\r\n{\r\n\r\n    constructor(args)\r\n    {\r\n        this.items = args || [];\r\n\r\n        if(typeof(this.items)== 'object')\r\n        {\r\n            this.items = [this.items]; //assert array from single object\r\n        }\r\n\r\n        if(!(this.items instanceof Array))\r\n        {\r\n\r\n            return console.error('Quick2d.Extras.call(), needs array argument');\r\n\r\n        }\r\n\r\n    }\r\n\r\n    call()\r\n    {\r\n\r\n        var items = this.items;\r\n\r\n        //a callable item can be one-time executed: it will have any of the following functions attached\r\n\r\n        for(var x = 0; x < items.length; x++)\r\n        {\r\n            var item = items[x];\r\n\r\n            if(typeof(item.play) == 'function')\r\n            {\r\n                item.play();\r\n\r\n            }\r\n\r\n\r\n            if(typeof(item.engage) == 'function')\r\n            {\r\n                item.engage();\r\n\r\n            }\r\n\r\n            if(typeof(item.fire) == 'function')\r\n            {\r\n                item.fire();\r\n\r\n            }\r\n\r\n            if(typeof(item.start) == 'function')\r\n            {\r\n                item.start();\r\n\r\n            }\r\n\r\n            if(typeof(item.run) == 'function')\r\n            {\r\n                item.run();\r\n\r\n            }\r\n\r\n            if(typeof(item.process) == 'function')\r\n            {\r\n                item.process();\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n;\r\n/**\r\n * Force()\r\n *\r\n * <ul >\r\n *  <li> a 'physics' object\r\n *  <li> easily instantiate physical behaviors, applied to specific groups of objects\r\n * </ul>\r\n *\r\n * [See Live Demos with Suggested Usage-Examples]{@link http://www.google.com}\r\n * @returns {Force} object of Force()\r\n * */\r\n\r\nclass GravityForce\r\n{\r\n    constructor(args)\r\n    {\r\n\r\n        this.name = args.name || \"\";\r\n\r\n        this.description = args.description || \"\";\r\n\r\n        this.subjects = args.subjects || [];\r\n        this.origin =  args.origin || {};\r\n        this.massObjects = args.massObjects || [];\r\n\r\n        this.minSpeed = args.minSpeed || new Vector3(1, 1, 1);\r\n\r\n        this.max = args.max || new Vector3(3, 3, 3);\r\n         this.accel = args.accel || new Vector3(1.3, 1.3, 1.3);\r\n\r\n        for(var x in args)\r\n        {\r\n            this[x] = args[x];\r\n\r\n        }\r\n\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n        if (args.hasOwnProperty(key)) {\r\n\r\n            return args[key];\r\n\r\n        }\r\n        else {\r\n            return fallback;\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    update()\r\n    {\r\n\r\n      var  subjects = this.subjects;\r\n\r\n       var origin =  this.origin || {};\r\n\r\n       var massObjects =  this.massObjects;\r\n\r\n      var  accel =  this.accel || {};\r\n\r\n        var max =  this.max || {};\r\n\r\n        __gameStack.each(subjects, function(ix, itemx){\r\n\r\n           itemx.accelY(accel, max);\r\n\r\n           itemx.__inAir = true;\r\n\r\n            __gameStack.each(massObjects, function(iy, itemy){\r\n\r\n                itemx.collide_stop(itemy);\r\n\r\n\r\n            });\r\n        });\r\n    }\r\n};\r\n\r\nlet Force = GravityForce;\r\n\r\n\r\n\r\n\r\n\r\n\r\n;\r\nclass StatEffect{\r\n\r\n    constructor(name, value) {\r\n\r\n        this.__is = \"a game logic effect\";\r\n\r\n        this.name =name;\r\n\r\n        this.value = value;\r\n\r\n    }\r\n\r\n    process(object)\r\n    {\r\n        //if the object has any property by effect.name, the property is incremenented by effect value\r\n        //a health decrease is triggered by Effect('health', -10);\r\n\r\n\r\n        for(var x in object)\r\n        {\r\n            if(x.toLowerCase() == this.name.toLowerCase() && typeof(value) == typeof(object[x]))\r\n            {\r\n\r\n                object[x] += this.value;\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nclass Collision\r\n{\r\n    constructor({object, collideables, extras})\r\n    {\r\n        this.object = object || [];\r\n\r\n        this.collideables = collideables instanceof Array ? collideables : [];\r\n\r\n        this.extras = extras instanceof Array ? extras : []; //anything extra to execute onCollision\r\n        //note: extras are any StatEffect, Animation, Movement to be simultaneously executed with this Collision\r\n\r\n    }\r\n\r\n    Object(object)\r\n    {\r\n        this.object = object;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    Extras(extras)\r\n    {\r\n        this.extras = extras;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    Collideables(collideables)\r\n    {\r\n        this.collideables = collideables;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    onCollide(fun)\r\n    {\r\n        this.callback = fun;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    collide()\r\n    {\r\n        this.callback();\r\n    }\r\n\r\n    process()\r\n    {\r\n        //if collision, call collide()\r\n\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n\r\nclass GameLogic {\r\n\r\n    constructor(gameEffectList)\r\n    {\r\n        if(!gameEffectList instanceof Array)\r\n        {\r\n\r\n            console.info('GameLogic: gameEffectList was not an array');\r\n\r\n            gameEffectList = [];\r\n\r\n        }\r\n\r\n       this.gameEffects = gameEffectList;\r\n\r\n    }\r\n    process_all()\r\n    {\r\n        //process all game logic objects::\r\n\r\n            for(var x = 0; x < this.gameEffects.length; x++)\r\n            {\r\n\r\n                this.gameEffects[x].process();\r\n\r\n            }\r\n\r\n    }\r\n    add(gameeffect)\r\n    {\r\n\r\n        this.gameEffects.push(gameeffect);\r\n\r\n    }\r\n\r\n}\r\n;\r\n\r\n/**\r\n * GamepadAdapter()\r\n *\r\n * <ul >\r\n *  <li> supports game-controller input for web-games\r\n *  <li> accesses live gamepad input from the HTML5 Gamepad Api\r\n * </ul>\r\n *\r\n * [See Live Demos with Suggested Usage-Examples]{@link http://www.google.com}\r\n * @returns {GamepadAdapter} object of GamepadAdapter()\r\n * */\r\n\r\nclass GamepadAdapter {\r\n\r\n    constructor() {\r\n\r\n        this.__gamepads = [];\r\n\r\n        this.intervals = [];\r\n\r\n        let controller_stack = this;\r\n\r\n        let _gpinst = this;\r\n\r\n        this.events = [];\r\n\r\n        window.setInterval(function () {\r\n\r\n            var gps = navigator.getGamepads();\r\n\r\n            _gpinst.gps = gps;\r\n\r\n            for(var x = 0; x < gps.length; x++) {\r\n\r\n            var events = _gpinst.__gamepads[x] ? _gpinst.__gamepads[x] : {};\r\n\r\n             _gpinst.process(gps[x], events);\r\n\r\n            }\r\n\r\n\r\n        }, 20);\r\n\r\n    }\r\n\r\n    gamepads()\r\n    {\r\n\r\n        return  navigator.getGamepads();\r\n\r\n    }\r\n\r\n\r\n    disconnect_all() {\r\n\r\n        for (var x = 0; x < this.intervals.length; x++) {\r\n\r\n            window.clearInterval(this.intervals[x]);\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    disconnect_by_index(game_pad_index) {\r\n\r\n        window.clearInterval(this.intervals[game_pad_index]);\r\n\r\n    }\r\n\r\n    hasAnyPad() {\r\n        return \"getGamepads\" in navigator;\r\n\r\n    }\r\n\r\n    Event(key, game_pad, callback) {\r\n        return {\r\n\r\n            key: key, game_pad:game_pad, callback: callback\r\n\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    GamepadEvents(args)\r\n    {\r\n\r\n        var gp = {};\r\n\r\n        gp.stick_left = args.stick_left || function(x, y)\r\n        {\r\n\r\n          //  console.log('Def call');\r\n\r\n        }\r\n\r\n\r\n        gp.stick_right = args.stick_right ||  function(x, y)\r\n        {\r\n\r\n        }\r\n\r\n        gp.buttons = [];\r\n\r\n        gp.extendFunc = function(f1, f2)\r\n        {\r\n\r\n            var fc = f2;\r\n\r\n           return function(x, y){\r\n\r\n                f2(x, y);\r\n\r\n               f1(x, y);\r\n\r\n            }\r\n\r\n        };\r\n\r\n        gp.on = function(key, callback)\r\n        {\r\n\r\n            if(this[key] && key !== \"on\")\r\n            {\r\n\r\n                var current_cb =  typeof(this[key]) == 'function' ? this[key] : function(x, y){};\r\n\r\n               this[key] = this.extendFunc(callback, current_cb);\r\n\r\n\r\n            }\r\n\r\n            else if(key.indexOf('button') >= 0 && key.indexOf('_') >= 0 )\r\n            {\r\n                var parts = key.split('_');\r\n\r\n                var number;\r\n\r\n                try\r\n                {\r\n\r\n                    number = parseInt(parts[1]);\r\n\r\n\r\n                    var current_cb =  typeof(this['buttons'][number]) == 'function' ? this['buttons'][number] : function(x, y){};\r\n\r\n                    this['buttons'][number] = this.extendFunc(callback, current_cb);\r\n\r\n                }\r\n                catch (e)\r\n                    {\r\n                      console.error('could not parse \"on\" event with ' + key);\r\n\r\n                    }\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n        this.__gamepads.push(gp);\r\n\r\n        return gp;\r\n\r\n    }\r\n\r\n\r\n\r\n    process(gp, gpEvents)\r\n    {\r\n\r\n        this.process_buttons(gp, gpEvents);\r\n\r\n        this.process_axes(gp, gpEvents);\r\n\r\n    }\r\n\r\n\r\n    process_axes(gp, events)\r\n    {\r\n\r\n        if(!gp || !gp['axes'])\r\n        {\r\n\r\n            return false;\r\n\r\n        }\r\n\r\n\r\n        for (var i = 0; i < gp.axes.length; i += 2) {\r\n            var axis1 = gp.axes[i], axia2 = gp.axes[i + 1];\r\n\r\n            var ix = (Math.ceil(i / 2) + 1), x = gp.axes[i], y = gp.axes[i + 1];\r\n\r\n\r\n\r\n            if(ix == 1 && events.stick_left)\r\n            {\r\n                events.stick_left(x, y);\r\n\r\n            }\r\n\r\n            if(ix == 2 && events.stick_right)\r\n            {\r\n                events.stick_right(x, y);\r\n\r\n            }\r\n\r\n            if (this.events && this.events['stick_' + i] && typeof(this.events['stick_' + i].callback) == 'function') {\r\n                this.events['stick_' + i].callback();\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n    process_buttons(gp, events) {\r\n\r\n        if(!gp || !gp['buttons'])\r\n        {\r\n             return false;\r\n\r\n        }\r\n\r\n        for (var i = 0; i < gp.buttons.length; i++) {\r\n\r\n            if (gp.buttons[i].pressed) {\r\n\r\n               // console.log('button:' + i);\r\n\r\n                    if (typeof(events.buttons[i]) == 'function') {\r\n                        events.buttons[i](gp.buttons[i].pressed);\r\n                    }\r\n                    else if (typeof( events.buttons[i]) == 'object' && typeof(events.buttons[i].update) == 'function') {\r\n                        events.buttons[i].update(events.buttons[i].pressed);\r\n\r\n                    }\r\n\r\n                var clearance_1 = this.events && this.events[i], gpc, bkey = \"button_\" + i;\r\n\r\n                if (clearance_1) {\r\n                    gpc = this.events[bkey] && !isNaN(this.events[bkey].game_pad) ? this.gamepads[this.events[bkey].game_pad] : this.events[bkey].game_pad;\r\n                }\r\n                ;\r\n\r\n                if (clearance_1 && gpc && typeof(this.events[bkey].callback) == 'function') {\r\n                    //call the callback\r\n                    this.events[i].callback();\r\n\r\n                }\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n    on(key, gpix, callback) {\r\n\r\n        if(gpix >= this.__gamepads.length)\r\n        {\r\n\r\n            this.__gamepads.push(this.GamepadEvents({}));\r\n\r\n        }\r\n\r\n        this.__gamepads[gpix].on(key, callback);\r\n\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n\r\n\r\nif(!__gameInstance.GamepadAdapter)\r\n{\r\n    __gameInstance.GamepadAdapter = new GamepadAdapter();\r\n\r\n    __gameInstance.gamepads = [];\r\n\r\n    GameStack.GamepadAdapter = __gameInstance.GamepadAdapter;\r\n\r\n    GameStack.gamepads = __gameInstance.gamepads;\r\n\r\n    GameStack.GamepadAdapter.on('stick_left', 0, function(x, y){\r\n\r\n        console.log('Gamepad stick left');\r\n\r\n    });\r\n\r\n    GameStack.GamepadAdapter.on('button_0', 0, function(x, y){\r\n\r\n        console.log('Gamepad button 0');\r\n\r\n    });\r\n\r\n\r\n    GameStack.GamepadAdapter.on('button_1', 0, function(x, y){\r\n\r\n        console.log('Gamepad button 1');\r\n\r\n    });\r\n\r\n    GameStack.GamepadAdapter.on('button_2', 0, function(x, y){\r\n\r\n        console.log('Gamepad button 2');\r\n\r\n    });\r\n\r\n    GameStack.GamepadAdapter.on('button_3', 0, function(x, y){\r\n\r\n        console.log('Gamepad button 3');\r\n\r\n    });\r\n\r\n   // __gameInstance.gamepads.push(gamepad);\r\n\r\n};\r\n\r\n\r\n\r\n;\r\n\r\n\r\nclass GravityAction\r\n{\r\n    constructor()\r\n    {\r\n\r\n    }\r\n\r\n}\r\n\r\nclass Graviton {\r\n    constructor(args) {\r\n\r\n    }\r\n}\r\n\r\nclass GravitationalRay {\r\n    constructor(args) {\r\n\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n;\r\nclass Motion {\r\n    constructor(args) {\r\n\r\n        this.getArg = $Q.getArg;\r\n\r\n        this.distance = this.getArg(args, 'distance', this.getArg(args, 'distances', false));\r\n\r\n        this.curvesList = this.curvesObject(); //Tween.Easing\r\n\r\n        this.parent_id = args.parent_id || args.object_id || \"__blank\"; //The parent object\r\n\r\n        this.curve = this.getArg(args, 'curve', TWEEN.Easing.Quadratic.InOut);\r\n\r\n        this.targetRotation = this.getArg(args, 'targetRotation', 0);\r\n\r\n        this.name = this.getArg(args, 'name', \"__\");\r\n\r\n        this.description = this.getArg(args, 'description', false);\r\n\r\n        this.curveString = this.getCurveString(); //store a string key for the Tween.Easing || 'curve'\r\n\r\n        this.setCurve(this.curveString);\r\n\r\n        this.line = this.getArg(args, 'line', false);\r\n\r\n        this.duration = this.getArg(args, 'duration', 500);\r\n\r\n        this.delay = this.getArg(args, 'delay', 0);\r\n\r\n        this.duration = this.getArg(args, 'duration', false);\r\n\r\n\r\n    }\r\n\r\n\r\n    curvesObject() {\r\n\r\n        var c = [];\r\n\r\n        GameStack.each(TWEEN.Easing, function (ix, easing) {\r\n\r\n            GameStack.each(easing, function (iy, easeType) {\r\n\r\n                if (['in', 'out', 'inout'].indexOf(iy.toLowerCase()) >= 0) {\r\n\r\n                    c.push(ix + \"_\" + iy);\r\n\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n\r\n        return c;\r\n\r\n    }\r\n\r\n\r\n    getCurveString() {\r\n\r\n        var __inst = this;\r\n\r\n        var c;\r\n\r\n        $.each(TWEEN.Easing, function (ix, easing) {\r\n\r\n            $.each(TWEEN.Easing[ix], function (iy, easeType) {\r\n\r\n\r\n                if (__inst.curve == TWEEN.Easing[ix][iy]) {\r\n\r\n                    c = ix + \"_\" + iy;\r\n\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n\r\n        return c;\r\n\r\n    }\r\n\r\n\r\n    setCurve(c) {\r\n\r\n        var cps = c.split('_');\r\n\r\n        var s1 = cps[0], s2 = cps[1];\r\n\r\n\r\n        var curve = TWEEN.Easing.Quadratic.InOut;\r\n\r\n\r\n        $.each(TWEEN.Easing, function (ix, easing) {\r\n\r\n            $.each(TWEEN.Easing[ix], function (iy, easeType) {\r\n\r\n\r\n                if (ix == s1 && iy == s2) {\r\n\r\n                    // alert('setting curve');\r\n\r\n                    curve = TWEEN.Easing[ix][iy];\r\n\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n\r\n        this.curve = curve;\r\n\r\n\r\n        return curve;\r\n\r\n    }\r\n\r\n    engage() {\r\n\r\n        var tweens = [];\r\n\r\n        //construct a tween::\r\n\r\n        var __inst = this;\r\n\r\n\r\n        var objects = {};\r\n\r\n        $.each(Game.sprites, function (ix, item) {\r\n\r\n            if (item.id == __inst.parent_id) {\r\n\r\n                objects[ix] = item;\r\n\r\n            }\r\n        });\r\n\r\n\r\n        var target = {\r\n\r\n            x: __inst.distance.x + objects[0].position.x,\r\n            y: __inst.distance.y + objects[0].position.y,\r\n            z: __inst.distance.z + objects[0].position.z\r\n\r\n        };\r\n\r\n        if (__inst.targetRotation > 0 || __inst.targetRotation < 0) {\r\n\r\n\r\n            var targetR = __inst.targetRotation + objects[0].rotation.x;\r\n\r\n            //we have a target\r\n            tweens[0] = new TWEEN.Tween(objects[0].rotation)\r\n                .easing(__inst.curve || TWEEN.Easing.Elastic.InOut)\r\n\r\n                .to({x: targetR}, __inst.duration)\r\n                .onUpdate(function () {\r\n                    //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n\r\n                })\r\n                .onComplete(function () {\r\n                    //console.log(objects[0].position.x, objects[0].position.y);\r\n                    if (__inst.complete) {\r\n\r\n                        __inst.complete();\r\n\r\n                    }\r\n\r\n\r\n                });\r\n\r\n\r\n        }\r\n\r\n        //we have a target\r\n        tweens.push(new TWEEN.Tween(objects[0].position)\r\n            .easing(__inst.curve || TWEEN.Easing.Elastic.InOut)\r\n\r\n            .to(target, __inst.duration)\r\n            .onUpdate(function () {\r\n                //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n\r\n            })\r\n            .onComplete(function () {\r\n                //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n                if (__inst.complete) {\r\n\r\n                    __inst.complete();\r\n\r\n                }\r\n\r\n\r\n            }));\r\n\r\n\r\n        __inst.delay = !isNaN(__inst.delay) && __inst.delay > 0 ? __inst.delay : 0;\r\n\r\n\r\n        return {\r\n\r\n            tweens: tweens,\r\n\r\n            delay: __inst.delay,\r\n\r\n            fire: function () {\r\n\r\n                var __tweenObject = this;\r\n\r\n                window.setTimeout(function () {\r\n\r\n                    for (var x = 0; x < __tweenObject.tweens.length; x++) {\r\n\r\n                        __tweenObject.tweens[x].start();\r\n\r\n                    }\r\n\r\n                }, this.delay);\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    start() {\r\n        this.engage().fire();\r\n\r\n    }\r\n\r\n\r\n    onComplete(fun) {\r\n        this.complete = fun;\r\n\r\n    }\r\n\r\n    // obj.getGraphCanvas( $(c.domElement), value.replace('_', '.'), TWEEN.Easing[parts[0]][parts[1]] );\r\n\r\n    getGraphCanvas( t, f, c) {\r\n\r\n        var canvas = document.createElement('canvas');\r\n\r\n        canvas.id = 'curve-display';\r\n\r\n        canvas.width = 180;\r\n        canvas.height = 100;\r\n\r\n\r\n        var context = canvas.getContext('2d');\r\n        context.fillStyle = \"rgb(250,250,250)\";\r\n        context.fillRect(0, 0, 180, 100);\r\n\r\n        context.lineWidth = 0.5;\r\n        context.strokeStyle = \"rgb(230,230,230)\";\r\n\r\n        context.beginPath();\r\n        context.moveTo(0, 20);\r\n        context.lineTo(180, 20);\r\n        context.moveTo(0, 80);\r\n        context.lineTo(180, 80);\r\n        context.closePath();\r\n        context.stroke();\r\n\r\n        context.lineWidth = 2;\r\n        context.strokeStyle = \"rgb(255,127,127)\";\r\n\r\n        var position = {x: 5, y: 80};\r\n        var position_old = {x: 5, y: 80};\r\n\r\n        new TWEEN.Tween(position).to({x: 175}, 2000).easing(TWEEN.Easing.Linear.None).start();\r\n        new TWEEN.Tween(position).to({y: 20}, 2000).easing(f).onUpdate(function () {\r\n\r\n            context.beginPath();\r\n            context.moveTo(position_old.x, position_old.y);\r\n            context.lineTo(position.x, position.y);\r\n            context.closePath();\r\n            context.stroke();\r\n\r\n            position_old.x = position.x;\r\n            position_old.y = position.y;\r\n\r\n        }).start();\r\n\r\n        return canvas;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n;\r\n\r\nclass Rectangle {\r\n\r\n    constructor(min, max) {\r\n\r\n        this.min = min;\r\n        this.max = max;\r\n\r\n    }\r\n\r\n\r\n}\r\n;\r\n\r\nlet VectorBounds = Rectangle;\r\n\r\nclass VectorFrameBounds extends Rectangle {\r\n\r\n    constructor(min, max, termPoint) {\r\n\r\n        super(min, max);\r\n\r\n        this.termPoint = termPoint || new Vector3(this.max.x, this.max.y, this.max.z);\r\n\r\n    }\r\n\r\n\r\n}\r\n;\r\n\r\nclass Circle\r\n{\r\n    constructor(args) {\r\n\r\n        this.position = this.getArg(args, 'position', new Vector3(0, 0, 0));\r\n\r\n        this.radius = this.getArgs(args, 'radius', 100);\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\n;/**\r\n * Sprite({name:string, description:string, size:Vector3, position:Vector3})\r\n *\r\n * <ul >\r\n *  <li> an Object-container for multiple animations\r\n *  <li> supports a variety of game objects and logic\r\n * </ul>\r\n *\r\n * [See Live Demos with Suggested Usage-Examples]{@link http://www.google.com}\r\n * @returns {Sprite} object of Sprite()\r\n * */\r\n\r\nclass Sprite {\r\n    constructor(args) {\r\n\r\n        if (!args) {\r\n            args = {};\r\n        }\r\n\r\n        this.active = true; //active sprites are visible\r\n\r\n        this.name = args.name || \"__\";\r\n\r\n        this.description = args.description || \"__\";\r\n\r\n        this.__initializers = __gameStack.getArg(args, '__initializers', []);\r\n\r\n        var _spr = this;\r\n\r\n        Quazar.each(args, function (ix, item) { //apply all args\r\n\r\n            if (ix !== 'parent') {\r\n                _spr[ix] = item;\r\n            }\r\n\r\n        });\r\n\r\n        this.type = __gameStack.getArg(args, 'type', 'basic');\r\n\r\n        this.animations = __gameStack.getArg(args, 'animations', []);\r\n\r\n        this.motions = __gameStack.getArg(args, 'motions', []);\r\n\r\n        let __inst = this;\r\n\r\n        this.id = __gameStack.getArg(args, 'id', this.create_id());\r\n\r\n        this.sounds = __gameStack.getArg(args, 'sounds', []);\r\n\r\n        this.image = new GameImage(__gameStack.getArg(args, 'src', __gameStack.getArg(args, 'image', false)));\r\n\r\n\r\n        this.size = __gameStack.getArg(args, 'size', new Vector3(100, 100));\r\n\r\n\r\n        this.position = __gameStack.getArg(args, 'position', new Vector3(0, 0, 0));\r\n\r\n        this.collision_bounds = __gameStack.getArg(args, 'collision_bounds', new VectorBounds(new Vector3(0, 0, 0), new Vector3(0, 0, 0)));\r\n\r\n        this.rotation = __gameStack.getArg(args, 'rotation', new Vector3(0, 0, 0));\r\n\r\n        this.selected_animation = {};\r\n\r\n        this.speed = __gameStack.getArg(args, 'speed', new Vector3(0, 0, 0));\r\n\r\n        this.acceleration = __gameStack.getArg(args, 'acceleration', new Vector3(0, 0, 0));\r\n\r\n        this.rot_speed = __gameStack.getArg(args, 'rot_speed', new Vector3(0, 0, 0));\r\n\r\n        this.rot_accel = __gameStack.getArg(args, 'rot_accel', new Vector3(0, 0, 0));\r\n\r\n        //Apply / instantiate Sound(), Motion(), and Animation() args...\r\n\r\n        $Q.each(this.sounds, function (ix, item) {\r\n\r\n            __inst.sounds[ix] = new Sound(item);\r\n\r\n        });\r\n\r\n        $Q.each(this.motions, function (ix, item) {\r\n\r\n            __inst.motions[ix] = new Motion(item);\r\n\r\n        });\r\n\r\n\r\n        $Q.each(this.animations, function (ix, item) {\r\n\r\n            __inst.animations[ix] = new Animation(item);\r\n\r\n        });\r\n\r\n\r\n        //Apply initializers:\r\n\r\n        $Q.each(this.__initializers, function (ix, item) {\r\n\r\n            __inst.onInit(item);\r\n\r\n        });\r\n\r\n\r\n        this.__clippedX = false;\r\n\r\n        this.__clippedY = false;\r\n\r\n        if (args.selected_animation) {\r\n            this.selected_animation = new Animation(args.selected_animation);\r\n\r\n        }\r\n        else {\r\n\r\n            this.setAnimation(this.animations[0] || new Animation({\r\n\r\n                    image: this.image,\r\n\r\n                    frameSize: new Vector3(this.image.domElement.width, this.image.domElement.height),\r\n\r\n                    frameBounds: new VectorFrameBounds(new Vector3(), new Vector3())\r\n\r\n\r\n                }));\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * This function initializes sprites when necessary. Called automatically on GameStack.add(mySprite);\r\n     *\r\n     * @function\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    init() {\r\n\r\n\r\n    }\r\n\r\n    /**\r\n     * This function extends the init() function. Takes single function() argument OR single string argument\r\n     * @function\r\n     * @memberof Sprite\r\n     * @param {function} fun the function to be passed into the init() event of the Sprite()\r\n     **********/\r\n\r\n    onInit(fun) {\r\n\r\n        if (typeof fun == 'string') {\r\n\r\n            if (this.__initializers.indexOf(fun) < 0) {\r\n                this.__initializers.push(fun)\r\n            }\r\n            ;\r\n\r\n            var __inst = this;\r\n\r\n            var keys = fun.split('.');\r\n\r\n            console.log('finding init from string:' + fun);\r\n\r\n            if (!keys.length >= 2) {\r\n                return console.error('need min 2 string keys separated by \".\"');\r\n            }\r\n\r\n            var f = Quazar.options.SpriteInitializers[keys[0]][keys[1]];\r\n\r\n            if (typeof(f) == 'function') {\r\n                alert('found func');\r\n\r\n                var __inst = this;\r\n\r\n                var f_init = this.init;\r\n\r\n                this.init = function (sprite) {\r\n\r\n                    f_init(sprite);\r\n\r\n                    f(sprite);\r\n\r\n                };\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n        else if (typeof fun == 'function') {\r\n\r\n            console.log('extending init:');\r\n\r\n\r\n            var f_init = this.init;\r\n\r\n            this.init = function (sprite) {\r\n\r\n                f_init(sprite);\r\n\r\n                fun(sprite);\r\n\r\n            };\r\n\r\n\r\n        }\r\n\r\n        else if (typeof fun == 'object') {\r\n\r\n            console.log('extending init:');\r\n\r\n            console.info('Quick2D does not yet implement onInit() from arg of object type');\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     * Getters\r\n     ***************************/\r\n\r\n    /**\r\n     * This function gets the 'id' of the object()\r\n     * <ul>\r\n     *     <li>See usage links</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @returns {string}\r\n     **********/\r\n\r\n    get_id() {\r\n        return this.id;\r\n    }\r\n\r\n    to_map_object(size, framesize) {\r\n\r\n        this.__mapSize = new Vector3(size || this.size);\r\n\r\n        this.frameSize = new Vector3(framesize || this.size);\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    /*****************************\r\n     * Setters and Creators\r\n     ***************************/\r\n\r\n    /**\r\n     * This function creates the 'id' of the Sprite()\r\n     * <ul>\r\n     *     <li>Called automatically on constructor()</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @returns {string}\r\n     **********/\r\n\r\n    create_id() {\r\n\r\n        return Quick2d.create_id();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * This function sets the size of the Sprite()\r\n     * <ul>\r\n     *     <li></li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n    setSize(size) {\r\n        this.size = new Vector3(size.x, size.y, size.z);\r\n\r\n        this.selected_animation.size = new Vector3(size.x, size.y, size.z);\r\n\r\n    }\r\n\r\n    setPos(pos) {\r\n        this.position = new Vector3(pos.x, pos.y, pos.z || 0);\r\n\r\n    }\r\n\r\n\r\n    getAbsolutePosition(offset) {\r\n\r\n        if (this.position instanceof Vector3) {\r\n\r\n        }\r\n        else {\r\n            this.position = new Vector3(this.position);\r\n        }\r\n\r\n        return this.position.add(offset);\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  assertSpeed()\r\n     *  -assert the existence of a speed{} object\r\n     ***************************/\r\n\r\n    assertSpeed() {\r\n        if (!this.speed) {\r\n\r\n            this.speed = new Vector3(0, 0, 0);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  setAnimation(anime)\r\n     *  -set the select_animation of this sprite\r\n     ***************************/\r\n\r\n    /**\r\n     * This function sets the 'selected_animation' property of the Sprite()\r\n     * <ul>\r\n     *     <li></li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {Animation}\r\n     **********/\r\n\r\n    setAnimation(anime) {\r\n\r\n        if (anime instanceof Animation && this.animations.indexOf(anime) < 0) {\r\n            this.animations.push(anime);\r\n        }\r\n\r\n        this.selected_animation = anime;\r\n\r\n        Quazar.log('declared default animation');\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  defaultAnimation(anime)\r\n     *  -set the default_animation of this sprite\r\n     *  -TODO : determine whether to implement a default animatio OR simply use setAnimation() plus selected_animation\r\n     ***************************/\r\n\r\n    defaultAnimation(anime) {\r\n\r\n        this.animations['default'] = anime;\r\n\r\n        Quazar.log('declared default animation');\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    /*****************************\r\n     * onScreen :\r\n     * -returns boolean\r\n     * -takes and requires w, h of screen\r\n     * -detects if object is on the screen\r\n     ***************************/\r\n\r\n    /**\r\n     * This function detects whether the Sprite() is onScreen, according to its size and position on the GameStack.canvas\r\n     * <ul>\r\n     *     <li></li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     **********/\r\n\r\n\r\n    onScreen(w, h) {\r\n\r\n        w = w || __gameStack.WIDTH;\r\n\r\n        h = h || __gameStack.HEIGHT;\r\n\r\n        var camera = __gameStack.__gameWindow.camera || new Vector3(0, 0, 0);\r\n\r\n        var p = new Vector3(this.position.x - camera.position.x, this.position.y - camera.position.y, this.position.z - camera.position.z);\r\n\r\n        return p.x - this.size.x >= -10000 && p.x < 10000\r\n            && p.y + this.size.y >= -1000 && p.y < 10000;\r\n\r\n    }\r\n\r\n    /*****************************\r\n     * Updates\r\n     ***************************/\r\n\r\n    /*****************************\r\n     * update()\r\n     * -starts empty:: is used by Quick2d.js as the main sprite update\r\n     ***************************/\r\n\r\n    /**\r\n     * This function is the recursive update() for the Sprite()\r\n     *\r\n     * <ul>\r\n     *     <li>*Called automatically by the GameStack library</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {sprite}\r\n     **********/\r\n\r\n\r\n    update(sprite) {\r\n    }\r\n\r\n    /*****************************\r\n     * def_update()\r\n     * -applies speed and other default factors of movement::\r\n     * -is used by Quick2d.js as the system def_update (default update)\r\n     ***************************/\r\n\r\n    /**\r\n     * This function updates various speed and rotational-speed properties for the Sprite()\r\n     *\r\n     * <ul>\r\n     *     <li>Normally no need to use this. It is called automatically by the GameStack init()</li>\r\n     *     <li>*Allows properties of Sprite().speed, Sprite().rot_speed, and Sprite().accel, Sprite().rot_accel to control speed and acceleration.</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {sprite}\r\n     **********/\r\n\r\n    def_update(sprite) {\r\n\r\n\r\n        for (var x in this.speed) {\r\n\r\n            if (this.speed[x] > 0 || this.speed[x] < 0) {\r\n\r\n                this.position[x] += this.speed[x];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        for (var x in this.acceleration) {\r\n\r\n            if (this.acceleration[x] > 0 || this.acceleration[x] < 0) {\r\n\r\n                this.speed[x] += this.acceleration[x];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        for (var x in this.rot_speed) {\r\n\r\n            if (this.rot_speed[x] > 0 || this.rot_speed[x] < 0) {\r\n\r\n                this.rotation[x] += this.rot_speed[x];\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n        for (var x in this.rot_accel) {\r\n\r\n\r\n            if (this.rot_accel[x] > 0 || this.rot_accel[x] < 0) {\r\n\r\n                this.rot_speed[x] += this.rot_accel[x];\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * This function is for persistence of data and behavior for the Sprite()\r\n     *\r\n     * <ul>\r\n     *     <li>a function may be resolved from keyString args from within the obj arg.</li>\r\n     *     <li>Callback is then triggered on this function</li>\r\n     *     <li>Used by GameStack to restore the behavioral options of Sprites from GameStack.options.SpriteInitializers</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {keyString1, keyString2, obj, callback}\r\n     **********/\r\n\r\n    resolveFunctionFromDoubleKeys(keyString1, keyString2, obj, callback) {\r\n\r\n        callback(typeof obj[keyString1][keyString2] == 'function' ? obj[keyString1][keyString2] : {});\r\n\r\n    }\r\n\r\n    /**\r\n     * This function will extend 2nd function arg with 1st function arg, and return the combined function()\r\n     *\r\n     * <ul>\r\n     *     <li>Applied in GameStack for extending functions when onInit(fun) is called</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {fun, extendedFunc}\r\n     **********/\r\n\r\n    extendFunc(fun, extendedFunc) {\r\n\r\n        console.log('extending func');\r\n\r\n        var ef = extendedFunc;\r\n\r\n        var __inst = this;\r\n\r\n        return function () {\r\n\r\n\r\n            ef(__inst);\r\n\r\n            //any new function comes after\r\n\r\n            fun(__inst);\r\n\r\n\r\n        };\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  onUpdate(fun)\r\n     * -args: 1 function(sprite){ } //the self-instance/sprite is passed into the function()\r\n     * -overrides and maintains existing code for update(){} function\r\n     ***************************/\r\n\r\n    /**\r\n     * This function will extend the update of a Sprite()\r\n     *\r\n     * <ul>\r\n     *     <li>Use this function to apply multiple update-calls for an object</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {fun}\r\n     **********/\r\n\r\n    onUpdate(fun) {\r\n        fun = fun || function () {\r\n            };\r\n\r\n        let update = this.update;\r\n\r\n        let __inst = this;\r\n\r\n        this.update = function (__inst) {\r\n            update(__inst);\r\n            fun(__inst);\r\n        };\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  collidesRectangular(sprite)\r\n     * -args: 1 sprite object\r\n     * -returns boolean of true on collision or false on no-collision\r\n     * -TODO : add options object with highlight=true||false,\r\n     * -TODO:allow stateffects, graphiceffects into the collision function\r\n     ***************************/\r\n\r\n    /**\r\n     * Get the boolean(T || F) results of a Collision between two Sprites(), based on their position Vector3's and Size()\r\n     * <ul>\r\n     *     <li>A rectangular style position</li>\r\n     *      <li>Takes another sprite as argument</li>\r\n     *       <li>Returns basic true || false during runtime</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {sprite}\r\n     **********/\r\n\r\n    collidesRectangular(sprite, padding) {\r\n\r\n        return Quazar.Collision.spriteRectanglesCollide(this, sprite, padding);\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  collidesByPixels(sprite)\r\n     *  -TODO : this function is incomplete\r\n     *  -process collision according to the non-transparent pixels of the sprite::\r\n     *  -provides a more realistic collision than basic rectangular\r\n     ***************************/\r\n\r\n    /**\r\n     * Get the boolean(T || F) results of a Collision between two Sprites(), based on non-transparent pixels\r\n     * <ul>\r\n     *     <li>Detects collision or overlap of any non-transparent pixels</li>\r\n     *     <li>*TODO: This function is not-yet implemented in GameStack</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {sprite}\r\n     **********/\r\n\r\n    collidesByPixels(sprite) {\r\n\r\n        return console.info(\"TODO: Sprite().collidesByPixels(sprite): finish this function\");\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  shoot(sprite)\r\n     *  -fire a shot from the sprite:: as in a firing gun or spaceship\r\n     *  -takes options{} for number of shots anglePerShot etc...\r\n     *  -TODO: complete and test this code\r\n     ***************************/\r\n\r\n    /**\r\n     * Sprites() fires a projectile object\r\n     * <ul>\r\n     *     <li>Easy instantiator for bullets and propelled objects in GameStack</li>\r\n     *     <li>*TODO: This function is not-yet implemented in GameStack</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {options} *numerous args\r\n     **********/\r\n\r\n\r\n    shoot(options) {\r\n        //character shoots an animation\r\n\r\n        this.prep_key = 'shoot';\r\n\r\n        let animation = options.bullet || options.animation || new Animation();\r\n\r\n        let speed = options.speed || 1;\r\n\r\n        let position = options.position || new Vector3(0, 0, 0);\r\n\r\n        let size = options.size || new Vector3(10, 10, 0);\r\n\r\n        let rot_offset = options.rot_offset || new Vector3(0, 0, 0);\r\n\r\n        if (__gameInstance.isAtPlay) {\r\n\r\n            var bx = position.x, by = position.y, bw = size.x, bh = size.y;\r\n\r\n            var shot = __gameStack.add(new Sprite({\r\n\r\n                active: true,\r\n\r\n                position: position,\r\n\r\n                size: size,\r\n\r\n                image: animation.image,\r\n\r\n                rotation: new Vector3(0, 0, 0),\r\n\r\n                flipX: false\r\n\r\n            }));\r\n\r\n            shot.setAnimation(animation);\r\n\r\n            if (typeof(rot_offset) == 'number') {\r\n                rot_offset = new Vector3(rot_offset, 0, 0);\r\n            }\r\n\r\n            shot.position.x = bx, shot.position.y = by;\r\n            shot.rotation.x = 0 + rot_offset.x;\r\n\r\n            shot.stats = {\r\n                damage: 1\r\n\r\n            };\r\n\r\n            shot.speed.x = Math.cos((shot.rotation.x) * 3.14 / 180) * speed;\r\n\r\n            shot.speed.y = Math.sin((shot.rotation.x) * 3.14 / 180) * speed;\r\n\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Creates a subsprite\r\n     * <ul>\r\n     *     <li>Use this function to anchor one sprite to another.</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {options} object\r\n     * @params {options.animation} Animation()\r\n     * @params {options.position} Position()\r\n     * @params {options.offset} Position()\r\n     * @params {options.size} Size()\r\n     **********/\r\n\r\n    subsprite(options) {\r\n\r\n        let animation = options.animation || new Animation();\r\n\r\n        let position = options.position || this.position;\r\n\r\n        let offset = options.offset || new Vector3(0, 0, 0);\r\n\r\n        let size = options.size || this.size;\r\n\r\n        if (__gameInstance.isAtPlay) {\r\n\r\n            var subsprite = __gameStack.add(new Sprite({\r\n\r\n                active: true,\r\n\r\n                position: position,\r\n\r\n                size: size,\r\n\r\n                offset: offset,\r\n\r\n                image: animation.image,\r\n\r\n                rotation: new Vector3(0, 0, 0),\r\n\r\n                flipX: false\r\n\r\n            }));\r\n\r\n            subsprite.setAnimation(animation);\r\n\r\n            var __parent = this;\r\n\r\n            return subsprite;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Simple call to animate the sprite\r\n     * <ul>\r\n     *     <li>Calls animate on the Sprite.selected_animation</li>\r\n     *     <li>*TODO: This function is not-yet implemented in GameStack</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {animation}\r\n     **********/\r\n\r\n    animate(animation) {\r\n\r\n        if (__gameInstance.isAtPlay) {\r\n\r\n            if (animation) {\r\n                this.setAnimation(animation)\r\n            }\r\n\r\n            this.selected_animation.animate();\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Overwrites the complete() function of the selected animation\r\n     * <ul>\r\n     *     <li>Use this function when a change must be made, but not until the current animation is complete</li>\r\n     * </ul>\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {fun} function\r\n     **********/\r\n\r\n    onAnimationComplete(fun) {\r\n        this.selected_animation.onComplete(fun);\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  accelY\r\n     *  -accelerate on Y-Axis with 'accel' and 'max' (speed) arguments\r\n     *  -example-use: gravitation of sprite || up / down movement\r\n     ***************************/\r\n\r\n    /**\r\n     * This function accelerates the Sprite() on the y-axis\r\n\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {accel, max}\r\n     **********/\r\n\r\n    accelY(accel, max) {\r\n\r\n        accel = Math.abs(accel);\r\n\r\n        if (typeof(max) == 'number') {\r\n            max = {y: max};\r\n\r\n        }\r\n\r\n        this.assertSpeed();\r\n\r\n        let diff = max.y - this.speed.y;\r\n\r\n        if (diff > 0) {\r\n            this.speed.y += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n        if (diff < 0) {\r\n            this.speed.y -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  accelX\r\n     *  -accelerate on X-Axis with 'accel' and 'max' (speed) arguments\r\n     *  -example-use: running of sprite || left / right movement\r\n     ***************************/\r\n\r\n    /**\r\n     * This function accelerates the Sprite() on the y-axis\r\n\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {accel, max}\r\n     **********/\r\n\r\n    accelX(accel, max) {\r\n\r\n        accel = Math.abs(accel);\r\n\r\n        if (typeof(max) == 'number') {\r\n            max = {x: max};\r\n\r\n        }\r\n\r\n        this.assertSpeed();\r\n\r\n        let diff = max.x - this.speed.x;\r\n\r\n        if (diff > 0) {\r\n            this.speed.x += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n        if (diff < 0) {\r\n            this.speed.x -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  accel\r\n     *  -accelerate any acceleration -key\r\n     ***************************/\r\n\r\n    /**\r\n     * This function accelerates the Sprite() on any or all axis, depending on arguments\r\n\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {prop, key, accel, max}\r\n     **********/\r\n\r\n    accel(prop, key, accel, max) {\r\n\r\n        accel = Math.abs(accel);\r\n\r\n        if (typeof(max) == 'number') {\r\n            max = {x: max};\r\n\r\n        }\r\n\r\n        let speed = prop[key];\r\n\r\n        // this.assertSpeed();\r\n\r\n        let diff = max.x - prop[key];\r\n\r\n        if (diff > 0) {\r\n            prop[key] += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n        if (diff < 0) {\r\n            prop[key] -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  decel\r\n     *  -deceleration -key\r\n     ***************************/\r\n\r\n    /**\r\n     * This function decelerates the Sprite() on any or all axis, depending on arguments\r\n\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {prop, key, accel, max}\r\n     **********/\r\n\r\n\r\n    decel(prop, key, rate) {\r\n        if (typeof(rate) == 'object') {\r\n\r\n            rate = rate.rate;\r\n\r\n        }\r\n\r\n        rate = Math.abs(rate);\r\n\r\n        if (Math.abs(prop[key]) <= rate) {\r\n            prop[key] = 0;\r\n        }\r\n\r\n        else if (prop[key] > 0) {\r\n            prop[key] -= rate;\r\n\r\n        }\r\n        else if (prop[key] < 0) {\r\n            prop[key] += rate;\r\n\r\n        }\r\n        else {\r\n\r\n            prop[key] = 0;\r\n\r\n        }\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  decelX\r\n     *  -decelerate on the X axis\r\n     *  -args: 1 float:amt\r\n     ***************************/\r\n\r\n    deccelX(rate) {\r\n        if (typeof(rate) == 'object') {\r\n\r\n            rate = rate.rate;\r\n\r\n        }\r\n\r\n        rate = Math.abs(rate);\r\n\r\n        if (Math.abs(this.speed['x']) <= rate) {\r\n            this.speed['x'] = 0;\r\n\r\n        }\r\n\r\n        if (this.speed['x'] > 0) {\r\n            this.speed['x'] -= rate;\r\n\r\n        }\r\n        else if (this.speed['x'] < 0) {\r\n            this.speed['x'] += rate;\r\n\r\n        }\r\n        else {\r\n\r\n            this.speed['x'] = 0;\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  decelY\r\n     *  -decelerate on the Y axis\r\n     *  -args: 1 float:amt\r\n     ***************************/\r\n\r\n    decelY(amt) {\r\n\r\n        amt = Math.abs(amt);\r\n\r\n        if (Math.abs(this.speed.y) <= amt) {\r\n            this.speed.y = 0;\r\n\r\n        }\r\n        else if (this.speed.y > amt) {\r\n\r\n            this.speed.y -= amt;\r\n        }\r\n        else if (this.speed.y < amt * -1) {\r\n\r\n            this.speed.y += amt;\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  decelX\r\n     *  -decelerate on the X axis\r\n     *  -args: 1 float:amt\r\n     ***************************/\r\n\r\n    decelX(amt) {\r\n\r\n        amt = Math.abs(amt);\r\n\r\n\r\n        if (this.speed.x > amt) {\r\n\r\n            this.speed.x -= amt;\r\n        }\r\n        else if (this.speed.x < amt * -1) {\r\n\r\n            this.speed.x += amt;\r\n        }\r\n\r\n        if (Math.abs(this.speed.x) <= amt) {\r\n\r\n            this.speed.x = 0;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  collide_stop(item)\r\n     *  -both collide and stop on the object, when falling on Y axis::\r\n     *  -sets the special property: __falling to false on stop :: helps to control Sprite() state\r\n     *  -TODO : rename to fallstop || something that resembles a function strictly on Y-Axis\r\n     ***************************/\r\n\r\n    shortest_stop(item, callback) {\r\n        var diff_min_y = item.min ? item.min.y : Math.abs(item.position.y - this.position.y + this.size.y);\r\n\r\n        var diff_min_x = item.min ? item.min.x : Math.abs(item.position.x - this.position.x + this.size.x);\r\n\r\n        var diff_max_y = item.max ? item.max.y : Math.abs(item.position.y + item.size.y - this.position.y);\r\n\r\n        var diff_max_x = item.max ? item.max.x : Math.abs(item.position.x + item.size.x - this.position.y);\r\n\r\n        var dimens = {top: diff_min_y, left: diff_min_x, bottom: diff_max_y, right: diff_max_x};\r\n\r\n        var minkey = \"\", min = 10000000;\r\n\r\n        for (var x in dimens) {\r\n            if (dimens[x] < min) {\r\n                min = dimens[x];\r\n                minkey = x; // a key of top left bottom or right\r\n\r\n            }\r\n        }\r\n\r\n        callback(minkey);\r\n\r\n    }\r\n\r\n    center() {\r\n        return new Vector3(this.position.x + this.size.x / 2, this.position.y + this.size.y / 2);\r\n\r\n    }\r\n\r\n    /*************\r\n     * #BE CAREFUL\r\n     * -with this function :: change sensitive / tricky / 4 way collision\r\n     * *************/\r\n\r\n    overlap_x(item, padding) {\r\n        if (!padding) {\r\n            padding = 0;\r\n        }\r\n\r\n        var paddingX = padding * this.size.x,\r\n\r\n            paddingY = padding * this.size.y, left = this.position.x + paddingX,\r\n            right = this.position.x + this.size.x - paddingX,\r\n\r\n            top = this.position.y + paddingY, bottom = this.position.y + this.size.y - paddingY;\r\n\r\n        return right > item.position.x && left < item.position.x + item.size.x;\r\n\r\n\r\n    }\r\n\r\n    /*************\r\n     * #BE CAREFUL\r\n     * -with this function :: change sensitive / tricky / 4 way collision\r\n     * *************/\r\n\r\n    overlap_y(item, padding) {\r\n        if (!padding) {\r\n            padding = 0;\r\n        }\r\n\r\n        var paddingX = padding * this.size.x,\r\n\r\n            paddingY = padding * this.size.y, left = this.position.x + paddingX,\r\n            right = this.position.x + this.size.x - paddingX,\r\n\r\n            top = this.position.y + paddingY, bottom = this.position.y + this.size.y - paddingY;\r\n\r\n        return bottom > item.position.y && top < item.position.y + item.size.y;\r\n\r\n    }\r\n\r\n    /*************\r\n     * #BE CAREFUL\r\n     * -with this function :: change sensitive / tricky / 4 way collision\r\n     * *************/\r\n\r\n    collide_stop_x(item)\r\n    {\r\n\r\n        var apart = false;\r\n\r\n            var ct = 10000;\r\n\r\n            while (!apart && ct > 0) {\r\n\r\n                ct--;\r\n\r\n                var diffX = this.center().sub(item.center()).x;\r\n\r\n                var distX = Math.abs(this.size.x / 2 + item.size.x / 2);\r\n\r\n                if (Math.abs(diffX) < distX) {\r\n\r\n                    this.position.x -= diffX > 0 ? -1 : 1;\r\n\r\n\r\n\r\n                }\r\n                else\r\n                {\r\n\r\n                    apart = true;\r\n\r\n\r\n\r\n                }\r\n\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n    /*************\r\n     * #BE CAREFUL\r\n     * -with this function :: change sensitive / tricky / 4 way collision\r\n     * *************/\r\n\r\n    collide_stop(item) {\r\n\r\n        // collide top\r\n\r\n\r\n        this.__clippedX = false;\r\n\r\n        this.__clippedY = false;\r\n\r\n\r\n        if(this.id == item.id)\r\n        {\r\n            return false;\r\n\r\n        }\r\n\r\n        if(this.collidesRectangular(item)) {\r\n\r\n            var diff = this.center().sub(item.center());\r\n\r\n           if(this.overlap_x(item, 0.3) && Math.abs(diff.x) < Math.abs(diff.y))\r\n           {\r\n\r\n                   var apart = false;\r\n\r\n                   var ct = 10000;\r\n\r\n                   while (!apart && ct > 0) {\r\n\r\n                       ct--;\r\n\r\n                       var diffY = this.center().sub(item.center()).y;\r\n\r\n                       var distY = Math.abs(this.size.y / 2 + item.size.y / 2);\r\n\r\n                       if (Math.abs(diffY) < distY) {\r\n\r\n                           this.position.y -= diffY > 0 ? -1 : 1;\r\n\r\n\r\n\r\n                       }\r\n\r\n                     else {\r\n\r\n                           if (diffY < 0){\r\n                               this.__inAir = false;\r\n                           };\r\n\r\n                           if(diffY > 0){ this.__clippedY = true; } //clippedY / 'top_stop'\r\n\r\n                           apart = true;\r\n\r\n\r\n                       }\r\n\r\n\r\n               }\r\n\r\n\r\n\r\n           }\r\n          if(this.overlap_y(item, 0.3)) {\r\n\r\n               this.collide_stop_x(item);\r\n\r\n           }\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    restoreFrom(data) {\r\n        data.image = new GameImage(data.src || data.image.src);\r\n\r\n        return new Sprite(data);\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  fromFile(file_path)\r\n     *  -TODO : complete this function based on code to load Sprite() from file, located in the spritemaker.html file\r\n     *  -TODO: test this function\r\n     ***************************/\r\n\r\n\r\n    /**\r\n     * This function restores a Sprite() from json file\r\n\r\n     * @function\r\n     * @memberof Sprite\r\n     * @params {file_path}\r\n     **********/\r\n\r\n\r\n    fromFile(file_path) {\r\n\r\n        if (typeof file_path == 'string') {\r\n\r\n            var __inst = this;\r\n\r\n            $.getJSON(file_path, function (data) {\r\n\r\n                __inst = new Sprite(data);\r\n\r\n            });\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n}\r\n;\r\n\r\n/****************\r\n * TODO : Complete SpritePresetsOptions::\r\n *  Use these as options for Sprite Control, etc...\r\n ****************/\r\n\r\n\r\nlet SpriteInitializersOptions = {\r\n\r\n    ControllerStickMotion: {\r\n\r\n        __args: {},\r\n\r\n        player_move_x: function (sprite) {\r\n\r\n            alert('applying initializer');\r\n\r\n            console.log('side_scroll_player_run:init-ing');\r\n\r\n            let __lib = Quazar || Quick2d;\r\n\r\n            Quazar.GamepadAdapter.on('stick_left', 0, function (x, y) {\r\n\r\n                console.log('stick-x:' + x);\r\n\r\n                if (Math.abs(x) < 0.2) {\r\n                    return 0;\r\n                }\r\n\r\n                var accel = 0.2; //todo : options for accel\r\n                var max = 7;\r\n\r\n                sprite.accelX(accel, x * max);\r\n\r\n                if (x < -0.2) {\r\n                    sprite.flipX = true;\r\n\r\n                }\r\n                else if (x > 0.2) {\r\n                    sprite.flipX = false;\r\n\r\n                }\r\n\r\n            });\r\n\r\n            sprite.onUpdate(function (spr) {\r\n\r\n                spr.decelX(0.1);\r\n\r\n                if (!spr.__falling) {\r\n                    spr.decelY(0.2)\r\n                }\r\n                ;\r\n\r\n            });\r\n\r\n\r\n        },\r\n\r\n        player_move_xy: function (sprite) {\r\n\r\n            alert('applying initializer');\r\n\r\n            console.log('side_scroll_player_run:init-ing');\r\n\r\n            let __lib = Quazar || Quick2d;\r\n\r\n            Quazar.GamepadAdapter.on('stick_left', 0, function (x, y) {\r\n\r\n                console.log('stick-x:' + x);\r\n\r\n                if (Math.abs(x) < 0.2) {\r\n                    x = 0;\r\n                }\r\n\r\n                if (Math.abs(y) < 0.2) {\r\n                    y = 0;\r\n                }\r\n\r\n                var accel = 0.2; //todo : options for accel\r\n                var max = 7;\r\n\r\n                sprite.accelX(accel, x * max);\r\n\r\n                sprite.accelY(accel, y * max);\r\n\r\n                if (x < -0.2) {\r\n                    sprite.flipX = true;\r\n\r\n                }\r\n                else if (x > 0.2) {\r\n                    sprite.flipX = false;\r\n\r\n                }\r\n\r\n            });\r\n\r\n            sprite.onUpdate(function (spr) {\r\n\r\n                sprite.decel(sprite.speed, 'x', 0.1);\r\n\r\n                sprite.decel(sprite.speed, 'y', 0.1);\r\n\r\n            });\r\n\r\n\r\n        },\r\n\r\n        player_rotate_x: function (sprite) {\r\n\r\n            alert('applying initializer');\r\n\r\n\r\n            let __lib = Quazar || Quick2d;\r\n\r\n            Quazar.GamepadAdapter.on('stick_left', 0, function (x, y) {\r\n\r\n                console.log('stick-x:' + x);\r\n\r\n                if (Math.abs(x) < 0.2) {\r\n                    return 0;\r\n                }\r\n\r\n                var accel = 0.25; //todo : options for accel\r\n                var max = 7;\r\n\r\n                sprite.accel(sprite.rot_speed, 'x', accel, x * max);\r\n\r\n                if (x < -0.2) {\r\n                    sprite.flipX = true;\r\n\r\n                }\r\n                else if (x > 0.2) {\r\n                    sprite.flipX = false;\r\n\r\n                }\r\n\r\n            });\r\n\r\n            sprite.onUpdate(function (spr) {\r\n\r\n                sprite.decel(sprite.rot_speed, 'x', 0.1);\r\n\r\n                if (!spr.__falling) {\r\n                    spr.decelY(0.2)\r\n                }\r\n                ;\r\n\r\n            });\r\n\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n};\r\n\r\nQuazar.options = Quazar.options || {};\r\n\r\nQuazar.options.SpriteInitializers = SpriteInitializersOptions;;\r\n\r\n/**\r\n * Vector3({x:number,y:number,z:number,r:number})\r\n *\r\n * required arguments: x, y\r\n * optional arguments: z, r\r\n *\r\n * [See Live Demo with Usage-Example]{@link http://www.google.com}\r\n * @returns {Vector3} object of Vector3()\r\n *\r\n * Vector objects are treated alike in GameStack.js, with Vector() and Vector2() equivalent to Vector3()\r\n * Other class names synonymous with Vector() are Pos(), Size(), Position(), Rotation()\r\n * */\r\n\r\nclass Vector3 {\r\n    constructor(x, y, z, r) {\r\n\r\n        if(typeof(x) == 'object' && x.x && x.y) //optionally pass vector3\r\n        {\r\n            this.x = x.x;\r\n            this.y = x.y;\r\n            this.z = x.z || 0;\r\n\r\n            return this;\r\n        }\r\n\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n        this.r = r;\r\n\r\n    }\r\n\r\n\r\n    sub(v)\r\n    {\r\n        if(typeof(v) == 'number')\r\n        {\r\n            v = {x:v, y:v, z:v};\r\n        };\r\n\r\n        return new Vector3(this.x - v.x, this.y - v.y, this.z - v.z);\r\n\r\n    }\r\n\r\n    add(v)\r\n    {\r\n        if(typeof(v) == 'number')\r\n        {\r\n            v = {x:v, y:v, z:v};\r\n        };\r\n\r\n        return new Vector3(this.x + v.x, this.y + v.y, this.z + v.z);\r\n\r\n    }\r\n\r\n    mult(v)\r\n    {\r\n        if(typeof(v) == 'number')\r\n        {\r\n            v = {x:v, y:v, z:v};\r\n        };\r\n\r\n        return new Vector3(this.x * v.x, this.y * v.y, this.z * v.z);\r\n\r\n    }\r\n    div(v)\r\n    {\r\n        if(typeof(v) == 'number')\r\n        {\r\n            v = {x:v, y:v, z:v};\r\n        };\r\n\r\n        return new Vector3(this.x / v.x, this.y / v.y, this.z / v.z);\r\n    }\r\n\r\n    round()\r\n    {\r\n        return new Vector3(Math.round(this.x), Math.round(this.y), Math.round(this.z));\r\n\r\n    }\r\n    floor()\r\n    {\r\n        return new Vector3(Math.floor(this.x), Math.floor(this.y), Math.floor(this.z));\r\n\r\n    }\r\n    ceil()\r\n    {\r\n        return new Vector3(Math.ceil(this.x), Math.ceil(this.y), Math.ceil(this.z));\r\n\r\n    }\r\n\r\n    diff()\r\n    {\r\n        //TODO:this function\r\n\r\n\r\n    }\r\n\r\n    abs_diff()\r\n    {\r\n        //TODO:this function\r\n\r\n    }\r\n\r\n    is_between(v1, v2)\r\n    {\r\n       //TODO : overlap vectors return boolean\r\n\r\n    }\r\n\r\n}\r\n;\r\n\r\nlet Pos = Vector3, Size = Vector3, Position = Vector3, Vector2 = Vector3, Vector = Vector3, Rotation = Vector3;\r\n\r\n//The above are a list of synonymous expressions for Vector3. All of these do the same thing in this library (store x,y,z values)\r\n;/**\r\n * Created by The Blakes on 04-13-2017\r\n *\r\n */\r\n\r\n\r\nclass InterfaceCallback\r\n{\r\n    constructor({name, description, callback})\r\n    {\r\n\r\n       this.name = name;\r\n\r\n       this.description = description;\r\n\r\n       this.callback = callback || function(){ console.info('The call was empty'); };\r\n\r\n    }\r\n\r\n    run()\r\n    {\r\n\r\n        this.callback();\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nclass SpeechInterfaceStructure\r\n{\r\n    constructor({name, description})\r\n    {\r\n        this.name = name || \"Program helper.\";\r\n\r\n        this.description = description || \"An interface for the game-builder program.\";\r\n\r\n        this.options_structure = {\r\n\r\n        scroll:function(x, y){}, //simple scroll controller\r\n\r\n\r\n\r\n        create_object_resource:{\r\n\r\n            constructors:Quazar.IF.__allConstructors(),\r\n\r\n            selectedType:false,\r\n\r\n            selectByName:Quazar.IF.selectByName,\r\n\r\n            apply_speech_value:Quazar.IF.applySpeechValue()\r\n\r\n        }, //apply each class in the program, with means of creating / instantiating\r\n\r\n        save_object_resource:{\r\n\r\n            selected_object:false,\r\n\r\n            confirm:Quazar.IF.confirmation()\r\n\r\n        }, //apply each class in the program, with means of saving\r\n\r\n        retrieve_object_resource:{}, //retrieve\r\n\r\n        browse_object_resources:{}, //browsing\r\n\r\n        search_object_resources:{}, //searching\r\n\r\n        delete_object_resources:{}, //delete\r\n\r\n        apply_value:{} //apply a value to an object resource\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]}