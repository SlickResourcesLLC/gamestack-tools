{"version":3,"sources":["../../../ecma/GameStack/concat/GameStack.js"],"names":["Sound","src","x","sound","Audio","onLoad","play","GameImage","onCreate","Object","image","document","createElement","ext","substring","lastIndexOf","length","error","onerror","__error","domElement","onload","GameStackLibrary","lib","DEBUG","gui_mode","__gameWindow","__sprites","__animations","samples","log_modes","log_mode","recursionCount","__gameWindowList","create_id","d","Date","getTime","performance","now","replace","c","r","Math","random","floor","toString","getActionablesCheckList","__inst","actionables","$","each","sprites","ix","item","concat","sounds","motionstacks","animations","interlog","message","div","isNaN","quit","Error","console","info","m","GameStack","log","animate","TWEEN","update","time","requestAnimationFrame","ctx","clearRect","canvas","width","height","draw","start","Collision","spriteRectanglesCollide","obj1","obj2","position","size","y","_gameWindow","setGameWindow","gameWindow","getGameWindow","assignAll","object","args","keys","__gameStack","list","onResult","onComplete","i","ready_callstack","ready","callback","push","callReady","funx","call","__gameInstance","isAtPlay","InputEvents","init","getArg","key","fallback","hasOwnProperty","Quick2d","Quazar","QUAZAR","$Q","selector","before","c1","str","test_str","start_pos","end_pos","indexOf","contains","contains_all","cList","contains_any","after","between","c2","mainSelector","trim","msfChar","__targetClassName","toLowerCase","criterion","cparts","split","getEventProfileFromKey","evt_key","isControl","isCollision","isPropertyLimit","isProperty","__","on","profile","mousemove","leftclick","rightclick","middleclick","wheelup","wheelDown","space","tab","shift","enter","extend","onFinish","cleanKey","down","up","getMousePos","e","pageX","pageY","clientX","body","scrollLeft","documentElement","clientY","scrollTop","offsetLeft","style","top","fullMoveInputEvents","event","pos","Array","el","onkeydown","value","String","fromCharCode","keyCode","onkeyup","onmousedown","which","preventDefault","onmouseup","addEventListener","window","_preGameStack_windowLoad","Canvas","sprite","active","onScreen","Game","WIDTH","HEIGHT","drawPortion","drawFrameWithRotation","img","fx","fy","fw","fh","deg","canvasContextObj","flip","save","round","rad","PI","translate","rotate","scale","drawImage","restore","frame","selected_animation","selected_frame","camera","z","targetSize","realWidth","realHeight","offset","rotation","framePos","frameSize","flipX","GameWindow","backgrounds","interactives","forces","getContext","__camera","Vector3","onUpdate","listout","id","name","player","def_update","arg","_gw","TextDisplay","ItemDisplay","font","fontSize","text","color","BarDisplay","VideoDisplay","undefined","Animation","_anime","description","frames","type","delay","cix","frameBounds","VectorFrameBounds","frameOffset","apply2DFrames","parent","priority","earlyTerm","hang","duration","effects","timer","__gameLogic","setType","__frametype","fcount","quitLoop","min","max","termPoint","resetFrames","engage","complete","tween","Tween","easing","curve","Easing","Linear","None","to","isComplete","fun","Camera","accel","distSize","Controls","__controller","controller","extension","formerCall","extendedCall","Extras","items","fire","run","process","Force","subjects","origin","massObjects","minSpeed","itemx","accelY","__falling","iy","itemy","collide_stop","FrameEffectsApi","__effects","effect","StatEffect","__is","collideables","extras","GameLogic","gameEffectList","gameEffects","gameeffect","GamepadAdapter","__gamepads","intervals","controller_stack","_gpinst","events","setInterval","gps","navigator","getGamepads","clearInterval","game_pad_index","game_pad","gp","stick_left","stick_right","buttons","extendFunc","f1","f2","fc","current_cb","parts","number","parseInt","gpEvents","process_buttons","process_axes","axes","axis1","axia2","ceil","pressed","clearance_1","gpc","bkey","gamepads","gpix","GamepadEvents","GravityAction","Graviton","GravitationalRay","Motion","distance","curvesList","curvesObject","parent_id","object_id","Quadratic","InOut","targetRotation","curveString","getCurveString","setCurve","line","easeType","cps","s1","s2","tweens","objects","target","targetR","Elastic","__tweenObject","setTimeout","t","f","context","fillStyle","fillRect","lineWidth","strokeStyle","beginPath","moveTo","lineTo","closePath","stroke","position_old","Rectangle","VectorBounds","Circle","radius","getArgs","Sprite","__initializers","_spr","motions","collision_bounds","speed","acceleration","rot_speed","rot_accel","onInit","options","SpriteInitializers","alert","initializer","framesize","__mapSize","anime","w","h","keyString1","keyString2","obj","extendedFunc","ef","prep_key","spread","angleSpread","total","totalBullets","numberBullets","animation","bullet","screenDuration","event_arg","setAnimation","abs","assertSpeed","diff","prop","rate","amt","max_y","file_path","getJSON","data","SpriteInitializersOptions","ControllerStickMotion","__args","player_move_x","__lib","accelX","spr","decelX","decelY","player_move_xy","decel","player_rotate_x","__relativeTo","v","v1","v2","Pos","Size","Position","Vector2","Vector","Rotation","InterfaceCallback","SpeechInterfaceStructure","options_structure","scroll","create_object_resource","constructors","IF","__allConstructors","selectedType","selectByName","apply_speech_value","applySpeechValue","save_object_resource","selected_object","confirm","confirmation","retrieve_object_resource","browse_object_resources","search_object_resources","delete_object_resources","apply_value"],"mappings":";;;;;;;;;;;;AAAA;;;;AAMA;;;;;AAMA;;;;;;;;;IASMA,K;AAEF,uBAAYC,GAAZ,EAAiB;AAAA;;AAEb,oBAAI,QAAOA,GAAP,yCAAOA,GAAP,MAAe,QAAnB,EAA6B;;AAEzB,6BAAK,IAAIC,CAAT,IAAcD,GAAd,EAAmB;AACf,qCAAKC,CAAL,IAAUD,IAAIC,CAAJ,CAAV;AAEH;;AAED,6BAAKC,KAAL,GAAa,IAAIC,KAAJ,CAAUH,IAAIA,GAAd,CAAb;;AAEA,6BAAKI,MAAL,GAAcJ,IAAII,MAAJ,IAAc,YAAY,CACnC,CADL;AAGH,iBAZD,MAcK,IAAI,OAAOJ,GAAP,IAAe,QAAnB,EAA6B;;AAE9B,6BAAKA,GAAL,GAAWA,GAAX;;AAEA,6BAAKE,KAAL,GAAa,IAAIC,KAAJ,CAAU,KAAKH,GAAf,CAAb;AAEH;;AAED,qBAAKI,MAAL,GAAc,KAAKA,MAAL,IAAe,YAAY,CACpC,CADL;;AAGA,oBAAI,OAAO,KAAKA,MAAZ,IAAuB,UAA3B,EAAuC;;AAEnC,6BAAKA,MAAL,CAAY,KAAKF,KAAjB;AAEH;AAEJ;;;;uCAEM;AACH,4BAAI,QAAO,KAAKA,KAAZ,KAAsB,QAAtB,IAAkC,OAAO,KAAKA,KAAL,CAAWG,IAAlB,IAA2B,UAAjE,EAA6E;;AAEzE,qCAAKH,KAAL,CAAWG,IAAX;AAEH;AAGJ;;;;;;AAKL;;;;;;;IAOMC,S;AAEF,2BAAYN,GAAZ,EAAiBO,QAAjB,EAA2B;AAAA;;AAEvB;;AAEA,oBAAIP,eAAeQ,MAAnB,EAA2B;;AAEvB;;AAEA,6BAAKC,KAAL,GAAaC,SAASC,aAAT,CAAuB,KAAvB,CAAb;;AAEA,6BAAKF,KAAL,CAAWT,GAAX,GAAiBA,IAAIA,GAArB;;AAEA,6BAAKA,GAAL,GAAWA,IAAIA,GAAf;AAEH,iBAVD,MAYK,IAAI,OAAOA,GAAP,IAAe,QAAnB,EAA6B;;AAE9B,4BAAIY,MAAMZ,IAAIa,SAAJ,CAAcb,IAAIc,WAAJ,CAAgB,GAAhB,CAAd,EAAoCd,IAAIe,MAAxC,CAAV;;AAEA,6BAAKN,KAAL,GAAaC,SAASC,aAAT,CAAuB,KAAvB,CAAb;;AAEA,6BAAKF,KAAL,CAAWT,GAAX,GAAiBA,GAAjB;;AAEA,6BAAKA,GAAL,GAAW,KAAKS,KAAL,CAAWT,GAAtB;AAGH;;AAGD,oBAAI,CAAC,KAAKS,KAAV,EAAiB;AACb,6BAAKA,KAAL,GAAa,EAACO,OAAO,kDAAR,EAAb;AAEH,iBAHD,MAIK;AACD,6BAAKP,KAAL,CAAWQ,OAAX,GAAqB,YAAY;AAC7B,qCAAKC,OAAL,GAAe,IAAf;AACH,yBAFD;AAIH;;AAED,qBAAKC,UAAL,GAAkB,KAAKV,KAAvB;;AAEA,qBAAKA,KAAL,CAAWW,MAAX,GAAoB,YAAY;;AAE5B,4BAAI,OAAO,KAAKb,QAAZ,IAAyB,UAA7B,EAAyC;;AAErC,qCAAKA,QAAL,CAAc,KAAKE,KAAnB;AAEH;AAGJ,iBATD;AAWH;;;;2CAEU;AACP,+BAAO,KAAKA,KAAZ;AACH;;;;;;AAGD,IAAIY,mBAAmB,SAAnBA,gBAAmB,GAAY;;AAGnC,YAAIC,MAAM;;AAENC,uBAAO,KAFD;;AAINC,0BAAU,IAJJ;;AAMNC,8BAAc,EANR;;AASNC,2BAAW,EATL;;AAWNC,8BAAc,EAXR;;AAaNC,yBAAS,EAbH;;AAgBNC,2BAAW,CAAC,MAAD,EAAS,MAAT,EAAiB,SAAjB,CAhBL;;AAkBNC,0BAAU,KAlBJ;;AAoBNC,gCAAgB,CApBV;;AAsBNC,kCAAkB,EAtBZ;;AAyBNC,2BAAW,qBAAY;;AAEnB,4BAAIC,IAAI,IAAIC,IAAJ,GAAWC,OAAX,EAAR;AACA,4BAAI,OAAOC,WAAP,KAAuB,WAAvB,IAAsC,OAAOA,YAAYC,GAAnB,KAA2B,UAArE,EAAgF;AAC5EJ,qCAAKG,YAAYC,GAAZ,EAAL,CAD4E,CACpD;AAC3B;AACD,+BAAO,uCAAuCC,OAAvC,CAA+C,OAA/C,EAAwD,UAAUC,CAAV,EAAa;AACxE,oCAAIC,IAAI,CAACP,IAAIQ,KAAKC,MAAL,KAAgB,EAArB,IAA2B,EAA3B,GAAgC,CAAxC;AACAT,oCAAIQ,KAAKE,KAAL,CAAWV,IAAI,EAAf,CAAJ;AACA,uCAAO,CAACM,MAAM,GAAN,GAAYC,CAAZ,GAAiBA,IAAI,GAAJ,GAAU,GAA5B,EAAkCI,QAAlC,CAA2C,EAA3C,CAAP;AACH,yBAJM,CAAP;AAMH,iBArCK;;AAyCNC,yCAAyB,mCAAY;AACjC;;AAEA,4BAAIC,SAAS,EAAb;;AAEA,4BAAIC,cAAc,EAAlB;;AAEAC,0BAAEC,IAAF,CAAO,KAAKC,OAAZ,EAAqB,UAAUC,EAAV,EAAcC,IAAd,EAAoB;;AAErCL,4CAAYM,MAAZ,CAAmBD,KAAKE,MAAxB;;AAEAP,4CAAYM,MAAZ,CAAmBD,KAAKG,YAAxB;;AAEAR,4CAAYM,MAAZ,CAAmBD,KAAKI,UAAxB;AAGH,yBATD;AAYH,iBA5DK;;AA+DNC,0BAAU,kBAAUC,OAAV,EAAmBC,GAAnB,EAAwB;AAClC;AACI,6BAAK7B,cAAL;;AAEA,4BAAI,CAAC8B,MAAMD,GAAN,CAAD,IAAe,KAAK7B,cAAL,GAAsB6B,GAAtB,IAA6B,CAAhD,EAAmD;AAC/C;;AAEH;AAEJ,iBAxEK;;AA2EN5C,uBAAO,eAAU8C,IAAV,EAAgBH,OAAhB,EAAyB;;AAE5B,4BAAIG,IAAJ,EAAU;AACN,sCAAM,IAAIC,KAAJ,CAAUJ,OAAV,CAAN;AAEH,yBAHD,MAIK;AACDK,wCAAQhD,KAAR,CAAc,OAAO2C,OAArB;AAEH;AAEJ,iBAtFK;;AAyFNM,sBAAM,cAAUC,CAAV,EAAa;;AAEf,4BAAIC,UAAU5C,KAAd,EAAqB;;AAEjByC,wCAAQC,IAAR,CAAa,UAAUC,CAAvB;AAEH;AACJ,iBAhGK;;AAoGNE,qBAAK,aAAUF,CAAV,EAAa;;AAEd,4BAAIC,UAAU5C,KAAd,EAAqB;;AAEjByC,wCAAQI,GAAR,CAAY,eAAeF,CAA3B;AAEH;AACJ,iBA3GK;;AA8GN;;AAEAG,yBAAS,mBAAY;AACjBC,8BAAMC,MAAN,CAAaC,IAAb;;AAEAC,8CAAsB,KAAKJ,OAA3B;;AAEA,6BAAK5C,YAAL,CAAkB8C,MAAlB;;AAEA,6BAAK9C,YAAL,CAAkBiD,GAAlB,CAAsBC,SAAtB,CAAgC,CAAhC,EAAmC,CAAnC,EAAsC,KAAKlD,YAAL,CAAkBmD,MAAlB,CAAyBC,KAA/D,EAAsE,KAAKpD,YAAL,CAAkBmD,MAAlB,CAAyBE,MAA/F;;AAEA,6BAAKrD,YAAL,CAAkBsD,IAAlB;AAEH,iBA3HK;;AA8HNC,uBAAO,iBAAY;;AAEf,6BAAKX,OAAL;AAEH,iBAlIK;;AAsINY,2BAAW;AAEPC,+CAFO,mCAEiBC,IAFjB,EAEuBC,IAFvB,EAGP;AACI,oCAAID,KAAKE,QAAL,CAAcpF,CAAd,GAAkBkF,KAAKG,IAAL,CAAUrF,CAA5B,GAAgCmF,KAAKE,IAAL,CAAUrF,CAA1C,IAA+CkF,KAAKE,QAAL,CAAcpF,CAAd,GAAkBmF,KAAKE,IAAL,CAAUrF,CAAV,GAAcmF,KAAKE,IAAL,CAAUrF,CAAzF,IACAkF,KAAKE,QAAL,CAAcE,CAAd,GAAkBJ,KAAKG,IAAL,CAAUC,CAA5B,GAAgCH,KAAKE,IAAL,CAAUC,CAD1C,IAC+CJ,KAAKE,QAAL,CAAcE,CAAd,GAAkBH,KAAKE,IAAL,CAAUC,CAAV,GAAcH,KAAKE,IAAL,CAAUC,CAD7F,EACgG;;AAE5F,+CAAO,IAAP;AAEH;AAEJ;AAXM,iBAtIL;;AAqJNjB,uBAAOA,KArJD;;AAuJNkB,6BAAa,EAvJP;;AA0JNC,+BAAe,uBAAUC,UAAV,EAAsB;;AAEjC,6BAAKF,WAAL,GAAmBE,UAAnB;AAEH,iBA9JK;;AAiKNC,+BAAe,yBAAY;;AAGvB,+BAAO,KAAKH,WAAZ;AAEH,iBAtKK;;AAyKNI,2BAAW,mBAAUC,MAAV,EAAkBC,IAAlB,EAAwBC,IAAxB,EAA8B;;AAErCC,oCAAY9C,IAAZ,CAAiB6C,IAAjB,EAAuB,UAAU3C,EAAV,EAAcC,IAAd,EAAoB;;AAEvCwC,uCAAOzC,EAAP,IAAa0C,KAAK1C,EAAL,CAAb;AAEH,yBAJD;AAOH,iBAlLK;;AAsLNF,sBAAM,cAAU+C,IAAV,EAAgBC,QAAhB,EAA0BC,UAA1B,EAAsC;AACxC,6BAAK,IAAIC,CAAT,IAAcH,IAAd,EAAoB;AAChBC,yCAASE,CAAT,EAAYH,KAAKG,CAAL,CAAZ;AACH;;AAED,4BAAI,OAAOD,UAAP,KAAuB,UAA3B,EAAuC;AACnCA,2CAAW,KAAX,EAAkBF,IAAlB;AACH;AACD;AAEH,iBAhMK;;AAmMNI,iCAAiB,EAnMX;;AAqMNC,uBAAO,eAAUC,QAAV,EAAoB;;AAEvB,6BAAKF,eAAL,CAAqBG,IAArB,CAA0BD,QAA1B;AAEH,iBAzMK;;AA6MNE,2BAAW,qBAAY;;AAEnB,4BAAIC,OAAO,KAAKL,eAAhB;;AAEA,4BAAIX,aAAa,KAAKF,WAAtB;AAAA,4BAAmClE,MAAM,IAAzC;AAAA,4BAA+C6B,UAAU,KAAK1B,YAAL,CAAkB0B,OAA3E;;AAEA;;AAEA,6BAAKD,IAAL,CAAUwD,IAAV,EAAgB,UAAUtD,EAAV,EAAcuD,IAAd,EAAoB;;AAEhCA,qCAAKrF,GAAL,EAAUoE,UAAV,EAAsBvC,OAAtB;AAEH,yBAJD;;AAOAyD,uCAAeC,QAAf,GAA0B,IAA1B;;AAGA,6BAAKC,WAAL,CAAiBC,IAAjB;AAEH,iBAjOK;;AAoONC,wBAAQ,gBAAUlB,IAAV,EAAgBmB,GAAhB,EAAqBC,QAArB,EAA+B;AACnC,4BAAIpB,QAAQA,KAAKqB,cAAL,CAAoBF,GAApB,CAAZ,EAAsC;AAClC,uCAAOnB,KAAKmB,GAAL,CAAP;AACH,yBAFD,MAGK;AACD,uCAAOC,QAAP;AAEH;AAEJ;;AA7OK,SAAV;;AAoPA,eAAO5F,GAAP;AAEH,CAzPG;;AA2PJ;AACA;;AAEA,IAAI6C,YAAY,IAAI9C,gBAAJ,EAAhB;AACA,IAAI2E,cAAc7B,SAAlB;;AAEA,IAAIiD,UAAUjD,SAAd,C,CAAyB;;AAEzB,IAAIkD,SAASlD,SAAb,C,CAAwB;;AAExB,IAAImD,SAASnD,SAAb,C,CAAwB;;AAExB,IAAIyC,iBAAiBzC,SAArB;;AAEA;;;;;;;AAQA;;;;;AAKA,SAASoD,EAAT,OACA;AAAA,YADaC,QACb,QADaA,QACb;;AACI,aAAKA,QAAL,GAAgBA,QAAhB;;AAEA,aAAKC,MAAL,GAAc,UAASC,EAAT,EAAaC,GAAb,EACd;AACI,oBAAIC,WAAWD,OAAO,KAAKH,QAA3B;AACA,oBAAIK,YAAY,CAAhB;AACA,oBAAIC,UAAUF,SAASG,OAAT,CAAiBL,EAAjB,EAAoBG,SAApB,CAAd;AACD,uBAAOD,SAAS/G,SAAT,CAAmBgH,SAAnB,EAA6BC,OAA7B,CAAP;AACF,SAND;;AASA,aAAKE,QAAL,GAAgB,UAASN,EAAT,EAAaC,GAAb,EAChB;AACI,oBAAIC,WAAWD,OAAO,KAAKH,QAA3B;;AAEA,uBAAOI,SAASG,OAAT,CAAiBL,EAAjB,KAAwB,CAA/B;AACH,SALD;;AAOA,aAAKO,YAAL,GAAoB,UAASC,KAAT,EAAgBP,GAAhB,EACpB;AACI,oBAAIC,WAAWD,OAAO,KAAKH,QAA3B;;AAEA,qBAAI,IAAIvH,IAAI,CAAZ,EAAeA,IAAIiI,MAAMnH,MAAzB,EAAiCd,GAAjC,EACA;AACI,4BAAG2H,SAASG,OAAT,CAAiBG,MAAMjI,CAAN,CAAjB,IAA6B,CAAhC,EACA;AACI,uCAAO,KAAP;AAEH;AAEJ;;AAED,uBAAO,IAAP;AAEH,SAhBD;;AAmBA,aAAKkI,YAAL,GAAoB,UAASD,KAAT,EAAgBP,GAAhB,EACpB;AACI,oBAAIC,WAAWD,OAAO,KAAKH,QAA3B;;AAEA,qBAAI,IAAIvH,IAAI,CAAZ,EAAeA,IAAIiI,MAAMnH,MAAzB,EAAiCd,GAAjC,EACA;AACI,4BAAG2H,SAASG,OAAT,CAAiBG,MAAMjI,CAAN,CAAjB,KAA8B,CAAjC,EACA;AACI,uCAAO,IAAP;AAEH;AAEJ;;AAED,uBAAO,KAAP;AAEH,SAhBD;;AAkBA,aAAKmI,KAAL,GAAa,UAASV,EAAT,EAAaC,GAAb,EACb;AACI,oBAAIC,WAAWD,OAAO,KAAKH,QAA3B;AACA,oBAAIK,YAAY,CAAhB;AACA,oBAAIC,UAAUF,SAAS7G,MAAvB;AACA,uBAAO6G,SAAS/G,SAAT,CAAmBgH,SAAnB,EAA6BC,OAA7B,CAAP;AACH,SAND;;AAQA,aAAKO,OAAL,GAAe,UAASX,EAAT,EAAaY,EAAb,EAAiBX,GAAjB,EACf;AACI,oBAAIC,WAAWD,OAAO,KAAKH,QAA3B;AACA,oBAAIK,YAAYD,SAASG,OAAT,CAAiBL,EAAjB,IAAuB,CAAvC;AACA,oBAAII,UAAUF,SAASG,OAAT,CAAiBO,EAAjB,EAAoBT,SAApB,CAAd;AACA,uBAAOD,SAAS/G,SAAT,CAAmBgH,SAAnB,EAA6BC,OAA7B,CAAP;AACH,SAND;;AAQA,YAAIS,eAAe,KAAKd,MAAL,CAAY,GAAZ,EAAiBe,IAAjB,EAAnB;AAAA,YAA4CC,UAAUF,aAAa1H,SAAb,CAAuB,CAAvB,EAA0B,CAA1B,CAAtD;;AAGA,YAAI6H,oBAAoB,GAAxB;;AAEA,gBAAOD,QAAQE,WAAR,EAAP;AAEI,qBAAK,GAAL;;AAEI3E,gCAAQC,IAAR,CAAa,oBAAb;;AAEAyE,4CAAqB,KAAKN,KAAL,CAAW,GAAX,EAAgBG,YAAhB,CAArB;;AAEA;;AARR;;AAaA,YAAIK,YAAY,KAAKP,OAAL,CAAa,GAAb,EAAkB,GAAlB,CAAhB;AAAA,YAAwCQ,SAASD,UAAUE,KAAV,CAAgB,GAAhB,CAAjD;;AAEA,gBAAOD,OAAO,CAAP,EAAUF,WAAV,EAAP;AAEI,qBAAK,MAAL;;AAEI;;AAEA;;AAEJ,qBAAM,MAAN;;AAEI;;AAEA;;AAZR,SAcC;;AAED,aAAKI,sBAAL,GAA8B,UAASC,OAAT,EAC9B;;AAEI,oBAAIC,YAAYD,QAAQjB,OAAR,CAAgB,OAAhB,KAA4B,CAA5B,IAAiCiB,QAAQjB,OAAR,CAAgB,QAAhB,KAA6B,CAA9E;;AAEA,oBAAImB,cAAcF,QAAQjB,OAAR,CAAgB,SAAhB,KAA8B,CAAhD;AAAA,oBAEAoB,kBAAkB,KAAKhB,YAAL,CAAkB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAAlB,EAAmCa,OAAnC,CAFlB;;AAIA,uBAAM;;AAEFC,mCAAUA,SAFR;;AAIFC,qCAAYA,WAJV;;AAMFE,oCAAWA;;AANT,iBAAN;AASH,SAlBD;;AAoBA,YAAIC,EAAJ;;AAEA,eAAM;;AAEFC,oBAAG,YAASN,OAAT,EAAkBzC,QAAlB,EAA4B;AAC/B;;AAEI;;AAEA,4BAAIgD,UAAU,KAAKR,sBAAL,CAA4BC,OAA5B,CAAd;;AAEA,4BAAGO,QAAQN,SAAX,EACA;AACIjF,wCAAQC,IAAR,CAAa,yBAAb;AAEH;;AAED,4BAAGsF,QAAQL,WAAX,EACA;AACIlF,wCAAQC,IAAR,CAAa,2BAAb;AAEH;;AAED,4BAAGsF,QAAQH,UAAX,EACA;AACIpF,wCAAQC,IAAR,CAAa,0BAAb;AAEH;AAEJ;;AA3BC,SAAN;AA8BH;;AAGD;;;;;AAKAE,UAAU2C,WAAV,GAAwB,EAAE;AACtB0C,mBAAW,EADS;AAEpBC,mBAAW,EAFS;AAGpBC,oBAAY,EAHQ;AAIpBC,qBAAa,EAJO;AAKpBC,iBAAS,EALW;AAMpBC,mBAAW,EANS;AAOpBC,eAAO,EAPa;AAQpBC,aAAK,EARe;AASpBC,eAAO,EATa;AAUpB,WAAG,EAViB,EAUb,GAAG,EAVU,EAUN,GAAG,EAVG;AAWpBC,eAAO,EAXa;AAYpBC,gBAAQ,gBAAUlB,OAAV,EAAmBzC,QAAnB,EAA6B4D,QAA7B,EAAuC;;AAE3C,oBAAInB,QAAQL,WAAR,GAAsBZ,OAAtB,CAA8B,MAA9B,KAAyC,CAA7C,EAAgD;AAC5C;;AAEA,4BAAIqC,WAAWpB,QAAQL,WAAR,EAAf;AACAxE,kCAAU2C,WAAV,CAAsBsD,QAAtB,IAAkCjG,UAAU2C,WAAV,CAAsBsD,QAAtB,KAAmC,EAArE;AACA,+BAAOjG,UAAU2C,WAAV,CAAsBsD,QAAtB,EAAgC5D,IAAhC,CAAqC,EAAC6D,MAAM9D,QAAP,EAAiB+D,IAAIH,QAArB,EAArC,CAAP;AACH,iBAND,MAMO;;AAEHhG,kCAAU2C,WAAV,CAAsBkC,OAAtB,IAAiC7E,UAAU2C,WAAV,CAAsBkC,OAAtB,KAAkC,EAAnE;AACA,+BAAO7E,UAAU2C,WAAV,CAAsBkC,OAAtB,EAA+BxC,IAA/B,CAAoC,EAAC6D,MAAM9D,QAAP,EAAiB+D,IAAIH,QAArB,EAApC,CAAP;AACH;AAEJ,SA1BmB;AA2BpBpD,cAAM,gBAAY;;AAGd,yBAASwD,WAAT,CAAqBC,CAArB,EAAwB;;AAEpB,4BAAIvK,CAAJ;AACA,4BAAIsF,CAAJ;AACA,4BAAIiF,EAAEC,KAAF,IAAWD,EAAEE,KAAjB,EAAwB;AACpBzK,oCAAIuK,EAAEC,KAAN;AACAlF,oCAAIiF,EAAEE,KAAN;AACH,yBAHD,MAGO;AACHzK,oCAAIuK,EAAEG,OAAF,GAAYjK,SAASkK,IAAT,CAAcC,UAA1B,GAAuCnK,SAASoK,eAAT,CAAyBD,UAApE;AACAtF,oCAAIiF,EAAEO,OAAF,GAAYrK,SAASkK,IAAT,CAAcI,SAA1B,GAAsCtK,SAASoK,eAAT,CAAyBE,SAAnE;AACH;AACD/K,6BAAKkE,UAAUS,MAAV,CAAiBqG,UAAtB;AACA1F,6BAAKpB,UAAUS,MAAV,CAAiBsG,KAAjB,CAAuBC,GAA5B;AACA,+BAAO,EAAClL,GAAGA,CAAJ,EAAOsF,GAAGA,CAAV,EAAP;AACH;;AAGD,yBAAS6F,mBAAT,CAA6BC,KAA7B,EAAoC;;AAEhC,4BAAIC,MAAMf,YAAYc,KAAZ,CAAV;AACA,4BAAIvE,cAAc3C,UAAU2C,WAA5B;AACA,6BAAK,IAAI7G,CAAT,IAAc6G,WAAd,EAA2B;;AAGvB,oCAAIA,YAAY7G,CAAZ,aAA0BsL,KAA1B,IAAmCtL,KAAK,WAA5C,EAAyD;;AAGrDkE,kDAAUjB,IAAV,CAAe4D,YAAY7G,CAAZ,CAAf,EAA+B,UAAUmD,EAAV,EAAcoI,EAAd,EAAkB;;AAE7CA,mDAAGnB,IAAH,CAAQiB,IAAIrL,CAAZ,EAAeqL,IAAI/F,CAAnB;AACH,yCAHD;AAIH;AAEJ;AAEJ;AACD;AACA7E,yBAAS+K,SAAT,GAAqB,UAAUjB,CAAV,EAAa;;AAE9B;;AAEArG,kCAAUC,GAAV,CAAc,OAAd;;AAEA,4BAAIsH,QAAQ,SAASC,OAAOC,YAAP,CAAoBpB,EAAEqB,OAAtB,EAA+BlD,WAA/B,EAArB;AACA,4BAAIxE,UAAU2C,WAAV,CAAsB4E,KAAtB,aAAwCH,KAA5C,EAAmD;;AAE/CpH,0CAAUC,GAAV,CAAc,QAAd;;AAEAD,0CAAUjB,IAAV,CAAeiB,UAAU2C,WAAV,CAAsB4E,KAAtB,CAAf,EAA6C,UAAUtI,EAAV,EAAcC,IAAd,EAAoB;;AAE7D,4CAAI,OAAQA,KAAKgH,IAAb,IAAsB,UAA1B,EAAsC;;AAElC;;AAEAhH,qDAAKgH,IAAL;AACH;AAGJ,iCAVD;AAWH;AAEJ,iBAxBD;;AA2BA3J,yBAASoL,OAAT,GAAmB,UAAUtB,CAAV,EAAa;;AAE5B;;AAEA,4BAAIkB,QAAQ,SAASC,OAAOC,YAAP,CAAoBpB,EAAEqB,OAAtB,EAA+BlD,WAA/B,EAArB;AACA,4BAAIxE,UAAU2C,WAAV,CAAsB4E,KAAtB,aAAwCH,KAA5C,EAAmD;;AAE/CpH,0CAAUjB,IAAV,CAAeiB,UAAU2C,WAAV,CAAsB4E,KAAtB,CAAf,EAA6C,UAAUtI,EAAV,EAAcC,IAAd,EAAoB;;AAE7D,4CAAI,OAAQA,KAAKiH,EAAb,IAAoB,UAAxB,EAAoC;;AAEhC;;AAEAjH,qDAAKiH,EAAL;AACH;AAGJ,iCAVD;AAWH;AAEJ,iBApBD;;AAsBAnG,0BAAUS,MAAV,CAAiBmH,WAAjB,GAA+B,UAAUvB,CAAV,EAAa;;AAExC;;AAEA,4BAAIkB,QAAQlB,EAAEwB,KAAd;AACA,4BAAIV,MAAMf,YAAYC,CAAZ,CAAV;AACA,4BAAI1D,cAAc3C,UAAU2C,WAA5B;;AAGA0D,0BAAEyB,cAAF;;AAEA,gCAAQzB,EAAEwB,KAAV;AACI,qCAAK,CAAL;;AAEI,6CAAK,IAAI/L,CAAT,IAAc6G,WAAd,EAA2B;;AAGvB,oDAAIA,YAAY7G,CAAZ,aAA0BsL,KAA1B,IAAmCtL,KAAK,WAA5C,EAAyD;;AAGrDkE,kEAAUjB,IAAV,CAAe4D,YAAY7G,CAAZ,CAAf,EAA+B,UAAUmD,EAAV,EAAcoI,EAAd,EAAkB;;AAG7CA,mEAAGnB,IAAH,CAAQiB,IAAIrL,CAAZ,EAAeqL,IAAI/F,CAAnB;AACH,yDAJD;AAKH;AAGJ;;AAED;AACJ,qCAAK,CAAL;AACI;;;AAGA,6CAAK,IAAItF,CAAT,IAAckE,UAAU2C,WAAxB,EAAqC;;AAGjC,oDAAIA,YAAY7G,CAAZ,aAA0BsL,KAA1B,IAAmCtL,KAAK,aAA5C,EAA2D;;AAGvDkE,kEAAUjB,IAAV,CAAe4D,YAAY7G,CAAZ,CAAf,EAA+B,UAAUmD,EAAV,EAAcoI,EAAd,EAAkB;;AAE7CA,mEAAGnB,IAAH,CAAQiB,IAAIrL,CAAZ,EAAeqL,IAAI/F,CAAnB;AACH,yDAHD;AAIH;AAGJ;AACD;AACJ,qCAAK,CAAL;AACI;;;AAGA,6CAAK,IAAItF,CAAT,IAAckE,UAAU2C,WAAxB,EAAqC;;AAGjC,oDAAIA,YAAY7G,CAAZ,aAA0BsL,KAA1B,IAAmCtL,KAAK,YAA5C,EAA0D;;AAGtDkE,kEAAUjB,IAAV,CAAe4D,YAAY7G,CAAZ,CAAf,EAA+B,UAAUmD,EAAV,EAAcoI,EAAd,EAAkB;;AAE7CA,mEAAGnB,IAAH,CAAQiB,IAAIrL,CAAZ,EAAeqL,IAAI/F,CAAnB;AACH,yDAHD;;AAKA,+DAAO,KAAP;AACH;AAGJ;;AAED;AACJ;;AAEI,+CAAO,CAAP;AACJ;;AAhEJ;;AAqEAiF,0BAAEyB,cAAF;AACA,+BAAO,CAAP;AACH,iBAlFD;AAmFA9H,0BAAUS,MAAV,CAAiBsH,SAAjB,GAA6B,UAAU1B,CAAV,EAAa;;AAEtC;;AAEA,4BAAIkB,QAAQlB,EAAEwB,KAAd;AACA,4BAAIV,MAAMf,YAAYC,CAAZ,CAAV;AACA,4BAAI1D,cAAc3C,UAAU2C,WAA5B;;AAGA0D,0BAAEyB,cAAF;;AAEA,gCAAQzB,EAAEwB,KAAV;AACI,qCAAK,CAAL;;AAEI,6CAAK,IAAI/L,CAAT,IAAc6G,WAAd,EAA2B;;AAGvB,oDAAIA,YAAY7G,CAAZ,aAA0BsL,KAA1B,IAAmCtL,KAAK,WAA5C,EAAyD;;AAGrDkE,kEAAUjB,IAAV,CAAe4D,YAAY7G,CAAZ,CAAf,EAA+B,UAAUmD,EAAV,EAAcoI,EAAd,EAAkB;;AAG7CA,mEAAGlB,EAAH,CAAMgB,IAAIrL,CAAV,EAAaqL,IAAI/F,CAAjB;AACH,yDAJD;AAKH;AAGJ;;AAED;AACJ,qCAAK,CAAL;AACI;;;AAGA,6CAAK,IAAItF,CAAT,IAAckE,UAAU2C,WAAxB,EAAqC;;AAGjC,oDAAIA,YAAY7G,CAAZ,aAA0BsL,KAA1B,IAAmCtL,KAAK,aAA5C,EAA2D;;AAGvDkE,kEAAUjB,IAAV,CAAe4D,YAAY7G,CAAZ,CAAf,EAA+B,UAAUmD,EAAV,EAAcoI,EAAd,EAAkB;;AAE7CA,mEAAGlB,EAAH,CAAMgB,IAAIrL,CAAV,EAAaqL,IAAI/F,CAAjB;AACH,yDAHD;AAIH;AAGJ;AACD;AACJ,qCAAK,CAAL;AACI;;;AAGA,6CAAK,IAAItF,CAAT,IAAckE,UAAU2C,WAAxB,EAAqC;;AAGjC,oDAAIA,YAAY7G,CAAZ,aAA0BsL,KAA1B,IAAmCtL,KAAK,YAA5C,EAA0D;;AAGtDkE,kEAAUjB,IAAV,CAAe4D,YAAY7G,CAAZ,CAAf,EAA+B,UAAUmD,EAAV,EAAcoI,EAAd,EAAkB;;AAE7CA,mEAAGlB,EAAH,CAAMgB,IAAIrL,CAAV,EAAaqL,IAAI/F,CAAjB;AACH,yDAHD;;AAMA,+DAAO,KAAP;AAEH;AAGJ;;AAED;AACJ;;AAEI,+CAAO,CAAP;AACJ;;AAlEJ;AAuEH,iBAlFD;AAmFA7E,yBAASyL,gBAAT,CAA0B,WAA1B,EAAuCf,mBAAvC;AACH;;AA3RmB,CAAxB;;AAiSApF,cAAcsB,MAAd;;AAEA;;AAEA8E,OAAOC,wBAAP,GAAkCD,OAAOhL,MAAzC;;AAEAgL,OAAOhL,MAAP,GAAgB,YAAY;;AAExB,YAAI,OAAOgL,OAAOC,wBAAd,IAA2C,UAA/C,EAA2D;AACvDD,uBAAOC,wBAAP;AACH;;AAEDrG,oBAAYS,SAAZ;AAEH,CARD;;AAWA;;;;;AAMA,IAAI6F,SAAS;AACTvH,cAAM,cAAUwH,MAAV,EAAkB7H,GAAlB,EAAuB;;AAEzB,oBAAI6H,OAAOC,MAAP,IAAiBD,OAAOE,QAAP,CAAgBC,KAAKC,KAArB,EAA4BD,KAAKE,MAAjC,CAArB,EAA+D;;AAE3D,6BAAKC,WAAL,CAAiBN,MAAjB,EAAyB7H,GAAzB;AAEH;AAEJ,SATQ;AAUToI,+BAAuB,+BAAUC,GAAV,EAAeC,EAAf,EAAmBC,EAAnB,EAAuBC,EAAvB,EAA2BC,EAA3B,EAA+BlN,CAA/B,EAAkCsF,CAAlC,EAAqCV,KAArC,EAA4CC,MAA5C,EAAoDsI,GAApD,EAAyDC,gBAAzD,EAA2EC,IAA3E,EAAiF;;AAEpGD,iCAAiBE,IAAjB;AACAH,sBAAM1K,KAAK8K,KAAL,CAAWJ,GAAX,CAAN;AACAA,sBAAMA,MAAM,GAAZ;AACA,oBAAIK,MAAML,MAAM1K,KAAKgL,EAAX,GAAgB,GAA1B;AACA;AACAL,iCAAiBM,SAAjB,CAA2B1N,CAA3B,EAA8BsF,CAA9B;AACA8H,iCAAiBO,MAAjB,CAAwBH,GAAxB;AACA;;AAEAJ,iCAAiBM,SAAjB,CAA2B,CAA3B,EAA8BN,iBAAiBxI,KAA/C;AACA,oBAAIyI,IAAJ,EAAU;;AAEND,yCAAiBQ,KAAjB,CAAuB,CAAC,CAAxB,EAA2B,CAA3B;AACH,iBAHD,MAGO,CAEN;;AAED;AACAR,iCAAiBS,SAAjB,CAA2Bf,GAA3B,EAAgCC,EAAhC,EAAoCC,EAApC,EAAwCC,EAAxC,EAA4CC,EAA5C,EAAgDtI,QAAQ,CAAR,GAAa,CAAC,CAA9D,EAAkEC,SAAS,CAAT,GAAc,CAAC,CAAjF,EAAqFD,KAArF,EAA4FC,MAA5F;AACA;;AAEAuI,iCAAiBU,OAAjB;AACH,SAlCQ;;AAqCT;;;;;;;;AASAlB,qBAAa,qBAAUN,MAAV,EAAkB7H,GAAlB,EAAuB;;AAEhC,oBAAIsJ,KAAJ;;AAEA,oBAAIzB,OAAOC,MAAX,EAAmB;;AAEf,4BAAID,OAAO0B,kBAAP,IAA6B1B,OAAO0B,kBAAP,CAA0BC,cAA3D,EAA2E;;AAEvEF,wCAAQzB,OAAO0B,kBAAP,CAA0BC,cAAlC;AAEH,yBAJD,MAKK;;AAEDlK,wCAAQhD,KAAR,CAAc,6BAAd;AAEH;;AAED,4BAAIf,IAAIsM,OAAOlH,QAAP,CAAgBpF,CAAxB;AACA,4BAAIsF,IAAIgH,OAAOlH,QAAP,CAAgBE,CAAxB;;AAEA,4BAAI4I,SAASnI,YAAYmI,MAAZ,IAAsB,EAAC7C,KAAK,EAACrL,GAAG,CAAJ,EAAOsF,GAAG,CAAV,EAAa6I,GAAG,CAAhB,EAAN,EAAnC;;AAGA,4BAAI,IAAJ,EAAU;;AAEN,oCAAI,CAACvK,MAAMsK,OAAO7C,GAAP,CAAWrL,CAAjB,CAAL,EAA0B;;AAEtBA,6CAAKkO,OAAO7C,GAAP,CAAWrL,CAAhB;AACH;;AAED,oCAAI,CAAC4D,MAAMsK,OAAO7C,GAAP,CAAW/F,CAAjB,CAAL,EAA0B;;AAEtBA,6CAAK4I,OAAO7C,GAAP,CAAW/F,CAAhB;AACH;AAEJ;AACD;;AAGA;;AAEA,4BAAI8I,aAAa9B,OAAOjH,IAAP,IAAeiH,OAAO0B,kBAAP,CAA0B3I,IAA1D;;AAEA,4BAAIgJ,YAAYD,WAAWpO,CAA3B;AACA,4BAAIsO,aAAaF,WAAW9I,CAA5B;;AAEA;;AAEA,4BAAIgH,OAAO0B,kBAAP,CAA0BO,MAA9B,EAAsC;AAClCvO,qCAAKsM,OAAO0B,kBAAP,CAA0BO,MAA1B,CAAiCvO,CAAtC;;AAEAsF,qCAAKgH,OAAO0B,kBAAP,CAA0BO,MAA1B,CAAiCjJ,CAAtC;AAEH;;AAED,4BAAIkJ,QAAJ;;AAEA,4BAAI,QAAOlC,OAAOkC,QAAd,KAA2B,QAA/B,EAAyC;;AAErCA,2CAAWlC,OAAOkC,QAAP,CAAgBxO,CAA3B;AAGH,yBALD,MAMK;AACDwO,2CAAWlC,OAAOkC,QAAlB;AAEH;;AAGD,6BAAK3B,qBAAL,CAA2BP,OAAO0B,kBAAP,CAA0BxN,KAA1B,CAAgCU,UAA3D,EAAuE6M,MAAMU,QAAN,CAAezO,CAAtF,EAAyF+N,MAAMU,QAAN,CAAenJ,CAAxG,EAA2GyI,MAAMW,SAAN,CAAgB1O,CAA3H,EAA8H+N,MAAMW,SAAN,CAAgBpJ,CAA9I,EAAiJ7C,KAAK8K,KAAL,CAAWvN,IAAKqO,YAAY,CAA5B,CAAjJ,EAAkL5L,KAAK8K,KAAL,CAAWjI,IAAKgJ,aAAa,CAA7B,CAAlL,EAAoND,SAApN,EAA+NC,UAA/N,EAA2OE,WAAW,GAAtP,EAA2P/J,GAA3P,EAAgQ6H,OAAOqC,KAAvQ;AACH;AAEJ;;AAtHQ,CAAb;;AA2HAzK,UAAUmC,KAAV,CAAgB,UAAUhF,GAAV,EAAe;;AAE3B6C,kBAAUC,GAAV,CAAc,wBAAd;AAGH,CALD;;AAQA;;;;;;IAOMyK,U;AAEF,mCAA+E;AAAA,oBAAlEjK,MAAkE,SAAlEA,MAAkE;AAAA,oBAA1DF,GAA0D,SAA1DA,GAA0D;AAAA,oBAArDvB,OAAqD,SAArDA,OAAqD;AAAA,oBAA5C2L,WAA4C,SAA5CA,WAA4C;AAAA,oBAA/BC,YAA+B,SAA/BA,YAA+B;AAAA,oBAAjBC,MAAiB,SAAjBA,MAAiB;AAAA,oBAATzK,MAAS,SAATA,MAAS;;AAAA;;AAE3E,qBAAKpB,OAAL,GAAeA,mBAAmBoI,KAAnB,GAA2BpI,OAA3B,GAAqC,EAApD;;AAEA,qBAAK2L,WAAL,GAAmBA,uBAAuBvD,KAAvB,GAA+BuD,WAA/B,GAA6C,EAAhE;;AAEA,qBAAKC,YAAL,GAAoBA,wBAAwBxD,KAAxB,GAAgCwD,YAAhC,GAA+C,EAAnE;;AAEA,qBAAKC,MAAL,GAAcA,kBAAkBzD,KAAlB,GAA0ByD,MAA1B,GAAmC,EAAjD;;AAEA,qBAAKpK,MAAL,GAAcA,MAAd;;AAEA,oBAAI,CAAC,KAAKA,MAAV,EAAkB;AACd,6BAAKA,MAAL,GAAclE,SAASC,aAAT,CAAuB,QAAvB,CAAd;AACAqD,gCAAQC,IAAR,CAAa,kCAAb;AACH;;AAED,qBAAKS,GAAL,GAAWA,OAAOE,OAAOqK,UAAP,CAAkB,IAAlB,CAAlB;;AAEA,qBAAKC,QAAL,GAAgB,IAAIC,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAhB;;AAEA,oBAAI,OAAO5K,MAAP,IAAiB,UAArB,EAAiC;AAC7B,6BAAK6K,QAAL,CAAc7K,MAAd;AAEH;;AAEDJ,0BAAU1C,YAAV,GAAyB,IAAzB;;AAEA0C,0BAAUS,MAAV,GAAmB,KAAKA,MAAxB;;AAEAT,0BAAUO,GAAV,GAAgB,KAAKA,GAArB;AAEH;;;;wCAEOuB,I,EAAM;;AAEV,4BAAIoJ,UAAU,EAAd;;AAEApM,0BAAEC,IAAF,CAAO+C,IAAP,EAAa,UAAU7C,EAAV,EAAcC,IAAd,EAAoB;;AAE7B,oCAAI,CAACgM,QAAQtH,OAAR,CAAgB1E,KAAKiM,EAArB,CAAD,IAA6B,CAAjC,EAAoC;;AAEhC,4CAAI3H,MAAMtE,KAAKkM,IAAf;;AAEAF,gDAAQ7I,IAAR,CAAa,EAAC,UAAUnD,IAAX,EAAb;AAEH;AAEJ,yBAVD;;AAYA,+BAAOgM,OAAP;AAEH;;;0CAESG,M,EAAQ;AACd,6BAAKA,MAAL,GAAcA,MAAd;;AAEA,4BAAI,CAAC,KAAKrM,OAAL,CAAa4E,OAAb,CAAqByH,MAArB,CAAD,IAAiC,CAArC,EAAwC;AACpC,qCAAKrM,OAAL,CAAaqD,IAAb,CAAkBgJ,MAAlB;AAEH;AAEJ;;;yCAEQ;;AAELrL,kCAAUjB,IAAV,CAAe,KAAKC,OAApB,EAA6B,UAAUC,EAAV,EAAcC,IAAd,EAAoB;;AAE7C,oCAAI,OAAOA,KAAKkB,MAAZ,IAAuB,UAA3B,EAAuC;AACnClB,6CAAKkB,MAAL,CAAYlB,IAAZ;AAEH;;AAED,oCAAI,OAAOA,KAAKoM,UAAZ,IAA2B,UAA/B,EAA2C;AACvC;;AAEApM,6CAAKoM,UAAL,CAAgBpM,IAAhB;AAEH;AAEJ,yBAdD;AAiBH;;;yCAEQqM,G,EAAK;AACV,4BAAI,OAAOA,GAAP,IAAe,UAAnB,EAA+B;AAC3B,oCAAIpF,KAAK,KAAK/F,MAAd;;AAEA,qCAAKA,MAAL,GAAc,UAAUpB,OAAV,EAAmB;AAC7BmH,2CAAGnH,OAAH;AACAuM,4CAAIvM,OAAJ;AACH,iCAHD;AAKH;AAEJ;;;uCAEM;;AAEH,4BAAIwM,MAAM,IAAV;;AAEAxL,kCAAUjB,IAAV,CAAe,KAAKC,OAApB,EAA6B,UAAUC,EAAV,EAAcC,IAAd,EAAoB;;AAE7CiJ,uCAAOvH,IAAP,CAAY1B,IAAZ,EAAkBsM,IAAIjL,GAAtB;AAEH,yBAJD;AAMH;;;;;;AAGL;;IAGMkL,W;;;;AAMN;;;;;;IAOMC,W,CAAY;;AAEd,oCAA8B;AAAA,oBAAjBC,IAAiB,SAAjBA,IAAiB;AAAA,oBAAXC,QAAW,SAAXA,QAAW;;AAAA;AAE7B;;;;oCAEGC,I,EAAMvP,K,EAAOwP,K,EAAOH,I,EAAM,CAG7B;;;uCAEM,CAGN;;;yCAEQ,CAER;;;;;;IAKCI,U,CAAW;;AAEb,mCAA8B;AAAA,oBAAjBJ,IAAiB,SAAjBA,IAAiB;AAAA,oBAAXC,QAAW,SAAXA,QAAW;;AAAA;AAE7B;;;;oCAEGC,I,EAAMvP,K,EAAOwP,K,EAAOH,I,EAAM,CAG7B;;;uCAEM,CAGN;;;yCAEQ,CAER;;;;;;IAICK,Y,CAAa;;AAEf,qCAAyB;AAAA,oBAAZnQ,GAAY,SAAZA,GAAY;AAAA,oBAAPsF,IAAO,SAAPA,IAAO;;AAAA;;AAErB,qBAAKnE,UAAL,GAAkBiP,SAAlB;;AAEA,qBAAKpQ,GAAL,GAAWA,GAAX;;AAEA,qBAAKsF,IAAL,GAAY,IAAI6J,OAAJ,CAAY7J,KAAKrF,CAAjB,EAAoBqF,KAAKC,CAAzB,EAA4BD,KAAK8I,CAAL,IAAU,CAAtC,CAAZ;;AAEAjK,0BAAUC,GAAV,CAAc,2CAAd;AAEH;;;;uCAEM,CAEN;;;;;;AAGL,C,CAAC;;;;;IAOKiM,S;AACF,2BAAYvK,IAAZ,EAAkB;AAAA;;AAEdA,uBAAOA,QAAQ,EAAf;;AAEA,oBAAIwK,SAAS,IAAb;;AAEA,qBAAKf,IAAL,GAAY,KAAKvI,MAAL,CAAYlB,IAAZ,EAAkB,MAAlB,EAA0B,QAA1B,CAAZ,EAEA,KAAKyK,WAAL,GAAoB,KAAKvJ,MAAL,CAAYlB,IAAZ,EAAkB,aAAlB,EAAiC,QAAjC,CAFpB;;AAIA,qBAAK0K,MAAL,GAAc,KAAKxJ,MAAL,CAAYlB,IAAZ,EAAkB,QAAlB,EAA4B,EAA5B,CAAd;;AAEA,qBAAKrF,KAAL,GAAa,IAAIH,SAAJ,CAAe,KAAK0G,MAAL,CAAYlB,IAAZ,EAAkB,KAAlB,EAA0B,KAAKkB,MAAL,CAAYlB,IAAZ,EAAkB,OAAlB,EAA2B,KAA3B,CAA1B,CAAf,CAAb;;AAGA,qBAAK9F,GAAL,GAAW,KAAKS,KAAL,CAAWU,UAAX,CAAsBnB,GAAjC;;AAEA,qBAAKmB,UAAL,GAAkB,KAAKV,KAAL,CAAWU,UAA7B;;AAEA,qBAAKsP,IAAL,GAAY,KAAKzJ,MAAL,CAAYlB,IAAZ,EAAkB,MAAlB,EAA0B,OAA1B,CAAZ;;AAEA,qBAAK4K,KAAL,GAAa,KAAK1J,MAAL,CAAYlB,IAAZ,EAAkB,OAAlB,EAA2B,CAA3B,CAAb;;AAEA,qBAAK6K,GAAL,GAAW,CAAX;;AAEA,qBAAKhC,SAAL,GAAiB,KAAK3H,MAAL,CAAYlB,IAAZ,EAAkB,WAAlB,EAA+B,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA/B,CAAjB;;AAEA,qBAAKyB,WAAL,GAAmB,KAAK5J,MAAL,CAAYlB,IAAZ,EAAkB,aAAlB,EAAiC,IAAI+K,iBAAJ,CAAsB,IAAI1B,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAtB,EAA4C,IAAIA,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA5C,EAAkE,IAAIA,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAlE,CAAjC,CAAnB;;AAEA,qBAAK2B,WAAL,GAAmB,KAAK9J,MAAL,CAAYlB,IAAZ,EAAkB,aAAlB,EAAiC,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAjC,CAAnB;;AAGF,oBAAG,QAAOrJ,IAAP,yCAAOA,IAAP,MAAgB,QAAhB,IAA4BA,KAAK8K,WAAjC,IAAgD9K,KAAK6I,SAAxD,EAAkE;AAAG,6BAAKoC,aAAL,CAAmBjL,KAAKkL,MAAL,IAAe,EAAlC;AAAuC;;AAE1G,qBAAKpC,KAAL,GAAa,KAAK5H,MAAL,CAAYlB,IAAZ,EAAkB,OAAlB,EAA2B,KAA3B,CAAb;;AAEA,qBAAKmL,QAAL,GAAgB,KAAKjK,MAAL,CAAYlB,IAAZ,EAAkB,UAAlB,EAA8B,CAA9B,CAAhB;;AAEA,qBAAK6K,GAAL,GAAW,CAAX;;AAEA,qBAAKzC,cAAL,GAAsB,KAAKsC,MAAL,CAAY,CAAZ,CAAtB;;AAEA,qBAAKU,SAAL,GAAiB,KAAKlK,MAAL,CAAYlB,IAAZ,EAAkB,WAAlB,EAA+B,KAA/B,CAAjB;;AAEA,qBAAKqL,IAAL,GAAW,KAAKnK,MAAL,CAAYlB,IAAZ,EAAkB,MAAlB,EAA0B,KAA1B,CAAX;;AAEA,qBAAKsL,QAAL,GAAgB,KAAKpK,MAAL,CAAYlB,IAAZ,EAAkB,UAAlB,EAA8B,IAA9B,CAAhB;;AAEA,qBAAKR,IAAL,GAAa,KAAK0B,MAAL,CAAYlB,IAAZ,EAAkB,MAAlB,EAA0B,IAAIqJ,OAAJ,CAAY,EAAZ,EAAgB,EAAhB,EAAoB,EAApB,CAA1B,CAAb;;AAEA,qBAAKkC,OAAL,GAAe,EAAf;;AAEA,qBAAKC,KAAL,GAAa,CAAb;;AAEA,qBAAKC,WAAL,GAAmB,KAAnB;;AAEA,qBAAKC,OAAL,GAAe,YAAU,CAAI,CAA7B;AAEH;;;;4CAEW7C,S,EAAWrJ,I,EACvB;;AAEI,6BAAKmM,WAAL,GAAmB,QAAnB;;AAEA,6BAAK9C,SAAL,GAAiBA,SAAjB;;AAEA,6BAAKrJ,IAAL,GAAYA,IAAZ;;AAEA,6BAAK4I,cAAL,GAAsB;AAClBzN,uCAAO,KAAKA,KADM;AAElBkO,2CAAW,KAAKA,SAFE;AAGlBD,0CAAU,EAACzO,GAAG,CAAJ,EAAOsF,GAAG,CAAV;AAHQ,yBAAtB;;AAMA,6BAAKiL,MAAL,CAAY,CAAZ,IAAiB,KAAKtC,cAAtB;AAGH;;;uCAEMpI,I,EAAMmB,G,EAAKC,Q,EAAU;;AAExB,4BAAIpB,KAAKqB,cAAL,CAAoBF,GAApB,CAAJ,EAA8B;;AAE1B,uCAAOnB,KAAKmB,GAAL,CAAP;AAEH,yBAJD,MAKK;AACD,uCAAOC,QAAP;AAEH;AAEJ;;;gDAEe;;AAEZ,6BAAKsJ,MAAL,GAAc,EAAd;;AAEA,4BAAIkB,SAAS,CAAb;;AAGA,4BAAIC,WAAW,KAAf;;AAEA,6BAAK,IAAIpM,IAAI,KAAKqL,WAAL,CAAiBgB,GAAjB,CAAqBrM,CAAlC,EAAqCA,KAAK,KAAKqL,WAAL,CAAiBiB,GAAjB,CAAqBtM,CAA/D,EAAkEA,GAAlE,EAAuE;;AAEnE,qCAAK,IAAItF,IAAI,KAAK2Q,WAAL,CAAiBgB,GAAjB,CAAqB3R,CAAlC,EAAqCA,KAAK,KAAK2Q,WAAL,CAAiBiB,GAAjB,CAAqB5R,CAA/D,EAAkEA,GAAlE,EAAuE;;AAEnE,4CAAIyO,WAAW,EAACzO,GAAGA,IAAI,KAAK0O,SAAL,CAAe1O,CAAnB,GAAuB,KAAK6Q,WAAL,CAAiB7Q,CAA5C,EAA+CsF,GAAGA,IAAI,KAAKoJ,SAAL,CAAepJ,CAAnB,GAAuB,KAAKuL,WAAL,CAAiBvL,CAA1F,EAAf;;AAEA,6CAAKiL,MAAL,CAAYhK,IAAZ,CAAiB,EAAC/F,OAAO,KAAKA,KAAb,EAAoBkO,WAAW,KAAKA,SAApC,EAA+CD,UAAUA,QAAzD,EAAjB;;AAEA,4CAAIzO,KAAK,KAAK2Q,WAAL,CAAiBkB,SAAjB,CAA2B7R,CAAhC,IAAqCsF,KAAK,KAAKqL,WAAL,CAAiBkB,SAAjB,CAA2BvM,CAAzE,EACA;;AAEIoM,2DAAW,IAAX;;AAEA;AACH;;AAEDD,kDAAU,CAAV;;AAEA,4CAAGC,QAAH,EACI;AAEP;AAEJ;;AAED,6BAAKnB,MAAL,CAAY,CAAZ,IAAiB,CAAC,KAAKA,MAAL,CAAY,CAAZ,CAAD,GAAkB;AAC3B/P,uCAAO,KAAKA,KADe;AAE3BkO,2CAAW,KAAKA,SAFW;AAG3BD,0CAAU,EAACzO,GAAG,KAAK2Q,WAAL,CAAiBgB,GAAjB,CAAqB3R,CAAzB,EAA4BsF,GAAG,KAAKqL,WAAL,CAAiBgB,GAAjB,CAAqBrM,CAApD;AAHiB,yBAAlB,GAIT,KAAKiL,MAAL,CAAY,CAAZ,CAJR;;AAMD;AAEF;;;8CAEa;AACd;;AAEI,6BAAKO,aAAL;AAEH;;;yCAEQ;;AAEL,6BAAK7C,cAAL,GAAsB,KAAKsC,MAAL,CAAY9N,KAAK8K,KAAL,CAAW,KAAKmD,GAAhB,IAAuB,KAAKH,MAAL,CAAYzP,MAA/C,CAAtB;AAGH;;;wCAGL;;AAEI,6BAAKgR,WAAL;;AAEA,6BAAKpB,GAAL,GAAW,CAAX;AAEH;;;2CAEUS,Q,EACX;;AAEI,4BAAG,KAAKK,WAAL,IAAoB,QAAvB,EACA;AACI,uCAAO,CAAP;AAEH;;AAEH,6BAAKV,aAAL;;AAEE;AACA,6BAAKxM,MAAL;;AAGA,4BAAG,KAAKoM,GAAL,IAAY,CAAf,EACF;;AAEI,qCAAKqB,MAAL;AAEH;AAGF;;;uCAEMZ,Q,EAAUa,Q,EACjB;;AAEI,4BAAG,KAAKR,WAAL,IAAoB,QAAvB,EACA;AACI,uCAAO,CAAP;AAEH;;AAGD,4BAAI1O,SAAS,IAAb;;AAEA,6BAAKkP,QAAL,GAAgBA,YAAY,KAAKA,QAAjB,IAA6B,YAAU,CAAI,CAA3D;;AAEA,4BAAIb,WAAWA,YAAY,OAAO,KAAKA,QAAZ,IAAyB,QAArC,GAAgD,KAAKA,QAArD,GAAgE,KAAKZ,MAAL,CAAYzP,MAAZ,GAAqB,EAApG;;AAEA;AACF,6BAAKmR,KAAL,GAAa,IAAI5N,MAAM6N,KAAV,CAAgB,IAAhB,EACNC,MADM,CACCrP,OAAOsP,KAAP,IAAgB/N,MAAMgO,MAAN,CAAaC,MAAb,CAAoBC,IADrC,EAGNC,EAHM,CAGH,EAAC9B,KAAI5N,OAAOyN,MAAP,CAAczP,MAAd,GAAuB,CAA5B,EAHG,EAG6BqQ,QAH7B,EAINhC,QAJM,CAIG,YAAW;AACjB;;AAEH;;AAEDrM,uCAAOwB,MAAP;AAEC,yBAXM,EAYN4B,UAZM,CAYK,YAAW;AACnB;;AAEA,oCAAGpD,OAAOkP,QAAV,EACA;;AAEIlP,+CAAOkP,QAAP;AAEH;;AAEDlP,uCAAO4N,GAAP,GAAa,CAAb;;AAEA5N,uCAAO2P,UAAP,GAAoB,IAApB;AAEH,yBA1BM,CAAb;;AA6BA,6BAAKR,KAAL,CAAWlN,KAAX;AAGD;;;2CAEU2N,G,EACX;AACI,6BAAKV,QAAL,GAAgBU,GAAhB;AAEH;;;0CAEa;;AAEN,6BAAK5B,aAAL;;AAEA,6BAAKO,KAAL,IAAc,CAAd;;AAEAjK,+BAAOjD,GAAP,CAAW,gCAAgC,KAAKoM,MAAL,CAAYzP,MAAvD;;AAEA,4BAAG,KAAKuQ,KAAL,GAAa,KAAKZ,KAAlB,IAA2B,CAA9B,EAAiC;;AAE7B,oCAAG,KAAKS,IAAR,EACA;AACI,6CAAKR,GAAL,GAAW,KAAKA,GAAL,GAAW,CAAtB;;AAEA,4CAAG,KAAKA,GAAL,GAAW,KAAKH,MAAL,CAAYzP,MAAZ,GAAqB,CAAnC,EACA;AACI,qDAAK4P,GAAL,GAAY,KAAKH,MAAL,CAAYzP,MAAZ,GAAqB,CAAjC;AAEH;AAEJ,iCAVD,MAYA;;AAEI,6CAAK4P,GAAL,GAAW,KAAKA,GAAL,IAAY,KAAKH,MAAL,CAAYzP,MAAZ,GAAqB,CAAjC,GAAqC,KAAK6P,WAAL,CAAiBgB,GAAjB,CAAqB3R,CAA1D,GAA8D,KAAK0Q,GAAL,GAAW,CAApF;AACH;;AAED,qCAAKpM,MAAL;AAEH;AAEJ;;;;;;AAEJ;AACD,C,CAAC;;;;;;;;IASKqO,M;AAGF,wBAAYvN,QAAZ,EACA;AAAA;;AAEE,qBAAKA,QAAL,GAAgBlB,UAAU6C,MAAV,CAAiBlB,IAAjB,EAAuB,UAAvB,EAAmC3B,UAAU6C,MAAV,CAAiBlB,IAAjB,EAAuB,KAAvB,EAA8B,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA9B,CAAnC,CAAhB;AAED;;;;uCAEMtJ,M,EAAQgN,K,EAAOhB,G,EAAKiB,Q,EAC3B,CAGC;;;;;;AAML;AACA;;;;;;;IAOMC,Q;AAEF,0BAAYjN,IAAZ,EAAkB;AAAA;;AAGd,qBAAKkN,YAAL,GAAoBlN,KAAKmN,UAAzB;AAEH;;;;6CAEYtM,K,EAAMuM,S,EACnB;;AAEI,4BAAIC,aAAaxM,KAAjB;;AAEAA,gCAAO,gBAAU;AAAEA,wCAAQuM;AAAc,yBAAzC;;AAEA,+BAAOvM,KAAP;AAEH;;;mCAEEM,G,EAAKV,Q,EACR;;AAEI,4BAAG,QAAO,KAAKyM,YAAZ,KAA6B,QAA7B,IAAyC,OAAO,KAAKA,YAAL,CAAkB/L,GAAlB,CAAP,IAAkC,UAA9E,EACA;;AAEIjD,wCAAQC,IAAR,CAAa,kCAAkCgD,GAA/C;;AAEA,qCAAK+L,YAAL,CAAkB/L,GAAlB,IAAyB,KAAKmM,YAAL,CAAkB,KAAKJ,YAAL,CAAkB/L,GAAlB,CAAlB,EAA0CV,QAA1C,CAAzB;AAEH,yBAPD,MASA;AACIvC,wCAAQhD,KAAR,CAAc,qCAAd;AAEH;AAEJ;;;;;;AAGJ;;AAKD,C,CAAC;;;;;AAMDoG,QAAQiM,MAAR,GAAkB;AAEd1M,YAFc,gBAET2M,KAFS,EAGd;AACI,oBAAG,EAAEA,iBAAiB/H,KAAnB,CAAH,EACA;;AAEE,+BAAOvH,QAAQhD,KAAR,CAAc,6CAAd,CAAP;AAED;;AAED;;AAEA,qBAAI,IAAIf,IAAI,CAAZ,EAAeA,IAAIqT,MAAMvS,MAAzB,EAAiCd,GAAjC,EACA;AACI,4BAAIoD,OAAOiQ,MAAMrT,CAAN,CAAX;;AAEA,4BAAG,OAAOoD,KAAK2O,MAAZ,IAAuB,UAA1B,EACA;AACI3O,qCAAK2O,MAAL;AAEH;;AAED,4BAAG,OAAO3O,KAAKkQ,IAAZ,IAAqB,UAAxB,EACA;AACIlQ,qCAAKkQ,IAAL;AAEH;;AAED,4BAAG,OAAOlQ,KAAK2B,KAAZ,IAAsB,UAAzB,EACA;AACI3B,qCAAK2B,KAAL;AAEH;;AAED,4BAAG,OAAO3B,KAAKmQ,GAAZ,IAAoB,UAAvB,EACA;AACInQ,qCAAKmQ,GAAL;AAEH;;AAED,4BAAG,OAAOnQ,KAAKoQ,OAAZ,IAAwB,UAA3B,EACA;AACIpQ,qCAAKoQ,OAAL;AAEH;AAEJ;AAEJ;AAjDa,CAAlB,C,CA8DC;;;;;IAKKC,K;AAEF,uBAAY5N,IAAZ,EACA;AAAA;;AAEI,qBAAKyJ,IAAL,GAAYzJ,KAAKyJ,IAAL,IAAa,EAAzB;;AAEA,qBAAKgB,WAAL,GAAmBzK,KAAKyK,WAAL,IAAoB,EAAvC;;AAEA,qBAAKoD,QAAL,GAAgB7N,KAAK6N,QAAL,IAAiB,EAAjC;AACA,qBAAKC,MAAL,GAAe9N,KAAK8N,MAAL,IAAe,EAA9B;AACA,qBAAKC,WAAL,GAAmB/N,KAAK+N,WAAL,IAAoB,EAAvC;;AAEA,qBAAKC,QAAL,GAAgBhO,KAAKgO,QAAL,IAAiB,IAAI3E,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAjC;;AAEA,qBAAK0C,GAAL,GAAW/L,KAAK+L,GAAL,IAAY,IAAI1C,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAvB;AACC,qBAAK0D,KAAL,GAAa/M,KAAK+M,KAAL,IAAc,IAAI1D,OAAJ,CAAY,GAAZ,EAAiB,GAAjB,EAAsB,GAAtB,CAA3B;;AAED,qBAAI,IAAIlP,CAAR,IAAa6F,IAAb,EACA;AACI,6BAAK7F,CAAL,IAAU6F,KAAK7F,CAAL,CAAV;AAEH;AAEJ;;;;uCAEM6F,I,EAAMmB,G,EAAKC,Q,EAAU;;AAExB,4BAAIpB,KAAKqB,cAAL,CAAoBF,GAApB,CAAJ,EAA8B;;AAE1B,uCAAOnB,KAAKmB,GAAL,CAAP;AAEH,yBAJD,MAKK;AACD,uCAAOC,QAAP;AAEH;AAEJ;;;6CAID;;AAEE,4BAAKyM,WAAW,KAAKA,QAArB;;AAEC,4BAAIC,SAAU,KAAKA,MAAL,IAAe,EAA7B;;AAEA,4BAAIC,cAAe,KAAKA,WAAxB;;AAED,4BAAKhB,QAAS,KAAKA,KAAL,IAAc,EAA5B;;AAEE,4BAAIhB,MAAO,KAAKA,GAAL,IAAY,EAAvB;;AAEA5O,0BAAEC,IAAF,CAAOyQ,QAAP,EAAiB,UAASvQ,EAAT,EAAa2Q,KAAb,EAAmB;;AAEjCA,sCAAMC,MAAN,CAAanB,KAAb,EAAoBhB,GAApB;;AAEAkC,sCAAME,SAAN,GAAkB,IAAlB;;AAEChR,kCAAEC,IAAF,CAAO2Q,WAAP,EAAoB,UAASK,EAAT,EAAaC,KAAb,EAAmB;;AAEnCJ,8CAAMK,YAAN,CAAmBD,KAAnB;AAGH,iCALD;AAMH,yBAZD;AAaH;;;;;;AACJ;;AAOD;;IAEME,e;AAEF,mCACA;AAAA;;AACI,qBAAKC,SAAL,GAAiB,EAAjB;AAEH;;;;oCAEGC,M,EACJ;AACI,6BAAKD,SAAL,CAAe9N,IAAf,CAAoB+N,MAApB;AAEH;;;;;;AAEJ;;AAED,C,CAAC;;;;IAIKC,U;AAEF,4BAAYjF,IAAZ,EAAkB7D,KAAlB,EAAyB;AAAA;;AAErB,qBAAK+I,IAAL,GAAY,qBAAZ;;AAEA,qBAAKlF,IAAL,GAAWA,IAAX;;AAEA,qBAAK7D,KAAL,GAAaA,KAAb;AAEH;;;;wCAEO7F,M,EACR;AACI;AACA;;;AAGA,6BAAI,IAAI5F,CAAR,IAAa4F,MAAb,EACA;AACI,oCAAG5F,EAAE0I,WAAF,MAAmB,KAAK4G,IAAL,CAAU5G,WAAV,EAAnB,IAA8C,QAAO+C,KAAP,yCAAOA,KAAP,cAAwB7F,OAAO5F,CAAP,CAAxB,CAAjD,EACA;;AAEI4F,+CAAO5F,CAAP,KAAa,KAAKyL,KAAlB;AAEH;AAEJ;AAEJ;;;;;;IAICzG,S;AAEF,kCACA;AAAA,oBADaY,MACb,SADaA,MACb;AAAA,oBADqB6O,YACrB,SADqBA,YACrB;AAAA,oBADmCC,MACnC,SADmCA,MACnC;;AAAA;;AACI,qBAAK9O,MAAL,GAAcA,UAAU,EAAxB;;AAEA,qBAAK6O,YAAL,GAAoBA,wBAAwBnJ,KAAxB,GAAgCmJ,YAAhC,GAA+C,EAAnE;;AAEA,qBAAKC,MAAL,GAAcA,kBAAkBpJ,KAAlB,GAA0BoJ,MAA1B,GAAmC,EAAjD,CALJ,CAKyD;AACrD;AAEH;;;;uCAEM9O,M,EACP;AACI,6BAAKA,MAAL,GAAcA,MAAd;;AAEA,+BAAO,IAAP;AAEH;;;uCAEM8O,M,EACP;AACI,6BAAKA,MAAL,GAAcA,MAAd;;AAEA,+BAAO,IAAP;AAEH;;;6CAEYD,Y,EACb;AACI,6BAAKA,YAAL,GAAoBA,YAApB;;AAEA,+BAAO,IAAP;AAEH;;;0CAES/B,G,EACV;AACI,6BAAKpM,QAAL,GAAgBoM,GAAhB;;AAEA,+BAAO,IAAP;AAEH;;;0CAGD;AACI,6BAAKpM,QAAL;AACH;;;0CAGD;AACI;;AAEH;;;;;;AAGJ;;IAIKqO,S;AAEF,2BAAYC,cAAZ,EACA;AAAA;;AACI,oBAAG,CAACA,cAAD,YAA2BtJ,KAA9B,EACA;;AAEIvH,gCAAQC,IAAR,CAAa,4CAAb;;AAEA4Q,yCAAiB,EAAjB;AAEH;;AAEF,qBAAKC,WAAL,GAAmBD,cAAnB;AAEF;;;;8CAED;AACI;;AAEI,6BAAI,IAAI5U,IAAI,CAAZ,EAAeA,IAAI,KAAK6U,WAAL,CAAiB/T,MAApC,EAA4Cd,GAA5C,EACA;;AAEI,qCAAK6U,WAAL,CAAiB7U,CAAjB,EAAoBwT,OAApB;AAEH;AAER;;;oCACGsB,U,EACJ;;AAEI,6BAAKD,WAAL,CAAiBtO,IAAjB,CAAsBuO,UAAtB;AAEH;;;;;;AAGL;;AAEA;;;;;;;IAOMC,c;AAEF,kCAAc;AAAA;;AAEV,qBAAKC,UAAL,GAAkB,EAAlB;;AAEA,qBAAKC,SAAL,GAAiB,EAAjB;;AAEA,oBAAIC,mBAAmB,IAAvB;;AAEA,oBAAIC,UAAU,IAAd;;AAEA,qBAAKC,MAAL,GAAc,EAAd;;AAEAjJ,uBAAOkJ,WAAP,CAAmB,YAAY;;AAE3B,4BAAIC,MAAMC,UAAUC,WAAV,EAAV;;AAEAL,gCAAQG,GAAR,GAAcA,GAAd;;AAEA,6BAAI,IAAItV,IAAI,CAAZ,EAAeA,IAAIsV,IAAIxU,MAAvB,EAA+Bd,GAA/B,EAAoC;;AAEpC,oCAAIoV,SAASD,QAAQH,UAAR,CAAmBhV,CAAnB,IAAwBmV,QAAQH,UAAR,CAAmBhV,CAAnB,CAAxB,GAAgD,EAA7D;;AAECmV,wCAAQ3B,OAAR,CAAgB8B,IAAItV,CAAJ,CAAhB,EAAwBoV,MAAxB;AAEA;AAGJ,iBAfD,EAeG,EAfH;AAmBH;;;;2CAGD;;AAEI,+BAAQG,UAAUC,WAAV,EAAR;AAEH;;;iDAGgB;;AAEb,6BAAK,IAAIxV,IAAI,CAAb,EAAgBA,IAAI,KAAKiV,SAAL,CAAenU,MAAnC,EAA2Cd,GAA3C,EAAgD;;AAE5CmM,uCAAOsJ,aAAP,CAAqB,KAAKR,SAAL,CAAejV,CAAf,CAArB;AAEH;AAEJ;;;oDAGmB0V,c,EAAgB;;AAEhCvJ,+BAAOsJ,aAAP,CAAqB,KAAKR,SAAL,CAAeS,cAAf,CAArB;AAEH;;;4CAEW;AACR,+BAAO,iBAAiBH,SAAxB;AAEH;;;sCAEKvO,G,EAAK2O,Q,EAAUrP,Q,EAAU;AAC3B,+BAAO;;AAEHU,qCAAKA,GAFF,EAEO2O,UAASA,QAFhB,EAE0BrP,UAAUA;;AAFpC,yBAAP;AAOH;;;8CAGaT,I,EACd;;AAEI,4BAAI+P,KAAK,EAAT;;AAEAA,2BAAGC,UAAH,GAAgBhQ,KAAKgQ,UAAL,IAAmB,UAAS7V,CAAT,EAAYsF,CAAZ,EACnC;;AAEE;;AAED,yBALD;;AAQAsQ,2BAAGE,WAAH,GAAiBjQ,KAAKiQ,WAAL,IAAqB,UAAS9V,CAAT,EAAYsF,CAAZ,EACtC,CAEC,CAHD;;AAKAsQ,2BAAGG,OAAH,GAAa,EAAb;;AAEAH,2BAAGI,UAAH,GAAgB,UAASC,EAAT,EAAaC,EAAb,EAChB;;AAEI,oCAAIC,KAAKD,EAAT;;AAED,uCAAO,UAASlW,CAAT,EAAYsF,CAAZ,EAAc;;AAEhB4Q,2CAAGlW,CAAH,EAAMsF,CAAN;;AAED2Q,2CAAGjW,CAAH,EAAMsF,CAAN;AAEF,iCANF;AASF,yBAdD;;AAgBAsQ,2BAAGvM,EAAH,GAAQ,UAASrC,GAAT,EAAcV,QAAd,EACR;;AAEI,oCAAG,KAAKU,GAAL,KAAaA,QAAQ,IAAxB,EACA;;AAEI,4CAAIoP,aAAc,OAAO,KAAKpP,GAAL,CAAP,IAAqB,UAArB,GAAkC,KAAKA,GAAL,CAAlC,GAA8C,UAAShH,CAAT,EAAYsF,CAAZ,EAAc,CAAE,CAAhF;;AAED,6CAAK0B,GAAL,IAAY,KAAKgP,UAAL,CAAgB1P,QAAhB,EAA0B8P,UAA1B,CAAZ;AAGF,iCARD,MAUK,IAAGpP,IAAIc,OAAJ,CAAY,QAAZ,KAAyB,CAAzB,IAA8Bd,IAAIc,OAAJ,CAAY,GAAZ,KAAoB,CAArD,EACL;AACI,4CAAIuO,QAAQrP,IAAI6B,KAAJ,CAAU,GAAV,CAAZ;;AAEA,4CAAIyN,MAAJ;;AAEA,4CACA;;AAEIA,yDAASC,SAASF,MAAM,CAAN,CAAT,CAAT;;AAGA,oDAAID,aAAc,OAAO,KAAK,SAAL,EAAgBE,MAAhB,CAAP,IAAmC,UAAnC,GAAgD,KAAK,SAAL,EAAgBA,MAAhB,CAAhD,GAA0E,UAAStW,CAAT,EAAYsF,CAAZ,EAAc,CAAE,CAA5G;;AAEA,qDAAK,SAAL,EAAgBgR,MAAhB,IAA0B,KAAKN,UAAL,CAAgB1P,QAAhB,EAA0B8P,UAA1B,CAA1B;AAEH,yCAVD,CAWA,OAAO7L,CAAP,EACI;AACExG,wDAAQhD,KAAR,CAAc,qCAAqCiG,GAAnD;AAED;AAER;AAGJ,yBAvCD;;AAyCA,6BAAKgO,UAAL,CAAgBzO,IAAhB,CAAqBqP,EAArB;;AAEA,+BAAOA,EAAP;AAEH;;;wCAIOA,E,EAAIY,Q,EACZ;;AAEI,6BAAKC,eAAL,CAAqBb,EAArB,EAAyBY,QAAzB;;AAEA,6BAAKE,YAAL,CAAkBd,EAAlB,EAAsBY,QAAtB;AAEH;;;6CAGYZ,E,EAAIR,M,EACjB;;AAEI,4BAAG,CAACQ,EAAD,IAAO,CAACA,GAAG,MAAH,CAAX,EACA;;AAEI,uCAAO,KAAP;AAEH;;AAGD,6BAAK,IAAIzP,IAAI,CAAb,EAAgBA,IAAIyP,GAAGe,IAAH,CAAQ7V,MAA5B,EAAoCqF,KAAK,CAAzC,EAA4C;AACxC,oCAAIyQ,QAAQhB,GAAGe,IAAH,CAAQxQ,CAAR,CAAZ;AAAA,oCAAwB0Q,QAAQjB,GAAGe,IAAH,CAAQxQ,IAAI,CAAZ,CAAhC;;AAEA,oCAAIhD,KAAMV,KAAKqU,IAAL,CAAU3Q,IAAI,CAAd,IAAmB,CAA7B;AAAA,oCAAiCnG,IAAI4V,GAAGe,IAAH,CAAQxQ,CAAR,CAArC;AAAA,oCAAiDb,IAAIsQ,GAAGe,IAAH,CAAQxQ,IAAI,CAAZ,CAArD;;AAIA,oCAAGhD,MAAM,CAAN,IAAWiS,OAAOS,UAArB,EACA;AACIT,+CAAOS,UAAP,CAAkB7V,CAAlB,EAAqBsF,CAArB;AAEH;;AAED,oCAAGnC,MAAM,CAAN,IAAWiS,OAAOU,WAArB,EACA;AACIV,+CAAOU,WAAP,CAAmB9V,CAAnB,EAAsBsF,CAAtB;AAEH;;AAED,oCAAI,KAAK8P,MAAL,IAAe,KAAKA,MAAL,CAAY,WAAWjP,CAAvB,CAAf,IAA4C,OAAO,KAAKiP,MAAL,CAAY,WAAWjP,CAAvB,EAA0BG,QAAjC,IAA8C,UAA9F,EAA0G;AACtG,6CAAK8O,MAAL,CAAY,WAAWjP,CAAvB,EAA0BG,QAA1B;AAEH;AACJ;AAEJ;;;gDAGesP,E,EAAIR,M,EAAQ;;AAExB,4BAAG,CAACQ,EAAD,IAAO,CAACA,GAAG,SAAH,CAAX,EACA;AACK,uCAAO,KAAP;AAEJ;;AAED,6BAAK,IAAIzP,IAAI,CAAb,EAAgBA,IAAIyP,GAAGG,OAAH,CAAWjV,MAA/B,EAAuCqF,GAAvC,EAA4C;;AAExC,oCAAIyP,GAAGG,OAAH,CAAW5P,CAAX,EAAc4Q,OAAlB,EAA2B;;AAExB;;AAEK,4CAAI,OAAO3B,OAAOW,OAAP,CAAe5P,CAAf,CAAP,IAA6B,UAAjC,EAA6C;AACzCiP,uDAAOW,OAAP,CAAe5P,CAAf,EAAkByP,GAAGG,OAAH,CAAW5P,CAAX,EAAc4Q,OAAhC;AACH,yCAFD,MAGK,IAAI,QAAQ3B,OAAOW,OAAP,CAAe5P,CAAf,CAAR,KAA8B,QAA9B,IAA0C,OAAOiP,OAAOW,OAAP,CAAe5P,CAAf,EAAkB7B,MAAzB,IAAoC,UAAlF,EAA8F;AAC/F8Q,uDAAOW,OAAP,CAAe5P,CAAf,EAAkB7B,MAAlB,CAAyB8Q,OAAOW,OAAP,CAAe5P,CAAf,EAAkB4Q,OAA3C;AAEH;;AAEL,4CAAIC,cAAc,KAAK5B,MAAL,IAAe,KAAKA,MAAL,CAAYjP,CAAZ,CAAjC;AAAA,4CAAiD8Q,GAAjD;AAAA,4CAAsDC,OAAO,YAAY/Q,CAAzE;;AAEA,4CAAI6Q,WAAJ,EAAiB;AACbC,sDAAM,KAAK7B,MAAL,CAAY8B,IAAZ,KAAqB,CAACtT,MAAM,KAAKwR,MAAL,CAAY8B,IAAZ,EAAkBvB,QAAxB,CAAtB,GAA0D,KAAKwB,QAAL,CAAc,KAAK/B,MAAL,CAAY8B,IAAZ,EAAkBvB,QAAhC,CAA1D,GAAsG,KAAKP,MAAL,CAAY8B,IAAZ,EAAkBvB,QAA9H;AACH;AACD;;AAEA,4CAAIqB,eAAeC,GAAf,IAAsB,OAAO,KAAK7B,MAAL,CAAY8B,IAAZ,EAAkB5Q,QAAzB,IAAsC,UAAhE,EAA4E;AACxE;AACA,qDAAK8O,MAAL,CAAYjP,CAAZ,EAAeG,QAAf;AAEH;AAEJ;AAGJ;AAIJ;;;mCAGEU,G,EAAKoQ,I,EAAM9Q,Q,EAAU;;AAEpB,4BAAG8Q,QAAQ,KAAKpC,UAAL,CAAgBlU,MAA3B,EACA;;AAEI,qCAAKkU,UAAL,CAAgBzO,IAAhB,CAAqB,KAAK8Q,aAAL,CAAmB,EAAnB,CAArB;AAEH;;AAED,6BAAKrC,UAAL,CAAgBoC,IAAhB,EAAsB/N,EAAtB,CAAyBrC,GAAzB,EAA8BV,QAA9B;AAEH;;;;;;AAGJ;;AAKD,IAAG,CAACK,eAAeoO,cAAnB,EACA;AACIpO,uBAAeoO,cAAf,GAAgC,IAAIA,cAAJ,EAAhC;;AAEApO,uBAAewQ,QAAf,GAA0B,EAA1B;;AAEAjT,kBAAU6Q,cAAV,GAA2BpO,eAAeoO,cAA1C;;AAEA7Q,kBAAUiT,QAAV,GAAqBxQ,eAAewQ,QAApC;;AAEAjT,kBAAU6Q,cAAV,CAAyB1L,EAAzB,CAA4B,YAA5B,EAA0C,CAA1C,EAA6C,UAASrJ,CAAT,EAAYsF,CAAZ,EAAc;;AAEvDvB,wBAAQI,GAAR,CAAY,oBAAZ;AAEH,SAJD;;AAMAD,kBAAU6Q,cAAV,CAAyB1L,EAAzB,CAA4B,UAA5B,EAAwC,CAAxC,EAA2C,UAASrJ,CAAT,EAAYsF,CAAZ,EAAc;;AAErDvB,wBAAQI,GAAR,CAAY,kBAAZ;AAEH,SAJD;;AAOAD,kBAAU6Q,cAAV,CAAyB1L,EAAzB,CAA4B,UAA5B,EAAwC,CAAxC,EAA2C,UAASrJ,CAAT,EAAYsF,CAAZ,EAAc;;AAErDvB,wBAAQI,GAAR,CAAY,kBAAZ;AAEH,SAJD;;AAMAD,kBAAU6Q,cAAV,CAAyB1L,EAAzB,CAA4B,UAA5B,EAAwC,CAAxC,EAA2C,UAASrJ,CAAT,EAAYsF,CAAZ,EAAc;;AAErDvB,wBAAQI,GAAR,CAAY,kBAAZ;AAEH,SAJD;;AAMAD,kBAAU6Q,cAAV,CAAyB1L,EAAzB,CAA4B,UAA5B,EAAwC,CAAxC,EAA2C,UAASrJ,CAAT,EAAYsF,CAAZ,EAAc;;AAErDvB,wBAAQI,GAAR,CAAY,kBAAZ;AAEH,SAJD;;AAMD;AAEF;;AAID,C,CAAC;;;;;IAIKmT,a,GAEF,yBACA;AAAA;AAEC,C;;IAICC,Q,GACF,kBAAY1R,IAAZ,EAAkB;AAAA;AAEjB,C;;IAGC2R,gB,GACF,0BAAY3R,IAAZ,EAAkB;AAAA;AAEjB,C;;AAYL,C,CAAC;;;;;IAKK4R,M;AACF,wBAAY5R,IAAZ,EAAkB;AAAA;;AAEd,qBAAKkB,MAAL,GAAcO,GAAGP,MAAjB;;AAEA,qBAAK2Q,QAAL,GAAgB,KAAK3Q,MAAL,CAAYlB,IAAZ,EAAkB,UAAlB,EAA8B,KAAKkB,MAAL,CAAYlB,IAAZ,EAAkB,WAAlB,EAA+B,KAA/B,CAA9B,CAAhB;;AAEA,qBAAK8R,UAAL,GAAkB,KAAKC,YAAL,EAAlB,CANc,CAMyB;;AAEvC,qBAAKC,SAAL,GAAiBhS,KAAKgS,SAAL,IAAkBhS,KAAKiS,SAAvB,IAAoC,SAArD,CARc,CAQkD;;AAEhE,qBAAK1F,KAAL,GAAa,KAAKrL,MAAL,CAAYlB,IAAZ,EAAkB,OAAlB,EAA2BxB,MAAMgO,MAAN,CAAa0F,SAAb,CAAuBC,KAAlD,CAAb;;AAEA,qBAAKC,cAAL,GAAsB,KAAKlR,MAAL,CAAYlB,IAAZ,EAAkB,gBAAlB,EAAoC,CAApC,CAAtB;;AAEA,qBAAKyJ,IAAL,GAAY,KAAKvI,MAAL,CAAYlB,IAAZ,EAAkB,MAAlB,EAA0B,IAA1B,CAAZ;;AAEA,qBAAKyK,WAAL,GAAmB,KAAKvJ,MAAL,CAAYlB,IAAZ,EAAkB,aAAlB,EAAiC,KAAjC,CAAnB;;AAEA,qBAAKqS,WAAL,GAAmB,KAAKC,cAAL,EAAnB,CAlBc,CAkB4B;;AAE1C,qBAAKC,QAAL,CAAc,KAAKF,WAAnB;;AAEA,qBAAKG,IAAL,GAAY,KAAKtR,MAAL,CAAYlB,IAAZ,EAAkB,MAAlB,EAA0B,KAA1B,CAAZ;;AAEA,qBAAKsL,QAAL,GAAgB,KAAKpK,MAAL,CAAYlB,IAAZ,EAAkB,UAAlB,EAA8B,GAA9B,CAAhB;;AAEA,qBAAK4K,KAAL,GAAa,KAAK1J,MAAL,CAAYlB,IAAZ,EAAkB,OAAlB,EAA2B,CAA3B,CAAb;;AAEA,qBAAKsL,QAAL,GAAgB,KAAKpK,MAAL,CAAYlB,IAAZ,EAAkB,UAAlB,EAA8B,KAA9B,CAAhB;AAGH;;;;+CAGc;;AAEX,4BAAItD,IAAI,EAAR;;AAEA2B,kCAAUjB,IAAV,CAAeoB,MAAMgO,MAArB,EAA6B,UAAUlP,EAAV,EAAcgP,MAAd,EAAsB;;AAE/CjO,0CAAUjB,IAAV,CAAekP,MAAf,EAAuB,UAAU8B,EAAV,EAAcqE,QAAd,EAAwB;;AAE3C,4CAAI,CAAC,IAAD,EAAO,KAAP,EAAc,OAAd,EAAuBxQ,OAAvB,CAA+BmM,GAAGvL,WAAH,EAA/B,KAAoD,CAAxD,EAA2D;;AAEvDnG,kDAAEgE,IAAF,CAAOpD,KAAK,GAAL,GAAW8Q,EAAlB;AAEH;AAEJ,iCARD;AAUH,yBAZD;;AAcA,+BAAO1R,CAAP;AAEH;;;iDAGgB;;AAEb,4BAAIO,SAAS,IAAb;;AAEA,4BAAIP,CAAJ;;AAEAS,0BAAEC,IAAF,CAAOoB,MAAMgO,MAAb,EAAqB,UAAUlP,EAAV,EAAcgP,MAAd,EAAsB;;AAEvCnP,kCAAEC,IAAF,CAAOoB,MAAMgO,MAAN,CAAalP,EAAb,CAAP,EAAyB,UAAU8Q,EAAV,EAAcqE,QAAd,EAAwB;;AAG7C,4CAAIxV,OAAOsP,KAAP,IAAgB/N,MAAMgO,MAAN,CAAalP,EAAb,EAAiB8Q,EAAjB,CAApB,EAA0C;;AAEtC1R,oDAAIY,KAAK,GAAL,GAAW8Q,EAAf;AAEH;AAEJ,iCATD;AAWH,yBAbD;;AAeA,+BAAO1R,CAAP;AAEH;;;yCAGQA,C,EAAG;;AAER,4BAAIgW,MAAMhW,EAAEsG,KAAF,CAAQ,GAAR,CAAV;;AAEA,4BAAI2P,KAAKD,IAAI,CAAJ,CAAT;AAAA,4BAAiBE,KAAKF,IAAI,CAAJ,CAAtB;;AAGA,4BAAInG,QAAQ/N,MAAMgO,MAAN,CAAa0F,SAAb,CAAuBC,KAAnC;;AAGAhV,0BAAEC,IAAF,CAAOoB,MAAMgO,MAAb,EAAqB,UAAUlP,EAAV,EAAcgP,MAAd,EAAsB;;AAEvCnP,kCAAEC,IAAF,CAAOoB,MAAMgO,MAAN,CAAalP,EAAb,CAAP,EAAyB,UAAU8Q,EAAV,EAAcqE,QAAd,EAAwB;;AAG7C,4CAAInV,MAAMqV,EAAN,IAAYvE,MAAMwE,EAAtB,EAA0B;;AAEtB;;AAEArG,wDAAQ/N,MAAMgO,MAAN,CAAalP,EAAb,EAAiB8Q,EAAjB,CAAR;AAEH;AAEJ,iCAXD;AAaH,yBAfD;;AAiBA,6BAAK7B,KAAL,GAAaA,KAAb;;AAGA,+BAAOA,KAAP;AAEH;;;yCAEQ;;AAEL,4BAAIsG,SAAS,EAAb;;AAEA;;AAEA,4BAAI5V,SAAS,IAAb;;AAGA,4BAAI6V,UAAU,EAAd;;AAEA3V,0BAAEC,IAAF,CAAOwJ,KAAKvJ,OAAZ,EAAqB,UAAUC,EAAV,EAAcC,IAAd,EAAoB;;AAErC,oCAAIA,KAAKiM,EAAL,IAAWvM,OAAO+U,SAAtB,EAAiC;;AAE7Bc,gDAAQxV,EAAR,IAAcC,IAAd;AAEH;AACJ,yBAPD;;AAUA,4BAAIwV,SAAS;;AAET5Y,mCAAG8C,OAAO4U,QAAP,CAAgB1X,CAAhB,GAAoB2Y,QAAQ,CAAR,EAAWvT,QAAX,CAAoBpF,CAFlC;AAGTsF,mCAAGxC,OAAO4U,QAAP,CAAgBpS,CAAhB,GAAoBqT,QAAQ,CAAR,EAAWvT,QAAX,CAAoBE,CAHlC;AAIT6I,mCAAGrL,OAAO4U,QAAP,CAAgBvJ,CAAhB,GAAoBwK,QAAQ,CAAR,EAAWvT,QAAX,CAAoB+I;;AAJlC,yBAAb;;AAQA,4BAAIrL,OAAOmV,cAAP,GAAwB,CAAxB,IAA6BnV,OAAOmV,cAAP,GAAwB,CAAzD,EAA4D;;AAGxD,oCAAIY,UAAU/V,OAAOmV,cAAP,GAAwBU,QAAQ,CAAR,EAAWnK,QAAX,CAAoBxO,CAA1D;;AAEA;AACA0Y,uCAAO,CAAP,IAAY,IAAIrU,MAAM6N,KAAV,CAAgByG,QAAQ,CAAR,EAAWnK,QAA3B,EACP2D,MADO,CACArP,OAAOsP,KAAP,IAAgB/N,MAAMgO,MAAN,CAAayG,OAAb,CAAqBd,KADrC,EAGPxF,EAHO,CAGJ,EAACxS,GAAG6Y,OAAJ,EAHI,EAGU/V,OAAOqO,QAHjB,EAIPhC,QAJO,CAIE,YAAY;AAClB;;;AAGH,iCARO,EASPjJ,UATO,CASI,YAAY;AACpB;AACA,4CAAIpD,OAAOkP,QAAX,EAAqB;;AAEjBlP,uDAAOkP,QAAP;AAEH;AAGJ,iCAlBO,CAAZ;AAqBH;;AAED;AACA0G,+BAAOnS,IAAP,CAAY,IAAIlC,MAAM6N,KAAV,CAAgByG,QAAQ,CAAR,EAAWvT,QAA3B,EACP+M,MADO,CACArP,OAAOsP,KAAP,IAAgB/N,MAAMgO,MAAN,CAAayG,OAAb,CAAqBd,KADrC,EAGPxF,EAHO,CAGJoG,MAHI,EAGI9V,OAAOqO,QAHX,EAIPhC,QAJO,CAIE,YAAY;AAClB;;;AAGH,yBARO,EASPjJ,UATO,CASI,YAAY;AACpB;;AAEA,oCAAIpD,OAAOkP,QAAX,EAAqB;;AAEjBlP,+CAAOkP,QAAP;AAEH;AAGJ,yBAnBO,CAAZ;;AAsBAlP,+BAAO2N,KAAP,GAAe,CAAC7M,MAAMd,OAAO2N,KAAb,CAAD,IAAwB3N,OAAO2N,KAAP,GAAe,CAAvC,GAA2C3N,OAAO2N,KAAlD,GAA0D,CAAzE;;AAGA,+BAAO;;AAEHiI,wCAAQA,MAFL;;AAIHjI,uCAAO3N,OAAO2N,KAJX;;AAMH6C,sCAAM,gBAAY;;AAEd,4CAAIyF,gBAAgB,IAApB;;AAEA5M,+CAAO6M,UAAP,CAAkB,YAAY;;AAE1B,qDAAK,IAAIhZ,IAAI,CAAb,EAAgBA,IAAI+Y,cAAcL,MAAd,CAAqB5X,MAAzC,EAAiDd,GAAjD,EAAsD;;AAElD+Y,sEAAcL,MAAd,CAAqB1Y,CAArB,EAAwB+E,KAAxB;AAEH;AAEJ,yCARD,EAQG,KAAK0L,KARR;AAUH;;AApBE,yBAAP;AAwBH;;;wCAEO;AACJ,6BAAKsB,MAAL,GAAcuB,IAAd;AAEH;;;2CAGUZ,G,EAAK;AACZ,6BAAKV,QAAL,GAAgBU,GAAhB;AAEH;;AAED;;;;+CAEgBuG,C,EAAGC,C,EAAG3W,C,EAAG;;AAErB,4BAAIoC,SAASlE,SAASC,aAAT,CAAuB,QAAvB,CAAb;;AAEAiE,+BAAO0K,EAAP,GAAY,eAAZ;;AAEA1K,+BAAOC,KAAP,GAAe,GAAf;AACAD,+BAAOE,MAAP,GAAgB,GAAhB;;AAGA,4BAAIsU,UAAUxU,OAAOqK,UAAP,CAAkB,IAAlB,CAAd;AACAmK,gCAAQC,SAAR,GAAoB,kBAApB;AACAD,gCAAQE,QAAR,CAAiB,CAAjB,EAAoB,CAApB,EAAuB,GAAvB,EAA4B,GAA5B;;AAEAF,gCAAQG,SAAR,GAAoB,GAApB;AACAH,gCAAQI,WAAR,GAAsB,kBAAtB;;AAEAJ,gCAAQK,SAAR;AACAL,gCAAQM,MAAR,CAAe,CAAf,EAAkB,EAAlB;AACAN,gCAAQO,MAAR,CAAe,GAAf,EAAoB,EAApB;AACAP,gCAAQM,MAAR,CAAe,CAAf,EAAkB,EAAlB;AACAN,gCAAQO,MAAR,CAAe,GAAf,EAAoB,EAApB;AACAP,gCAAQQ,SAAR;AACAR,gCAAQS,MAAR;;AAEAT,gCAAQG,SAAR,GAAoB,CAApB;AACAH,gCAAQI,WAAR,GAAsB,kBAAtB;;AAEA,4BAAInU,WAAW,EAACpF,GAAG,CAAJ,EAAOsF,GAAG,EAAV,EAAf;AACA,4BAAIuU,eAAe,EAAC7Z,GAAG,CAAJ,EAAOsF,GAAG,EAAV,EAAnB;;AAEA,4BAAIjB,MAAM6N,KAAV,CAAgB9M,QAAhB,EAA0BoN,EAA1B,CAA6B,EAACxS,GAAG,GAAJ,EAA7B,EAAuC,IAAvC,EAA6CmS,MAA7C,CAAoD9N,MAAMgO,MAAN,CAAaC,MAAb,CAAoBC,IAAxE,EAA8ExN,KAA9E;AACA,4BAAIV,MAAM6N,KAAV,CAAgB9M,QAAhB,EAA0BoN,EAA1B,CAA6B,EAAClN,GAAG,EAAJ,EAA7B,EAAsC,IAAtC,EAA4C6M,MAA5C,CAAmD+G,CAAnD,EAAsD/J,QAAtD,CAA+D,YAAY;;AAEvEgK,wCAAQK,SAAR;AACAL,wCAAQM,MAAR,CAAeI,aAAa7Z,CAA5B,EAA+B6Z,aAAavU,CAA5C;AACA6T,wCAAQO,MAAR,CAAetU,SAASpF,CAAxB,EAA2BoF,SAASE,CAApC;AACA6T,wCAAQQ,SAAR;AACAR,wCAAQS,MAAR;;AAEAC,6CAAa7Z,CAAb,GAAiBoF,SAASpF,CAA1B;AACA6Z,6CAAavU,CAAb,GAAiBF,SAASE,CAA1B;AAEH,yBAXD,EAWGP,KAXH;;AAaA,+BAAOJ,MAAP;AACH;;;;;;AAWL,C,CAAC;;;;IAKKmV,S,GAEF,mBAAYnI,GAAZ,EAAiBC,GAAjB,EAAsB;AAAA;;AAElB,aAAKD,GAAL,GAAWA,GAAX;AACA,aAAKC,GAAL,GAAWA,GAAX;AAEH,C;;AAIL;;AAEA,IAAImI,eAAeD,SAAnB;;IAEMlJ,iB;;;AAEF,mCAAYe,GAAZ,EAAiBC,GAAjB,EAAsBC,SAAtB,EAAiC;AAAA;;AAAA,kJAEvBF,GAFuB,EAElBC,GAFkB;;AAI7B,sBAAKC,SAAL,GAAiBA,aAAa,IAAI3C,OAAJ,CAAY,MAAK0C,GAAL,CAAS5R,CAArB,EAAwB,MAAK4R,GAAL,CAAStM,CAAjC,EAAoC,MAAKsM,GAAL,CAASzD,CAA7C,CAA9B;;AAJ6B;AAMhC;;;EAR2B2L,S;;AAYhC;;IAEME,M,GAEF,gBAAYnU,IAAZ,EAAkB;AAAA;;AAEd,aAAKT,QAAL,GAAgB,KAAK2B,MAAL,CAAYlB,IAAZ,EAAkB,UAAlB,EAA8B,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAA9B,CAAhB;;AAEA,aAAK+K,MAAL,GAAc,KAAKC,OAAL,CAAarU,IAAb,EAAmB,QAAnB,EAA6B,GAA7B,CAAd;AAEH,C;;AAKL;IAAOsU,M;AACH,wBAAY7K,IAAZ,EAAkBgB,WAAlB,EAA+BzK,IAA/B,EAAqC;AAAA;;AAEjC,qBAAK0G,MAAL,GAAc,IAAd,CAFiC,CAEb;;AAEpB,oBAAI,QAAO+C,IAAP,yCAAOA,IAAP,MAAe,QAAnB,EAA6B;AAC7B;AACIzJ,uCAAOyJ,IAAP;;AAEA,qCAAKA,IAAL,GAAYzJ,KAAKyJ,IAAL,IAAa,IAAzB;;AAEA,qCAAKgB,WAAL,GAAmBzK,KAAKyK,WAAL,IAAoB,IAAvC;AAEH,yBARD,MASK;;AAED,6BAAKhB,IAAL,GAAYA,QAAQ,IAApB;;AAEA,6BAAKgB,WAAL,GAAmBA,eAAe,IAAlC;AAEH;;AAED,qBAAK8J,cAAL,GAAsBrU,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,gBAAzB,EAA2C,EAA3C,CAAtB;;AAEA,oBAAIwU,OAAO,IAAX;;AAEAjT,uBAAOnE,IAAP,CAAY4C,IAAZ,EAAkB,UAAU1C,EAAV,EAAcC,IAAd,EAAoB;AAAE;;AAEpC,4BAAID,OAAO,QAAX,EAAqB;AACjBkX,qCAAKlX,EAAL,IAAWC,IAAX;AACH;AAEJ,iBAND;;AAQA,qBAAKoN,IAAL,GAAYzK,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,MAAzB,EAAiC,OAAjC,CAAZ;;AAEA,qBAAKrC,UAAL,GAAkBuC,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,YAAzB,EAAuC,EAAvC,CAAlB;;AAEA,qBAAKyU,OAAL,GAAevU,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,SAAzB,EAAoC,EAApC,CAAf;;AAEA,oBAAI/C,SAAS,IAAb;;AAEA,qBAAKuM,EAAL,GAAUtJ,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,IAAzB,EAA+B,KAAK7D,SAAL,EAA/B,CAAV;;AAEA,qBAAKsB,MAAL,GAAcyC,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,QAAzB,EAAmC,EAAnC,CAAd;;AAEA,qBAAKrF,KAAL,GAAauF,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,OAAzB,EAAkC,IAAIxF,SAAJ,CAAc0F,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,KAAzB,EAAgC,KAAhC,CAAd,CAAlC,CAAb;;AAEA,qBAAKR,IAAL,GAAYU,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,MAAzB,EAAiC,IAAIqJ,OAAJ,CAAY,GAAZ,EAAiB,GAAjB,CAAjC,CAAZ;;AAEA,qBAAK9J,QAAL,GAAgBW,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,UAAzB,EAAqC,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAArC,CAAhB;;AAEA,qBAAKqL,gBAAL,GAAwBxU,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,kBAAzB,EAA6C,IAAIkU,YAAJ,CAAiB,IAAI7K,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAjB,EAAuC,IAAIA,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAvC,CAA7C,CAAxB;;AAEA,qBAAKV,QAAL,GAAgBzI,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,UAAzB,EAAqC,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAArC,CAAhB;;AAEA,qBAAKlB,kBAAL,GAA0B,EAA1B;;AAEA,qBAAKwM,KAAL,GAAazU,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,OAAzB,EAAkC,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAlC,CAAb;;AAEA,qBAAKuL,YAAL,GAAoB1U,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,cAAzB,EAAyC,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAzC,CAApB;;AAEA,qBAAKwL,SAAL,GAAiB3U,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,WAAzB,EAAsC,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAtC,CAAjB;;AAEA,qBAAKyL,SAAL,GAAiB5U,YAAYgB,MAAZ,CAAmBlB,IAAnB,EAAyB,WAAzB,EAAsC,IAAIqJ,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAtC,CAAjB;;AAEA;;AAEAlM,kBAAEC,IAAF,CAAO,KAAKK,MAAZ,EAAoB,UAAUH,EAAV,EAAcC,IAAd,EAAoB;;AAEpCN,+BAAOQ,MAAP,CAAcH,EAAd,IAAoB,IAAIrD,KAAJ,CAAUsD,IAAV,CAApB;AAEH,iBAJD;;AAMAJ,kBAAEC,IAAF,CAAO,KAAKqX,OAAZ,EAAqB,UAAUnX,EAAV,EAAcC,IAAd,EAAoB;;AAErCN,+BAAOwX,OAAP,CAAenX,EAAf,IAAqB,IAAIsU,MAAJ,CAAWrU,IAAX,CAArB;AAEH,iBAJD;;AAOAJ,kBAAEC,IAAF,CAAO,KAAKO,UAAZ,EAAwB,UAAUL,EAAV,EAAcC,IAAd,EAAoB;;AAExCN,+BAAOU,UAAP,CAAkBL,EAAlB,IAAwB,IAAIiN,SAAJ,CAAchN,IAAd,CAAxB;AAEH,iBAJD;;AAOA;;AAEAJ,kBAAEC,IAAF,CAAO,KAAKmX,cAAZ,EAA4B,UAASjX,EAAT,EAAaC,IAAb,EAAkB;;AAE1CN,+BAAO8X,MAAP,CAAcxX,IAAd;AAEH,iBAJD;;AAMA,qBAAK4K,kBAAL,GAA0B,KAAKxK,UAAL,CAAgB,CAAhB,KAAsB,IAAI4M,SAAJ,EAAhD;AAEH;;;;uCAGM,CAGN;;;uCAEMsC,G,EAAK;;AAER,4BAAI,OAAOA,GAAP,IAAc,QAAlB,EAA4B;;AAEzB,oCAAG,KAAK0H,cAAL,CAAoBtS,OAApB,CAA4B4K,GAA5B,IAAmC,CAAtC,EAAwC;AAAE,6CAAK0H,cAAL,CAAoB7T,IAApB,CAAyBmM,GAAzB;AAA+B;;AAExE,oCAAI5P,SAAS,IAAb;;AAEA,oCAAIgD,OAAO4M,IAAI7J,KAAJ,CAAU,GAAV,CAAX;;AAEA9E,wCAAQI,GAAR,CAAY,8BAA8BuO,GAA1C;;AAEA,oCAAG,CAAC5M,KAAKhF,MAAN,IAAgB,CAAnB,EACA;AACI,+CAAOiD,QAAQhD,KAAR,CAAc,yCAAd,CAAP;AACH;;AAED,oCAAImY,IAAI9R,OAAOyT,OAAP,CAAeC,kBAAf,CAAkChV,KAAK,CAAL,CAAlC,EAA2CA,KAAK,CAAL,CAA3C,CAAR;;AAEA,oCAAG,OAAOoT,CAAP,IAAa,UAAhB,EACA;AACI6B,8CAAM,YAAN;;AAGAjY,+CAAOgE,IAAP,GAAgBhE,OAAOkT,UAAP,CAAkBkD,CAAlB,EAAqBpW,OAAOgE,IAA5B,CAAhB;AAEH;AAGJ,yBA3BD,MA6BK,IAAI,OAAO4L,GAAP,IAAc,UAAlB,EAA8B;;AAE/B3O,wCAAQI,GAAR,CAAY,iBAAZ;;AAEArB,uCAAOkT,UAAP,CAAkBgF,WAAlB,EAA+B,KAAKlU,IAApC;AAGH,yBAPI,MASA,IAAI,QAAO4L,GAAP,yCAAOA,GAAP,MAAc,QAAlB,EAA4B;;AAE7B3O,wCAAQI,GAAR,CAAY,iBAAZ;;AAEDJ,wCAAQC,IAAR,CAAa,iEAAb;AAEF;AAEJ;;AAED;;;;;;yCAIS;AACL,+BAAO,KAAKqL,EAAZ;AACH;;;8CAEahK,I,EAAM4V,S,EAAW;AAC3B,6BAAKC,SAAL,GAAiB,IAAIhM,OAAJ,CAAY7J,QAAQ,KAAKA,IAAzB,CAAjB;;AAEA,6BAAKqJ,SAAL,GAAiB,IAAIQ,OAAJ,CAAY+L,aAAa,KAAK5V,IAA9B,CAAjB;;AAEA,+BAAO,IAAP;AAEH;;AAED;;;;;;4CAIY;;AAER,+BAAO8B,QAAQnF,SAAR,EAAP;AAEH;;;wCAEOqD,I,EAAM;AACV,6BAAKA,IAAL,GAAY,IAAI6J,OAAJ,CAAY7J,KAAKrF,CAAjB,EAAoBqF,KAAKC,CAAzB,EAA4BD,KAAK8I,CAAjC,CAAZ;;AAEA,6BAAKH,kBAAL,CAAwB3I,IAAxB,GAA+B,IAAI6J,OAAJ,CAAY7J,KAAKrF,CAAjB,EAAoBqF,KAAKC,CAAzB,EAA4BD,KAAK8I,CAAjC,CAA/B;AAEH;;;uCAEM9C,G,EAAK;AACR,6BAAKjG,QAAL,GAAgB,IAAI8J,OAAJ,CAAY7D,IAAIrL,CAAhB,EAAmBqL,IAAI/F,CAAvB,EAA0B+F,IAAI8C,CAAJ,IAAS,CAAnC,CAAhB;AAEH;;AAED;;;;;;;8CAKc;AACV,4BAAI,CAAC,KAAKqM,KAAV,EAAiB;;AAEb,qCAAKA,KAAL,GAAa,IAAItL,OAAJ,CAAY,CAAZ,EAAe,CAAf,EAAkB,CAAlB,CAAb;AAEH;AAEJ;;AAED;;;;;;;6CAKaiM,K,EAAO;;AAEhB,4BAAGA,iBAAiB/K,SAAjB,IAA8B,KAAK5M,UAAL,CAAgBsE,OAAhB,CAAwBqT,KAAxB,IAAiC,CAAlE,EACA;AACI,qCAAK3X,UAAL,CAAgB+C,IAAhB,CAAqB4U,KAArB;AACH;;AAED,6BAAKnN,kBAAL,GAA0BmN,KAA1B;;AAEA/T,+BAAOjD,GAAP,CAAW,4BAAX;;AAEA,+BAAO,IAAP;AAEH;;AAED;;;;;;;;iDAMiBgX,K,EAAO;;AAEpB,6BAAK3X,UAAL,CAAgB,SAAhB,IAA6B2X,KAA7B;;AAEA/T,+BAAOjD,GAAP,CAAW,4BAAX;;AAEA,+BAAO,IAAP;AAEH;;AAED;;;;;;;;;yCAOSiX,C,EAAGC,C,EAAG;AACX,+BAAO,KAAKjW,QAAL,CAAcpF,CAAd,GAAkB,KAAKqF,IAAL,CAAUrF,CAA5B,IAAiC,CAAjC,IAAsC,KAAKoF,QAAL,CAAcpF,CAAd,GAAkBob,CAAxD,IACA,KAAKhW,QAAL,CAAcE,CAAd,GAAkB,KAAKD,IAAL,CAAUC,CAA5B,IAAiC,CADjC,IACsC,KAAKF,QAAL,CAAcE,CAAd,GAAkB+V,CAD/D;AAGH;;AAED;;;;AAIA;;;;;;;uCAKO/O,M,EAAQ,CACd;;AAED;;;;;;;;2CAMWA,M,EAAQ;;AAEf,6BAAK,IAAItM,CAAT,IAAc,KAAKwa,KAAnB,EAA0B;;AAEtB,oCAAI,KAAKA,KAAL,CAAWxa,CAAX,IAAgB,CAAhB,IAAqB,KAAKwa,KAAL,CAAWxa,CAAX,IAAgB,CAAzC,EAA4C;;AAExC,6CAAKoF,QAAL,CAAcpF,CAAd,KAAoB,KAAKwa,KAAL,CAAWxa,CAAX,CAApB;AAEH;AAEJ;;AAED,6BAAK,IAAIA,CAAT,IAAc,KAAKya,YAAnB,EAAiC;;AAE7B,oCAAI,KAAKA,YAAL,CAAkBza,CAAlB,IAAuB,CAAvB,IAA4B,KAAKya,YAAL,CAAkBza,CAAlB,IAAuB,CAAvD,EAA0D;;AAEtD,6CAAKwa,KAAL,CAAWxa,CAAX,KAAiB,KAAKya,YAAL,CAAkBza,CAAlB,CAAjB;AAEH;AAEJ;;AAED,6BAAK,IAAIA,CAAT,IAAc,KAAK0a,SAAnB,EAA8B;;AAE1B,oCAAI,KAAKA,SAAL,CAAe1a,CAAf,IAAoB,CAApB,IAAyB,KAAK0a,SAAL,CAAe1a,CAAf,IAAoB,CAAjD,EAAoD;;AAEhD,6CAAKwO,QAAL,CAAcxO,CAAd,KAAoB,KAAK0a,SAAL,CAAe1a,CAAf,CAApB;AAEH;AAGJ;;AAED,6BAAK,IAAIA,CAAT,IAAc,KAAK2a,SAAnB,EAA8B;;AAG1B,oCAAI,KAAKA,SAAL,CAAe3a,CAAf,IAAoB,CAApB,IAAyB,KAAK2a,SAAL,CAAe3a,CAAf,IAAoB,CAAjD,EAAoD;;AAEhD,6CAAK0a,SAAL,CAAe1a,CAAf,KAAqB,KAAK2a,SAAL,CAAe3a,CAAf,CAArB;AAEH;AACJ;AACJ;;;8DAE6Bsb,U,EAAYC,U,EAAYC,G,EAAKlV,Q,EAAU;;AAEjEA,iCAAS,OAAOkV,IAAIF,UAAJ,EAAgBC,UAAhB,CAAP,IAAsC,UAAtC,GAAmDC,IAAIF,UAAJ,EAAgBC,UAAhB,CAAnD,GAAiF,EAA1F;AAEH;;;2CAGU7I,G,EAAK+I,Y,EAAc;;AAE1B1X,gCAAQI,GAAR,CAAY,gBAAZ;;AAEA,4BAAIuX,KAAKD,YAAT;;AAEA,4BAAI3Y,SAAS,IAAb;;AAED,+BAAO,YAAY;;AAGd4Y,mCAAG5Y,MAAH;;AAEA;;AAED4P,oCAAI5P,MAAJ;AAIF,yBAXF;AAaF;;AAGD;;;;;;;;yCAMS4P,G,EAAK;AACVA,8BAAMA,OAAO,YAAY,CACpB,CADL;;AAGA,4BAAIpO,SAAS,KAAKA,MAAlB;;AAEA,4BAAIxB,SAAS,IAAb;;AAEA,6BAAKwB,MAAL,GAAc,UAAUxB,MAAV,EAAkB;AAC5BwB,uCAAOxB,MAAP;AACA4P,oCAAI5P,MAAJ;AACH,yBAHD;AAKH;;AAGD;;;;;;;;;;oDAQoBwJ,M,EAAQ;;AAExB,+BAAOlF,OAAOpC,SAAP,CAAiBC,uBAAjB,CAAyCqH,MAAzC,CAAP;AAEH;;AAED;;;;;;;;;iDAOiBA,M,EAAQ;;AAErB,+BAAOvI,QAAQC,IAAR,CAAa,+DAAb,CAAP;AAEH;;AAED;;;;;;;;;sCAOM6W,O,EAAS;AACX;;AAEA,6BAAKc,QAAL,GAAgB,OAAhB;;AAEA,4BAAIC,SAASf,QAAQe,MAAR,IAAkBf,QAAQgB,WAA1B,IAAyC,KAAtD;;AAEA,4BAAIC,QAAQjB,QAAQiB,KAAR,IAAiBjB,QAAQkB,YAAzB,IAAyClB,QAAQmB,aAAjD,IAAkE,KAA9E;;AAEA,4BAAIC,YAAYpB,QAAQqB,MAAR,IAAkBrB,QAAQoB,SAA1B,IAAuC,KAAvD;;AAEA,4BAAI9K,WAAW0J,QAAQ1J,QAAR,IAAoB0J,QAAQsB,cAA5B,IAA8C,KAA7D;;AAEA,4BAAI3B,QAAQK,QAAQL,KAAR,IAAiB,KAA7B;;AAEA,4BAAI7T,eAAeC,QAAnB,EAA6B,CAG5B,CAHD,MAIK;;AAED,qCAAKwV,SAAL,CAAe,KAAKT,QAApB,EAA8B,GAA9B,EAAmCd,OAAnC;AAEH;;AAED,+BAAO,IAAP;AAEH;;AAED;;;;;;;wCAKQoB,S,EAAW;;AAEflB,8BAAM,mBAAN;;AAEA,4BAAIpU,eAAeC,QAAnB,EAA6B;;AAEzB,oCAAIqV,SAAJ,EAAe;AACX,6CAAKI,YAAL,CAAkBJ,SAAlB;AACH;AACD;;AAEA,qCAAKjO,kBAAL,CAAwB5J,OAAxB;;AAEA,uCAAO,IAAP;AAEH;AAEJ;;AAED;;;;;;;;uCAMOwO,K,EAAOhB,G,EAAK;;AAEfgB,gCAAQnQ,KAAK6Z,GAAL,CAAS1J,KAAT,CAAR;;AAEA,4BAAI,OAAOhB,GAAP,IAAe,QAAnB,EAA6B;AACzBA,sCAAM,EAACtM,GAAGsM,GAAJ,EAAN;AAEH;;AAED,6BAAK2K,WAAL;;AAEA,4BAAIC,OAAO5K,IAAItM,CAAJ,GAAQ,KAAKkV,KAAL,CAAWlV,CAA9B;;AAEA,4BAAIkX,OAAO,CAAX,EAAc;AACV,qCAAKhC,KAAL,CAAWlV,CAAX,IAAgB7C,KAAK6Z,GAAL,CAASE,IAAT,KAAkB5J,KAAlB,GAA0BA,KAA1B,GAAkC4J,IAAlD;AAEH;AACD;;AAEA,4BAAIA,OAAO,CAAX,EAAc;AACV,qCAAKhC,KAAL,CAAWlV,CAAX,IAAgB7C,KAAK6Z,GAAL,CAASE,IAAT,KAAkB5J,KAAlB,GAA0BA,KAA1B,GAAkC4J,IAAlD;AAEH;AACD;AAEH;;AAGD;;;;;;;;uCAMO5J,K,EAAOhB,G,EAAK;;AAEfgB,gCAAQnQ,KAAK6Z,GAAL,CAAS1J,KAAT,CAAR;;AAEA,4BAAI,OAAOhB,GAAP,IAAe,QAAnB,EAA6B;AACzBA,sCAAM,EAAC5R,GAAG4R,GAAJ,EAAN;AAEH;;AAED,6BAAK2K,WAAL;;AAEA,4BAAIC,OAAO5K,IAAI5R,CAAJ,GAAQ,KAAKwa,KAAL,CAAWxa,CAA9B;;AAEA,4BAAIwc,OAAO,CAAX,EAAc;AACV,qCAAKhC,KAAL,CAAWxa,CAAX,IAAgByC,KAAK6Z,GAAL,CAASE,IAAT,KAAkB5J,KAAlB,GAA0BA,KAA1B,GAAkC4J,IAAlD;AAEH;AACD;;AAEA,4BAAIA,OAAO,CAAX,EAAc;AACV,qCAAKhC,KAAL,CAAWxa,CAAX,IAAgByC,KAAK6Z,GAAL,CAASE,IAAT,KAAkB5J,KAAlB,GAA0BA,KAA1B,GAAkC4J,IAAlD;AAEH;AACD;AAEH;;AAKD;;;;;;;sCAKMC,I,EAAMzV,G,EAAK4L,M,EAAOhB,G,EAAK;;AAEzBgB,iCAAQnQ,KAAK6Z,GAAL,CAAS1J,MAAT,CAAR;;AAEA,4BAAI,OAAOhB,GAAP,IAAe,QAAnB,EAA6B;AACzBA,sCAAM,EAAC5R,GAAG4R,GAAJ,EAAN;AAEH;;AAED,4BAAI4I,QAAQiC,KAAKzV,GAAL,CAAZ;;AAED;;AAEC,4BAAIwV,OAAO5K,IAAI5R,CAAJ,GAAQyc,KAAKzV,GAAL,CAAnB;;AAEA,4BAAIwV,OAAO,CAAX,EAAc;AACVC,qCAAKzV,GAAL,KAAavE,KAAK6Z,GAAL,CAASE,IAAT,KAAkB5J,MAAlB,GAA0BA,MAA1B,GAAkC4J,IAA/C;AAEH;AACD;;AAEA,4BAAIA,OAAO,CAAX,EAAc;AACVC,qCAAKzV,GAAL,KAAavE,KAAK6Z,GAAL,CAASE,IAAT,KAAkB5J,MAAlB,GAA0BA,MAA1B,GAAkC4J,IAA/C;AAEH;AACD;AAEH;;AAID;;;;;;;sCAKMC,I,EAAMzV,G,EAAK0V,I,EAAM;AACnB,4BAAI,QAAOA,IAAP,yCAAOA,IAAP,MAAgB,QAApB,EAA8B;;AAE1BA,uCAAOA,KAAKA,IAAZ;AAEH;;AAEDA,+BAAOja,KAAK6Z,GAAL,CAASI,IAAT,CAAP;;AAEA,4BAAGja,KAAK6Z,GAAL,CAASG,KAAKzV,GAAL,CAAT,KAAuB0V,IAA1B,EACA;AACID,qCAAKzV,GAAL,IAAY,CAAZ;AACH,yBAHD,MAKI,IAAIyV,KAAKzV,GAAL,IAAY,CAAhB,EAAmB;AACnByV,qCAAKzV,GAAL,KAAa0V,IAAb;AAEH,yBAHG,MAIC,IAAID,KAAKzV,GAAL,IAAY,CAAhB,EAAmB;AACpByV,qCAAKzV,GAAL,KAAa0V,IAAb;AAEH,yBAHI,MAIA;;AAEDD,qCAAKzV,GAAL,IAAY,CAAZ;AAEH;AACJ;;AAGD;;;;;;;;wCAMY0V,I,EAAM;AACV,4BAAI,QAAOA,IAAP,yCAAOA,IAAP,MAAgB,QAApB,EAA8B;;AAE9BA,uCAAOA,KAAKA,IAAZ;AAEH;;AAEDA,+BAAOja,KAAK6Z,GAAL,CAASI,IAAT,CAAP;;AAEI,4BAAGja,KAAK6Z,GAAL,CAAS,KAAK9B,KAAL,CAAW,GAAX,CAAT,KAA6BkC,IAAhC,EACA;AACI,qCAAKlC,KAAL,CAAW,GAAX,IAAkB,CAAlB;AAEH;;AAEL,4BAAI,KAAKA,KAAL,CAAW,GAAX,IAAkB,CAAtB,EAAyB;AACrB,qCAAKA,KAAL,CAAW,GAAX,KAAmBkC,IAAnB;AAEH,yBAHD,MAIK,IAAI,KAAKlC,KAAL,CAAW,GAAX,IAAkB,CAAtB,EAAyB;AAC1B,qCAAKA,KAAL,CAAW,GAAX,KAAmBkC,IAAnB;AAEH,yBAHI,MAIA;;AAED,qCAAKlC,KAAL,CAAW,GAAX,IAAkB,CAAlB;AAEH;AAEJ;;AAGD;;;;;;;;uCAMOmC,G,EAAK;;AAERA,8BAAMla,KAAK6Z,GAAL,CAASK,GAAT,CAAN;;AAEA,4BAAIla,KAAK6Z,GAAL,CAAS,KAAK9B,KAAL,CAAWlV,CAApB,KAA0BqX,GAA9B,EAAmC;AAC/B,qCAAKnC,KAAL,CAAWlV,CAAX,GAAe,CAAf;AAEH,yBAHD,MAIK,IAAI,KAAKkV,KAAL,CAAWlV,CAAX,GAAeqX,GAAnB,EAAwB;;AAEzB,qCAAKnC,KAAL,CAAWlV,CAAX,IAAgBqX,GAAhB;AACH,yBAHI,MAIA,IAAI,KAAKnC,KAAL,CAAWlV,CAAX,GAAeqX,MAAM,CAAC,CAA1B,EAA6B;;AAE9B,qCAAKnC,KAAL,CAAWlV,CAAX,IAAgBqX,GAAhB;AACH;AAEJ;;AAED;;;;;;;;uCAMOA,G,EAAK;;AAERA,8BAAMla,KAAK6Z,GAAL,CAASK,GAAT,CAAN;;AAGA,4BAAI,KAAKnC,KAAL,CAAWxa,CAAX,GAAe2c,GAAnB,EAAwB;;AAEpB,qCAAKnC,KAAL,CAAWxa,CAAX,IAAgB2c,GAAhB;AACH,yBAHD,MAIK,IAAI,KAAKnC,KAAL,CAAWxa,CAAX,GAAe2c,MAAM,CAAC,CAA1B,EAA6B;;AAE9B,qCAAKnC,KAAL,CAAWxa,CAAX,IAAgB2c,GAAhB;AACH;;AAED,4BAAIla,KAAK6Z,GAAL,CAAS,KAAK9B,KAAL,CAAWxa,CAApB,KAA0B2c,GAA9B,EAAmC;;AAE/B,qCAAKnC,KAAL,CAAWxa,CAAX,GAAe,CAAf;AAEH;AAEJ;;AAED;;;;;;;;;6CAOaoD,I,EAAM;;AAEf,4BAAIwZ,QAAQxZ,KAAKwO,GAAL,GAAWxO,KAAKwO,GAAL,CAAStM,CAApB,GAAwBlC,KAAKgC,QAAL,CAAcE,CAAlD;;AAEA,4BAAI,KAAKF,QAAL,CAAcE,CAAd,GAAkB,KAAKD,IAAL,CAAUC,CAA5B,IAAiCsX,KAArC,EAA4C;;AAExC,qCAAKxX,QAAL,CAAcE,CAAd,GAAkBsX,QAAQ,KAAKvX,IAAL,CAAUC,CAApC;;AAEA,qCAAK0O,SAAL,GAAiB,KAAjB;AAEH;AAEJ;;AAED;;;;;;;;yCAMS6I,S,EAAW;AAChB,4BAAI/Z,SAAS,IAAb;;AAEAE,0BAAE8Z,OAAF,CAAUD,SAAV,EAAqB,UAAUE,IAAV,EAAgB;;AAEjCja,yCAAS,IAAIqX,MAAJ,CAAW4C,IAAX,CAAT;AAEH,yBAJD;AAMH;;;;;;AAEJ;;AAED;;;;;AAMA,IAAIC,4BAA4B;;AAE5BC,+BAAuB;;AAEnBC,wBAAQ,EAFW;;AAInBC,+BAAe,uBAAU7Q,MAAV,EAAkB;;AAE7ByO,8BAAM,sBAAN;;AAEAhX,gCAAQI,GAAR,CAAY,iCAAZ;;AAEA,4BAAIiZ,QAAQhW,UAAUD,OAAtB;;AAEAC,+BAAO2N,cAAP,CAAsB1L,EAAtB,CAAyB,YAAzB,EAAuC,CAAvC,EAA0C,UAAUrJ,CAAV,EAAasF,CAAb,EAAgB;;AAEtDvB,wCAAQI,GAAR,CAAY,aAAanE,CAAzB;;AAEA,oCAAGyC,KAAK6Z,GAAL,CAAStc,CAAT,IAAc,GAAjB,EACA;AACI,+CAAO,CAAP;AACH;;AAED,oCAAK4S,QAAS,GAAd,CATsD,CASnC;AACnB,oCAAKhB,MAAO,CAAZ;;AAEAtF,uCAAO+Q,MAAP,CAAczK,KAAd,EAAqB5S,IAAI4R,GAAzB;;AAEA,oCAAI5R,IAAI,CAAC,GAAT,EAAc;AACVsM,+CAAOqC,KAAP,GAAe,IAAf;AAEH,iCAHD,MAIK,IAAI3O,IAAI,GAAR,EAAa;AACdsM,+CAAOqC,KAAP,GAAe,KAAf;AAEH;AAEJ,yBAvBD;;AAyBArC,+BAAO6C,QAAP,CAAgB,UAAUmO,GAAV,EAAe;;AAE3BA,oCAAIC,MAAJ,CAAW,GAAX;;AAEA,oCAAI,CAACD,IAAItJ,SAAT,EAAoB;AAChBsJ,4CAAIE,MAAJ,CAAW,GAAX;AACH;AACD;AAEH,yBATD;AAYH,iBAjDkB;;AAmDnBC,gCAAgB,wBAAUnR,MAAV,EAAkB;;AAE9ByO,8BAAM,sBAAN;;AAEAhX,gCAAQI,GAAR,CAAY,iCAAZ;;AAEA,4BAAIiZ,QAAQhW,UAAUD,OAAtB;;AAEAC,+BAAO2N,cAAP,CAAsB1L,EAAtB,CAAyB,YAAzB,EAAuC,CAAvC,EAA0C,UAAUrJ,CAAV,EAAasF,CAAb,EAAgB;;AAEtDvB,wCAAQI,GAAR,CAAY,aAAanE,CAAzB;;AAEA,oCAAGyC,KAAK6Z,GAAL,CAAStc,CAAT,IAAc,GAAjB,EACA;AACIA,4CAAI,CAAJ;AACH;;AAED,oCAAGyC,KAAK6Z,GAAL,CAAShX,CAAT,IAAc,GAAjB,EACA;AACIA,4CAAI,CAAJ;AACH;;AAED,oCAAKsN,QAAS,GAAd,CAdsD,CAcnC;AACnB,oCAAKhB,MAAO,CAAZ;;AAEAtF,uCAAO+Q,MAAP,CAAczK,KAAd,EAAqB5S,IAAI4R,GAAzB;;AAEAtF,uCAAOyH,MAAP,CAAcnB,KAAd,EAAqBtN,IAAIsM,GAAzB;;AAEA,oCAAI5R,IAAI,CAAC,GAAT,EAAc;AACVsM,+CAAOqC,KAAP,GAAe,IAAf;AAEH,iCAHD,MAIK,IAAI3O,IAAI,GAAR,EAAa;AACdsM,+CAAOqC,KAAP,GAAe,KAAf;AAEH;AAEJ,yBA9BD;;AAgCArC,+BAAO6C,QAAP,CAAgB,UAAUmO,GAAV,EAAe;;AAE3BhR,uCAAOoR,KAAP,CAAapR,OAAOkO,KAApB,EAA2B,GAA3B,EAAgC,GAAhC;;AAEAlO,uCAAOoR,KAAP,CAAapR,OAAOkO,KAApB,EAA2B,GAA3B,EAAgC,GAAhC;AAEH,yBAND;AASH,iBApGkB;;AAsGnBmD,iCAAiB,yBAAUrR,MAAV,EAAkB;;AAE/ByO,8BAAM,sBAAN;;AAGA,4BAAIqC,QAAQhW,UAAUD,OAAtB;;AAEAC,+BAAO2N,cAAP,CAAsB1L,EAAtB,CAAyB,YAAzB,EAAuC,CAAvC,EAA0C,UAAUrJ,CAAV,EAAasF,CAAb,EAAgB;;AAEtDvB,wCAAQI,GAAR,CAAY,aAAanE,CAAzB;;AAEA,oCAAGyC,KAAK6Z,GAAL,CAAStc,CAAT,IAAc,GAAjB,EACA;AACI,+CAAO,CAAP;AACH;;AAED,oCAAK4S,QAAS,IAAd,CATsD,CASlC;AACpB,oCAAKhB,MAAO,CAAZ;;AAEAtF,uCAAOsG,KAAP,CAAatG,OAAOoO,SAApB,EAA+B,GAA/B,EAAoC9H,KAApC,EAA2C5S,IAAI4R,GAA/C;;AAEA,oCAAI5R,IAAI,CAAC,GAAT,EAAc;AACVsM,+CAAOqC,KAAP,GAAe,IAAf;AAEH,iCAHD,MAIK,IAAI3O,IAAI,GAAR,EAAa;AACdsM,+CAAOqC,KAAP,GAAe,KAAf;AAEH;AAEJ,yBAvBD;;AAyBArC,+BAAO6C,QAAP,CAAgB,UAAUmO,GAAV,EAAe;;AAE3BhR,uCAAOoR,KAAP,CAAapR,OAAOoO,SAApB,EAA+B,GAA/B,EAAoC,GAApC;;AAEA,oCAAI,CAAC4C,IAAItJ,SAAT,EAAoB;AAChBsJ,4CAAIE,MAAJ,CAAW,GAAX;AACH;AACD;AAEH,yBATD;AAYH;;AAlJkB;;AAFK,CAAhC;;AA4JApW,OAAOyT,OAAP,GAAiBzT,OAAOyT,OAAP,IAAkB,EAAnC;;AAEAzT,OAAOyT,OAAP,CAAeC,kBAAf,GAAoCkC,yBAApC,CAA8D;AAC9D;;IAEM9N,O;AACF,yBAAYlP,CAAZ,EAAesF,CAAf,EAAkB6I,CAAlB,EAAqB3L,CAArB,EAAwB;AAAA;;AAEpB,oBAAG,QAAOxC,CAAP,yCAAOA,CAAP,MAAa,QAAb,IAAyBA,EAAEA,CAA3B,IAAgCA,EAAEsF,CAArC,EAAwC;AACxC;AACI,qCAAKtF,CAAL,GAASA,EAAEA,CAAX;AACA,qCAAKsF,CAAL,GAAStF,EAAEsF,CAAX;AACA,qCAAK6I,CAAL,GAASnO,EAAEmO,CAAF,IAAO,CAAhB;;AAEA,uCAAO,IAAP;AACH;;AAED,qBAAKnO,CAAL,GAASA,CAAT;AACA,qBAAKsF,CAAL,GAASA,CAAT;AACA,qBAAK6I,CAAL,GAASA,CAAT;AACA,qBAAK3L,CAAL,GAASA,CAAT;;AAEA,qBAAKob,YAAL,GAAoB,KAApB;AAEH;;;;2CAEUC,C,EACX;AACI,6BAAKD,YAAL,GAAoBC,CAApB;AACH;;;oCAEGA,C,EACJ;AACI,4BAAG,OAAOA,CAAP,IAAa,QAAhB,EACA;AACIA,oCAAI,EAAC7d,GAAE6d,CAAH,EAAMvY,GAAEuY,CAAR,EAAW1P,GAAE0P,CAAb,EAAJ;AACH;;AAED,+BAAO,IAAI3O,OAAJ,CAAY,KAAKlP,CAAL,GAAS6d,EAAE7d,CAAvB,EAA0B,KAAKsF,CAAL,GAASuY,EAAEvY,CAArC,EAAwC,KAAK6I,CAAL,GAAS0P,EAAE1P,CAAnD,CAAP;AAEH;;;oCAEG0P,C,EACJ;AACI,4BAAG,OAAOA,CAAP,IAAa,QAAhB,EACA;AACIA,oCAAI,EAAC7d,GAAE6d,CAAH,EAAMvY,GAAEuY,CAAR,EAAW1P,GAAE0P,CAAb,EAAJ;AACH;;AAED,+BAAO,IAAI3O,OAAJ,CAAY,KAAKlP,CAAL,GAAS6d,EAAE7d,CAAvB,EAA0B,KAAKsF,CAAL,GAASuY,EAAEvY,CAArC,EAAwC,KAAK6I,CAAL,GAAS0P,EAAE1P,CAAnD,CAAP;AAEH;;;qCAEI0P,C,EACL;AACI,4BAAG,OAAOA,CAAP,IAAa,QAAhB,EACA;AACIA,oCAAI,EAAC7d,GAAE6d,CAAH,EAAMvY,GAAEuY,CAAR,EAAW1P,GAAE0P,CAAb,EAAJ;AACH;;AAED,+BAAO,IAAI3O,OAAJ,CAAY,KAAKlP,CAAL,GAAS6d,EAAE7d,CAAvB,EAA0B,KAAKsF,CAAL,GAASuY,EAAEvY,CAArC,EAAwC,KAAK6I,CAAL,GAAS0P,EAAE1P,CAAnD,CAAP;AAEH;;;oCACG0P,C,EACJ;AACI,4BAAG,OAAOA,CAAP,IAAa,QAAhB,EACA;AACIA,oCAAI,EAAC7d,GAAE6d,CAAH,EAAMvY,GAAEuY,CAAR,EAAW1P,GAAE0P,CAAb,EAAJ;AACH;;AAED,+BAAO,IAAI3O,OAAJ,CAAY,KAAKlP,CAAL,GAAS6d,EAAE7d,CAAvB,EAA0B,KAAKsF,CAAL,GAASuY,EAAEvY,CAArC,EAAwC,KAAK6I,CAAL,GAAS0P,EAAE1P,CAAnD,CAAP;AACH;;;wCAGD;AACI,+BAAO,IAAIe,OAAJ,CAAYzM,KAAK8K,KAAL,CAAW,KAAKvN,CAAhB,CAAZ,EAAgCyC,KAAK8K,KAAL,CAAW,KAAKjI,CAAhB,CAAhC,EAAoD7C,KAAK8K,KAAL,CAAW,KAAKY,CAAhB,CAApD,CAAP;AAEH;;;wCAED;AACI,+BAAO,IAAIe,OAAJ,CAAYzM,KAAKE,KAAL,CAAW,KAAK3C,CAAhB,CAAZ,EAAgCyC,KAAKE,KAAL,CAAW,KAAK2C,CAAhB,CAAhC,EAAoD7C,KAAKE,KAAL,CAAW,KAAKwL,CAAhB,CAApD,CAAP;AAEH;;;uCAED;AACI,+BAAO,IAAIe,OAAJ,CAAYzM,KAAKqU,IAAL,CAAU,KAAK9W,CAAf,CAAZ,EAA+ByC,KAAKqU,IAAL,CAAU,KAAKxR,CAAf,CAA/B,EAAkD7C,KAAKqU,IAAL,CAAU,KAAK3I,CAAf,CAAlD,CAAP;AAEH;;;uCAGD;AACI;;;AAGH;;;2CAGD;AACI;;AAEH;;;2CAEU2P,E,EAAIC,E,EACf;AACG;;AAEF;;;;;;AAGL;;AAEA,IAAIC,MAAM9O,OAAV;AAAA,IAAmB+O,OAAO/O,OAA1B;AAAA,IAAmCgP,WAAWhP,OAA9C;AAAA,IAAuDiP,UAAUjP,OAAjE;AAAA,IAA0EkP,SAASlP,OAAnF;AAAA,IAA4FmP,WAAWnP,OAAvG;;AAEA;AACA,C,CAAC;;;;;IAMKoP,iB;AAEF,0CACA;AAAA,oBADahP,IACb,SADaA,IACb;AAAA,oBADmBgB,WACnB,SADmBA,WACnB;AAAA,oBADgChK,QAChC,SADgCA,QAChC;;AAAA;;AAEG,qBAAKgJ,IAAL,GAAYA,IAAZ;;AAEA,qBAAKgB,WAAL,GAAmBA,WAAnB;;AAEA,qBAAKhK,QAAL,GAAgBA,YAAY,YAAU;AAAEvC,gCAAQC,IAAR,CAAa,oBAAb;AAAqC,iBAA7E;AAEF;;;;sCAGD;;AAEI,6BAAKsC,QAAL;AAEH;;;;;;IAKCiY,wB,GAEF,yCACA;AAAA,YADajP,IACb,SADaA,IACb;AAAA,YADmBgB,WACnB,SADmBA,WACnB;;AAAA;;AACI,aAAKhB,IAAL,GAAYA,QAAQ,iBAApB;;AAEA,aAAKgB,WAAL,GAAmBA,eAAe,4CAAlC;;AAEA,aAAKkO,iBAAL,GAAyB;;AAEzBC,wBAAO,gBAASze,CAAT,EAAYsF,CAAZ,EAAc,CAAE,CAFE,EAEA;;;AAIzBoZ,wCAAuB;;AAEnBC,sCAAavX,OAAOwX,EAAP,CAAUC,iBAAV,EAFM;;AAInBC,sCAAa,KAJM;;AAMnBC,sCAAa3X,OAAOwX,EAAP,CAAUG,YANJ;;AAQnBC,4CAAmB5X,OAAOwX,EAAP,CAAUK,gBAAV;;AARA,iBANE,EAgBtB;;AAEHC,sCAAqB;;AAEjBC,yCAAgB,KAFC;;AAIjBC,iCAAQhY,OAAOwX,EAAP,CAAUS,YAAV;;AAJS,iBAlBI,EAwBtB;;AAEHC,0CAAyB,EA1BA,EA0BI;;AAE7BC,yCAAwB,EA5BC,EA4BG;;AAE5BC,yCAAwB,EA9BC,EA8BG;;AAE5BC,yCAAwB,EAhCC,EAgCG;;AAE5BC,6BAAY,EAlCa,CAkCV;;AAlCU,SAAzB;AAsCH,C","file":"GameStack.js","sourcesContent":["/**\r\n * Created by The Blakes on 3/16/2017.\r\n */\r\n\r\n\r\n\r\n/*\r\n * #Section Media\r\n *\r\n * */\r\n\r\n\r\n/*\r\n * Sound\r\n *\r\n * Simple Sound object:: uses Jquery: audio\r\n *\r\n * TODO : test Sound() for multiple simultaneous sounds, modify as needed\r\n *\r\n * */\r\n\r\nclass Sound {\r\n\r\n    constructor(src) {\r\n\r\n        if (typeof(src) == 'object') {\r\n\r\n            for (var x in src) {\r\n                this[x] = src[x];\r\n\r\n            }\r\n\r\n            this.sound = new Audio(src.src);\r\n\r\n            this.onLoad = src.onLoad || function () {\r\n                };\r\n\r\n        }\r\n\r\n        else if (typeof(src) == 'string') {\r\n\r\n            this.src = src;\r\n\r\n            this.sound = new Audio(this.src);\r\n\r\n        }\r\n\r\n        this.onLoad = this.onLoad || function () {\r\n            };\r\n\r\n        if (typeof(this.onLoad) == 'function') {\r\n\r\n            this.onLoad(this.sound);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    play() {\r\n        if (typeof(this.sound) == 'object' && typeof(this.sound.play) == 'function') {\r\n\r\n            this.sound.play();\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n/*\r\n * GameImage\r\n *\r\n * Simple GameImage\r\n *\r\n * */\r\n\r\nclass GameImage {\r\n\r\n    constructor(src, onCreate) {\r\n\r\n        // GameStack.log('initializing image');\r\n\r\n        if (src instanceof Object) {\r\n\r\n            //alert('getting image from image');\r\n\r\n            this.image = document.createElement('IMG');\r\n\r\n            this.image.src = src.src;\r\n\r\n            this.src = src.src;\r\n\r\n        }\r\n\r\n        else if (typeof(src) == 'string') {\r\n\r\n            let ext = src.substring(src.lastIndexOf('.'), src.length);\r\n\r\n            this.image = document.createElement('IMG');\r\n\r\n            this.image.src = src;\r\n\r\n            this.src = this.image.src;\r\n\r\n\r\n        }\r\n\r\n\r\n        if (!this.image) {\r\n            this.image = {error: \"Image not instantiated, set to object by default\"};\r\n\r\n        }\r\n        else {\r\n            this.image.onerror = function () {\r\n                this.__error = true;\r\n            };\r\n\r\n        }\r\n\r\n        this.domElement = this.image;\r\n\r\n        this.image.onload = function () {\r\n\r\n            if (typeof(this.onCreate) == 'function') {\r\n\r\n                this.onCreate(this.image);\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n    }\r\n\r\n    getImage() {\r\n        return this.image;\r\n    }\r\n\r\n}\r\n    let GameStackLibrary = function () {\r\n\r\n\r\n    var lib = {\r\n\r\n        DEBUG: false,\r\n\r\n        gui_mode: true,\r\n\r\n        __gameWindow: {}\r\n        ,\r\n\r\n        __sprites: [],\r\n\r\n        __animations: [],\r\n\r\n        samples: {}\r\n        ,\r\n\r\n        log_modes: ['reqs', 'info', 'warning'],\r\n\r\n        log_mode: \"all\",\r\n\r\n        recursionCount: 0,\r\n\r\n        __gameWindowList: [],\r\n\r\n\r\n        create_id: function () {\r\n\r\n            var d = new Date().getTime();\r\n            if (typeof performance !== 'undefined' && typeof performance.now === 'function'){\r\n                d += performance.now(); //use high-precision timer if available\r\n            }\r\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n                var r = (d + Math.random() * 16) % 16 | 0;\r\n                d = Math.floor(d / 16);\r\n                return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\r\n            });\r\n\r\n        }\r\n\r\n        ,\r\n\r\n        getActionablesCheckList: function () {\r\n            //every unique sound, animation, tweenmotion in the game\r\n\r\n            let __inst = {};\r\n\r\n            let actionables = [];\r\n\r\n            $.each(this.sprites, function (ix, item) {\r\n\r\n                actionables.concat(item.sounds);\r\n\r\n                actionables.concat(item.motionstacks);\r\n\r\n                actionables.concat(item.animations);\r\n\r\n\r\n            });\r\n\r\n\r\n        }\r\n        ,\r\n\r\n        interlog: function (message, div) //recursive safe :: won't go crazy with recursive logs\r\n        {\r\n            this.recursionCount++;\r\n\r\n            if (!isNaN(div) && this.recursionCount % div == 0) {\r\n                //   console.log('Interval Log:'+  message);\r\n\r\n            }\r\n\r\n        }\r\n        ,\r\n\r\n        error: function (quit, message) {\r\n\r\n            if (quit) {\r\n                throw new Error(message);\r\n\r\n            }\r\n            else {\r\n                console.error('E!' + message);\r\n\r\n            }\r\n\r\n        }\r\n        ,\r\n\r\n        info: function (m) {\r\n\r\n            if (GameStack.DEBUG) {\r\n\r\n                console.info('Info:' + m);\r\n\r\n            }\r\n        }\r\n        ,\r\n\r\n\r\n        log: function (m) {\r\n\r\n            if (GameStack.DEBUG) {\r\n\r\n                console.log('GameStack:' + m);\r\n\r\n            }\r\n        }\r\n        ,\r\n\r\n        //animate() : main animation call, run the once and it will recurse with requestAnimationFrame(this.animate);\r\n\r\n        animate: function () {\r\n            TWEEN.update(time);\r\n\r\n            requestAnimationFrame(this.animate);\r\n\r\n            this.__gameWindow.update();\r\n\r\n            this.__gameWindow.ctx.clearRect(0, 0, this.__gameWindow.canvas.width, this.__gameWindow.canvas.height);\r\n\r\n            this.__gameWindow.draw();\r\n\r\n        }\r\n        ,\r\n\r\n        start: function () {\r\n\r\n            this.animate();\r\n\r\n        }\r\n        ,\r\n\r\n\r\n        Collision: {\r\n\r\n            spriteRectanglesCollide(obj1, obj2)\r\n            {\r\n                if (obj1.position.x + obj1.size.x > obj2.size.x && obj1.position.x < obj2.size.x + obj2.size.x &&\r\n                    obj1.position.y + obj1.size.y > obj2.size.y && obj1.position.y < obj2.size.y + obj2.size.y) {\r\n\r\n                    return true;\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n        ,\r\n\r\n        TWEEN: TWEEN,\r\n\r\n        _gameWindow: {}\r\n        ,\r\n\r\n        setGameWindow: function (gameWindow) {\r\n\r\n            this._gameWindow = gameWindow;\r\n\r\n        }\r\n        ,\r\n\r\n        getGameWindow: function () {\r\n\r\n\r\n            return this._gameWindow;\r\n\r\n        }\r\n        ,\r\n\r\n        assignAll: function (object, args, keys) {\r\n\r\n            __gameStack.each(keys, function (ix, item) {\r\n\r\n                object[ix] = args[ix];\r\n\r\n            });\r\n\r\n\r\n        }\r\n        ,\r\n\r\n\r\n        each: function (list, onResult, onComplete) {\r\n            for (var i in list) {\r\n                onResult(i, list[i]);\r\n            }\r\n\r\n            if (typeof(onComplete) === 'function') {\r\n                onComplete(false, list)\r\n            }\r\n            ;\r\n\r\n        }\r\n        ,\r\n\r\n        ready_callstack: [],\r\n\r\n        ready: function (callback) {\r\n\r\n            this.ready_callstack.push(callback);\r\n\r\n        }\r\n\r\n        ,\r\n\r\n        callReady: function () {\r\n\r\n            var funx = this.ready_callstack;\r\n\r\n            var gameWindow = this._gameWindow, lib = this, sprites = this.__gameWindow.sprites;\r\n\r\n            //call every function in the ready_callstack\r\n\r\n            this.each(funx, function (ix, call) {\r\n\r\n                call(lib, gameWindow, sprites);\r\n\r\n            });\r\n\r\n\r\n            __gameInstance.isAtPlay = true;\r\n\r\n\r\n            this.InputEvents.init();\r\n\r\n        }\r\n        ,\r\n\r\n        getArg: function (args, key, fallback) {\r\n            if (args && args.hasOwnProperty(key)) {\r\n                return args[key];\r\n            }\r\n            else {\r\n                return fallback;\r\n\r\n            }\r\n\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n    return lib;\r\n\r\n};\r\n\r\n//GameStack: a main / game lib object::\r\n//TODO: fix the following set of mixed references:: only need to refer to (1) lib instance\r\n\r\nlet GameStack = new GameStackLibrary();\r\nlet __gameStack = GameStack;\r\n\r\nlet Quick2d = GameStack; //Exposing 'Quick2d' as synonymous reference to GameStack\r\n\r\nlet Quazar = GameStack; //Exposing 'Quazar' as synonymous reference to GameStack\r\n\r\nlet QUAZAR = GameStack; //Exposing 'QUAZAR' as synonymous reference to GameStack\r\n\r\nlet __gameInstance = GameStack;\r\n\r\n/***************\r\n * TODO : fix the above duplicate references, which exist now for backward compatibility with previouslyh authored code\r\n *\r\n *  -apply find and replace accross the codebase\r\n *\r\n * ****************/\r\n\r\n\r\n/**********\r\n * $Q : Selector Function\r\n *\r\n * **********/\r\n\r\nfunction $Q({selector})\r\n{\r\n    this.selector = selector;\r\n\r\n    this.before = function(c1, str)\r\n    {\r\n        var test_str = str || this.selector;\r\n        var start_pos = 0;\r\n        var end_pos = test_str.indexOf(c1,start_pos);\r\n       return test_str.substring(start_pos,end_pos);\r\n    };\r\n\r\n\r\n    this.contains = function(c1, str)\r\n    {\r\n        var test_str = str || this.selector;\r\n\r\n        return test_str.indexOf(c1) >= 0;\r\n    };\r\n\r\n    this.contains_all = function(cList, str)\r\n    {\r\n        var test_str = str || this.selector;\r\n\r\n        for(var x = 0; x < cList.length; x++)\r\n        {\r\n            if(test_str.indexOf(cList[x]) < 0)\r\n            {\r\n                return false;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return true;\r\n\r\n    };\r\n\r\n\r\n    this.contains_any = function(cList, str)\r\n    {\r\n        var test_str = str || this.selector;\r\n\r\n        for(var x = 0; x < cList.length; x++)\r\n        {\r\n            if(test_str.indexOf(cList[x]) >= 0)\r\n            {\r\n                return true;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return false;\r\n\r\n    };\r\n\r\n    this.after = function(c1, str)\r\n    {\r\n        var test_str = str || this.selector;\r\n        var start_pos = 0;\r\n        var end_pos = test_str.length;\r\n        return test_str.substring(start_pos,end_pos);\r\n    };\r\n\r\n    this.between = function(c1, c2, str)\r\n    {\r\n        var test_str = str || this.selector;\r\n        var start_pos = test_str.indexOf(c1) + 1;\r\n        var end_pos = test_str.indexOf(c2,start_pos);\r\n        return test_str.substring(start_pos,end_pos)\r\n    };\r\n\r\n    var mainSelector = this.before('[').trim(), msfChar = mainSelector.substring(0, 1);\r\n\r\n\r\n    var __targetClassName = \"*\";\r\n\r\n    switch(msfChar.toLowerCase())\r\n    {\r\n        case \".\":\r\n\r\n            console.info('Selecting by class');\r\n\r\n            __targetClassName =  this.after('.', mainSelector);\r\n\r\n            break;\r\n\r\n    }\r\n\r\n\r\n    var criterion = this.between('[', ']'), cparts = criterion.split('=');\r\n\r\n    switch(cparts[0].toLowerCase())\r\n    {\r\n        case \"name\":\r\n\r\n            //get all objects according to name=name\r\n\r\n            break;\r\n\r\n        case  \"type\":\r\n\r\n            //get all objects according to type=type\r\n\r\n            break;\r\n\r\n    };\r\n\r\n    this.getEventProfileFromKey = function(evt_key)\r\n    {\r\n\r\n        var isControl = evt_key.indexOf('stick') >= 0 || evt_key.indexOf('button') >= 0;\r\n\r\n        var isCollision = evt_key.indexOf('collide') >= 0,\r\n\r\n        isPropertyLimit = this.contains_any([\">\", \"<\", \"=\"], evt_key);\r\n\r\n        return{\r\n\r\n            isControl:isControl,\r\n\r\n            isCollision:isCollision,\r\n\r\n            isProperty:isProperty\r\n\r\n        }\r\n    };\r\n\r\n    var __\r\n\r\n    return{\r\n\r\n        on:function(evt_key, callback) //handle each event, such as on('collide') OR on('stick_left_0') << first controller, stick_left\r\n        {\r\n\r\n            //where does the event go?\r\n\r\n            var profile = this.getEventProfileFromKey(evt_key);\r\n\r\n            if(profile.isControl)\r\n            {\r\n                console.info('Rigging a control event');\r\n\r\n            }\r\n\r\n            if(profile.isCollision)\r\n            {\r\n                console.info('Rigging a collision event');\r\n\r\n            }\r\n\r\n            if(profile.isProperty)\r\n            {\r\n                console.info('Rigging a property event');\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n};\r\n\r\n\r\n/********************\r\n * GameStack.InputEvents\r\n * -Various PC Input Events\r\n ********************/\r\n\r\nGameStack.InputEvents = { //PC input events\r\n    mousemove: [],\r\n    leftclick: [],\r\n    rightclick: [],\r\n    middleclick: [],\r\n    wheelup: [],\r\n    wheelDown: [],\r\n    space: [],\r\n    tab: [],\r\n    shift: [],\r\n    1: [], 2: [], 3: [],\r\n    enter: [],\r\n    extend: function (evt_key, callback, onFinish) {\r\n\r\n        if (evt_key.toLowerCase().indexOf('key_') >= 0) {\r\n            //process this as a key event\r\n\r\n            var cleanKey = evt_key.toLowerCase();\r\n            GameStack.InputEvents[cleanKey] = GameStack.InputEvents[cleanKey] || [];\r\n            return GameStack.InputEvents[cleanKey].push({down: callback, up: onFinish});\r\n        } else {\r\n\r\n            GameStack.InputEvents[evt_key] = GameStack.InputEvents[evt_key] || [];\r\n            return GameStack.InputEvents[evt_key].push({down: callback, up: onFinish});\r\n        }\r\n\r\n    },\r\n    init: function () {\r\n\r\n\r\n        function getMousePos(e) {\r\n\r\n            var x;\r\n            var y;\r\n            if (e.pageX || e.pageY) {\r\n                x = e.pageX;\r\n                y = e.pageY;\r\n            } else {\r\n                x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n                y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n            }\r\n            x -= GameStack.canvas.offsetLeft;\r\n            y -= GameStack.canvas.style.top;\r\n            return {x: x, y: y};\r\n        }\r\n\r\n\r\n        function fullMoveInputEvents(event) {\r\n\r\n            var pos = getMousePos(event);\r\n            var InputEvents = GameStack.InputEvents;\r\n            for (var x in InputEvents) {\r\n\r\n\r\n                if (InputEvents[x] instanceof Array && x == 'mousemove') {\r\n\r\n\r\n                    GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                        el.down(pos.x, pos.y);\r\n                    });\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n        ;\r\n        document.onkeydown = function (e) {\r\n\r\n            //    alert(JSON.stringify(GameStack.InputEvents, true, 2));\r\n\r\n            GameStack.log('Got e');\r\n\r\n            var value = 'key_' + String.fromCharCode(e.keyCode).toLowerCase();\r\n            if (GameStack.InputEvents[value] instanceof Array) {\r\n\r\n                GameStack.log('Got []');\r\n\r\n                GameStack.each(GameStack.InputEvents[value], function (ix, item) {\r\n\r\n                    if (typeof (item.down) == 'function') {\r\n\r\n                        //   alert('RUNNING');\r\n\r\n                        item.down();\r\n                    }\r\n\r\n\r\n                });\r\n            }\r\n\r\n        }\r\n\r\n\r\n        document.onkeyup = function (e) {\r\n\r\n            //    alert(JSON.stringify(GameStack.InputEvents, true, 2));\r\n\r\n            var value = 'key_' + String.fromCharCode(e.keyCode).toLowerCase();\r\n            if (GameStack.InputEvents[value] instanceof Array) {\r\n\r\n                GameStack.each(GameStack.InputEvents[value], function (ix, item) {\r\n\r\n                    if (typeof (item.up) == 'function') {\r\n\r\n                        //   alert('RUNNING');\r\n\r\n                        item.up();\r\n                    }\r\n\r\n\r\n                });\r\n            }\r\n\r\n        };\r\n\r\n        GameStack.canvas.onmousedown = function (e) {\r\n\r\n            //    alert(JSON.stringify(GameStack.InputEvents, true, 2));\r\n\r\n            var value = e.which;\r\n            var pos = getMousePos(e);\r\n            var InputEvents = GameStack.InputEvents;\r\n\r\n\r\n            e.preventDefault();\r\n\r\n            switch (e.which) {\r\n                case 1:\r\n\r\n                    for (var x in InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'leftclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n\r\n                                el.down(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                case 2:\r\n                    // alert('Middle Mouse button pressed.');\r\n\r\n\r\n                    for (var x in GameStack.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'middleclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.down(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n                    break;\r\n                case 3:\r\n                    //  alert('Right Mouse button pressed.');\r\n\r\n\r\n                    for (var x in GameStack.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.down(pos.x, pos.y);\r\n                            });\r\n\r\n                            return false;\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                default:\r\n\r\n                    return 0;\r\n                //alert('You have a strange Mouse!');\r\n\r\n            }\r\n\r\n\r\n            e.preventDefault();\r\n            return 0;\r\n        };\r\n        GameStack.canvas.onmouseup = function (e) {\r\n\r\n            //    alert(JSON.stringify(GameStack.InputEvents, true, 2));\r\n\r\n            var value = e.which;\r\n            var pos = getMousePos(e);\r\n            var InputEvents = GameStack.InputEvents;\r\n\r\n\r\n            e.preventDefault();\r\n\r\n            switch (e.which) {\r\n                case 1:\r\n\r\n                    for (var x in InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'leftclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n\r\n                                el.up(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                case 2:\r\n                    // alert('Middle Mouse button pressed.');\r\n\r\n\r\n                    for (var x in GameStack.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'middleclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.up(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n                    break;\r\n                case 3:\r\n                    //  alert('Right Mouse button pressed.');\r\n\r\n\r\n                    for (var x in GameStack.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                            GameStack.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.up(pos.x, pos.y);\r\n                            });\r\n\r\n\r\n                            return false;\r\n\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                default:\r\n\r\n                    return 0;\r\n                //alert('You have a strange Mouse!');\r\n\r\n            }\r\n\r\n\r\n        };\r\n        document.addEventListener(\"mousemove\", fullMoveInputEvents);\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n__gameStack = QUAZAR;\r\n\r\n//Override the existing window.onload function\r\n\r\nwindow._preGameStack_windowLoad = window.onload;\r\n\r\nwindow.onload = function () {\r\n\r\n    if (typeof(window._preGameStack_windowLoad) == 'function') {\r\n        window._preGameStack_windowLoad();\r\n    }\r\n\r\n    __gameStack.callReady();\r\n\r\n}\r\n\r\n\r\n/*\r\n * Canvas\r\n *    draw animations, textures to the screen\r\n * */\r\n\r\n\r\nvar Canvas = {\r\n    draw: function (sprite, ctx) {\r\n\r\n        if (sprite.active && sprite.onScreen(Game.WIDTH, Game.HEIGHT)) {\r\n\r\n            this.drawPortion(sprite, ctx);\r\n\r\n        }\r\n\r\n    },\r\n    drawFrameWithRotation: function (img, fx, fy, fw, fh, x, y, width, height, deg, canvasContextObj, flip) {\r\n\r\n        canvasContextObj.save();\r\n        deg = Math.round(deg);\r\n        deg = deg % 360;\r\n        var rad = deg * Math.PI / 180;\r\n        //Set the origin to the center of the image\r\n        canvasContextObj.translate(x, y);\r\n        canvasContextObj.rotate(rad);\r\n        //Rotate the canvas around the origin\r\n\r\n        canvasContextObj.translate(0, canvasContextObj.width);\r\n        if (flip) {\r\n\r\n            canvasContextObj.scale(-1, 1);\r\n        } else {\r\n\r\n        }\r\n\r\n        //draw the image\r\n        canvasContextObj.drawImage(img, fx, fy, fw, fh, width / 2 * (-1), height / 2 * (-1), width, height);\r\n        //reset the canvas\r\n\r\n        canvasContextObj.restore();\r\n    },\r\n\r\n\r\n    /*\r\n     * drawPortion:\r\n     *\r\n     *   expects: (sprite{selected_animation{selected_frame{frameSize, framePos } offset?, gameSize? }  })\r\n     *\r\n     *\r\n     * */\r\n\r\n\r\n    drawPortion: function (sprite, ctx) {\r\n\r\n        var frame;\r\n\r\n        if (sprite.active) {\r\n\r\n            if (sprite.selected_animation && sprite.selected_animation.selected_frame) {\r\n\r\n                frame = sprite.selected_animation.selected_frame;\r\n\r\n            }\r\n            else {\r\n\r\n                console.error('Sprite is missing arguments');\r\n\r\n            }\r\n\r\n            var x = sprite.position.x;\r\n            var y = sprite.position.y;\r\n\r\n            var camera = __gameStack.camera || {pos: {x: 0, y: 0, z: 0}};\r\n\r\n\r\n            if (true) {\r\n\r\n                if (!isNaN(camera.pos.x)) {\r\n\r\n                    x += camera.pos.x;\r\n                }\r\n\r\n                if (!isNaN(camera.pos.y)) {\r\n\r\n                    y += camera.pos.y;\r\n                }\r\n\r\n            }\r\n            ;\r\n\r\n\r\n            //optional animation : gameSize\r\n\r\n            var targetSize = sprite.size || sprite.selected_animation.size;\r\n\r\n            var realWidth = targetSize.x;\r\n            var realHeight = targetSize.y;\r\n\r\n            //optional animation : offset\r\n\r\n            if (sprite.selected_animation.offset) {\r\n                x += sprite.selected_animation.offset.x;\r\n\r\n                y += sprite.selected_animation.offset.y;\r\n\r\n            }\r\n\r\n            var rotation;\r\n\r\n            if (typeof(sprite.rotation) == 'object') {\r\n\r\n                rotation = sprite.rotation.x;\r\n\r\n\r\n            }\r\n            else {\r\n                rotation = sprite.rotation;\r\n\r\n            }\r\n\r\n\r\n            this.drawFrameWithRotation(sprite.selected_animation.image.domElement, frame.framePos.x, frame.framePos.y, frame.frameSize.x, frame.frameSize.y, Math.round(x + (realWidth / 2)), Math.round(y + (realHeight / 2)), realWidth, realHeight, rotation % 360, ctx, sprite.flipX);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nGameStack.ready(function (lib) {\r\n\r\n    GameStack.log('GameStack:lib :: ready');\r\n\r\n\r\n});\r\n\r\n\r\n/**\r\n *\r\n *  class: GameWindow:\r\n *  args{canvas, ctx, sprites, backgrounds, interactives, forces, update}\r\n */\r\n\r\n\r\nclass GameWindow {\r\n\r\n    constructor({canvas, ctx, sprites, backgrounds, interactives, forces, update}) {\r\n\r\n        this.sprites = sprites instanceof Array ? sprites : [];\r\n\r\n        this.backgrounds = backgrounds instanceof Array ? backgrounds : [];\r\n\r\n        this.interactives = interactives instanceof Array ? interactives : [];\r\n\r\n        this.forces = forces instanceof Array ? forces : [];\r\n\r\n        this.canvas = canvas;\r\n\r\n        if (!this.canvas) {\r\n            this.canvas = document.createElement('CANVAS');\r\n            console.info('GameWindow(): Created New Canvas');\r\n        }\r\n\r\n        this.ctx = ctx || canvas.getContext('2d');\r\n\r\n        this.__camera = new Vector3(0, 0, 0);\r\n\r\n        if (typeof update == 'function') {\r\n            this.onUpdate(update);\r\n\r\n        }\r\n\r\n        GameStack.__gameWindow = this;\r\n\r\n        GameStack.canvas = this.canvas;\r\n\r\n        GameStack.ctx = this.ctx;\r\n\r\n    }\r\n\r\n    uniques(list) {\r\n\r\n        var listout = [];\r\n\r\n        $.each(list, function (ix, item) {\r\n\r\n            if (!listout.indexOf(item.id) >= 0) {\r\n\r\n                var str = item.name;\r\n\r\n                listout.push({\"sprite\": item});\r\n\r\n            }\r\n\r\n        });\r\n\r\n        return listout;\r\n\r\n    }\r\n\r\n    setPlayer(player) {\r\n        this.player = player;\r\n\r\n        if (!this.sprites.indexOf(player) >= 0) {\r\n            this.sprites.push(player);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        GameStack.each(this.sprites, function (ix, item) {\r\n\r\n            if (typeof(item.update) == 'function') {\r\n                item.update(item);\r\n\r\n            }\r\n\r\n            if (typeof(item.def_update) == 'function') {\r\n                //  console.log('def_update');\r\n\r\n                item.def_update(item);\r\n\r\n            }\r\n\r\n        });\r\n\r\n\r\n    }\r\n\r\n    onUpdate(arg) {\r\n        if (typeof(arg) == 'function') {\r\n            let up = this.update;\r\n\r\n            this.update = function (sprites) {\r\n                up(sprites);\r\n                arg(sprites);\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    draw() {\r\n\r\n        var _gw = this;\r\n\r\n        GameStack.each(this.sprites, function (ix, item) {\r\n\r\n            Canvas.draw(item, _gw.ctx);\r\n\r\n        });\r\n\r\n    }\r\n\r\n}\r\n;\r\n\r\n\r\nclass TextDisplay {\r\n\r\n\r\n}\r\n\r\n\r\n/**TODO:complete the following\r\n *  class: StatDisplay:\r\n *  class: BarDisplay\r\n *  class: VideoDisplay\r\n */\r\n\r\n\r\nclass ItemDisplay //show an item display (image with text/number to the right\r\n{\r\n    constructor({font, fontSize}) {\r\n\r\n    }\r\n\r\n    set(text, image, color, font) {\r\n\r\n\r\n    }\r\n\r\n    size() {\r\n\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nclass BarDisplay //show a display bar such as health bar\r\n{\r\n    constructor({font, fontSize}) {\r\n\r\n    }\r\n\r\n    set(text, image, color, font) {\r\n\r\n\r\n    }\r\n\r\n    size() {\r\n\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n    }\r\n\r\n}\r\n\r\nclass VideoDisplay //show a video\r\n{\r\n    constructor({src, size}) {\r\n\r\n        this.domElement = undefined;\r\n\r\n        this.src = src;\r\n\r\n        this.size = new Vector3(size.x, size.y, size.z || 0);\r\n\r\n        GameStack.log('VideoDisplay():: TODO: create dom element');\r\n\r\n    }\r\n\r\n    play() {\r\n\r\n    }\r\n}\r\n\r\n;/**\r\n * Created by The Blakes on 04-13-2017\r\n *\r\n */\r\n\r\n\r\n\r\nclass Animation {\r\n    constructor(args) {\r\n\r\n        args = args || {};\r\n\r\n        var _anime = this;\r\n\r\n        this.name = this.getArg(args, 'name', '_blank'),\r\n\r\n        this.description =  this.getArg(args, 'description', '_blank')\r\n\r\n        this.frames = this.getArg(args, 'frames', []);\r\n\r\n        this.image = new GameImage( this.getArg(args, 'src',  this.getArg(args, 'image', false)));\r\n\r\n\r\n        this.src = this.image.domElement.src;\r\n\r\n        this.domElement = this.image.domElement;\r\n\r\n        this.type = this.getArg(args, 'type', 'basic');\r\n\r\n        this.delay = this.getArg(args, 'delay', 0);\r\n\r\n        this.cix = 0;\r\n\r\n        this.frameSize = this.getArg(args, 'frameSize', new Vector3(0, 0, 0));\r\n\r\n        this.frameBounds = this.getArg(args, 'frameBounds', new VectorFrameBounds(new Vector3(0, 0, 0), new Vector3(0, 0, 0), new Vector3(0, 0, 0)));\r\n\r\n        this.frameOffset = this.getArg(args, 'frameOffset', new Vector3(0, 0, 0));\r\n\r\n\r\n      if(typeof(args) == 'object' && args.frameBounds && args.frameSize){  this.apply2DFrames(args.parent || {}) };\r\n\r\n        this.flipX = this.getArg(args, 'flipX', false);\r\n\r\n        this.priority = this.getArg(args, 'priority', 0);\r\n\r\n        this.cix = 0;\r\n\r\n        this.selected_frame = this.frames[0];\r\n\r\n        this.earlyTerm = this.getArg(args, 'earlyTerm', false);\r\n\r\n        this.hang =this.getArg(args, 'hang', false);\r\n\r\n        this.duration = this.getArg(args, 'duration', 1000);\r\n\r\n        this.size =  this.getArg(args, 'size', new Vector3(20, 20, 20));\r\n\r\n        this.effects = [];\r\n\r\n        this.timer = 0;\r\n\r\n        this.__gameLogic = false;\r\n\r\n        this.setType = function(){  };\r\n\r\n    }\r\n\r\n    singleFrame(frameSize, size)\r\n    {\r\n\r\n        this.__frametype = 'single';\r\n\r\n        this.frameSize = frameSize;\r\n\r\n        this.size = size;\r\n\r\n        this.selected_frame = {\r\n            image: this.image,\r\n            frameSize: this.frameSize,\r\n            framePos: {x: 0, y: 0}\r\n        };\r\n\r\n        this.frames[0] = this.selected_frame;\r\n\r\n\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n        if (args.hasOwnProperty(key)) {\r\n\r\n            return args[key];\r\n\r\n        }\r\n        else {\r\n            return fallback;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    apply2DFrames() {\r\n\r\n        this.frames = [];\r\n\r\n        var fcount = 0;\r\n\r\n\r\n        var quitLoop = false;\r\n\r\n        for (let y = this.frameBounds.min.y; y <= this.frameBounds.max.y; y++) {\r\n\r\n            for (let x = this.frameBounds.min.x; x <= this.frameBounds.max.x; x++) {\r\n\r\n                let framePos = {x: x * this.frameSize.x + this.frameOffset.x, y: y * this.frameSize.y + this.frameOffset.y};\r\n\r\n                this.frames.push({image: this.image, frameSize: this.frameSize, framePos: framePos});\r\n\r\n                if( x >= this.frameBounds.termPoint.x && y >= this.frameBounds.termPoint.y)\r\n                {\r\n\r\n                    quitLoop = true;\r\n\r\n                    break;\r\n                }\r\n\r\n                fcount += 1;\r\n\r\n                if(quitLoop)\r\n                    break;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        this.frames[0] = !this.frames[0] ? {\r\n                image: this.image,\r\n                frameSize: this.frameSize,\r\n                framePos: {x: this.frameBounds.min.x, y: this.frameBounds.min.y}\r\n            } : this.frames[0];\r\n\r\n       // this.selected_frame = this.frames[this.cix % this.frames.length] || this.frames[0];\r\n\r\n    }\r\n\r\n    resetFrames() //special reset function:: frames are re-rendered each reset()\r\n    {\r\n\r\n        this.apply2DFrames();\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        this.selected_frame = this.frames[Math.round(this.cix) % this.frames.length];\r\n\r\n\r\n    }\r\n\r\n    reset()\r\n{\r\n\r\n    this.resetFrames();\r\n\r\n    this.cix = 0;\r\n\r\n}\r\n\r\ncontinuous(duration)\r\n{\r\n\r\n    if(this.__frametype == 'single')\r\n    {\r\n        return 0;\r\n\r\n    }\r\n\r\n  this.apply2DFrames();\r\n\r\n    //update once:\r\n    this.update();\r\n\r\n\r\n    if(this.cix == 0)\r\n  {\r\n\r\n      this.engage();\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\nengage(duration, complete)\r\n{\r\n\r\n    if(this.__frametype == 'single')\r\n    {\r\n        return 0;\r\n\r\n    }\r\n\r\n\r\n    let __inst = this;\r\n\r\n    this.complete = complete || this.complete || function(){  };\r\n\r\n    var duration = duration || typeof(this.duration) == 'number' ? this.duration : this.frames.length * 20;\r\n\r\n    //we have a target\r\n  this.tween = new TWEEN.Tween(this)\r\n        .easing(__inst.curve || TWEEN.Easing.Linear.None)\r\n\r\n        .to({cix:__inst.frames.length - 1}, duration)\r\n        .onUpdate(function() {\r\n            //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n         //   __inst.cix = Math.ceil(__inst.cix);\r\n\r\n        __inst.update();\r\n\r\n        })\r\n        .onComplete(function() {\r\n            //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n            if(__inst.complete)\r\n            {\r\n\r\n                __inst.complete();\r\n\r\n            }\r\n\r\n            __inst.cix = 0;\r\n\r\n            __inst.isComplete = true;\r\n\r\n        });\r\n\r\n\r\n  this.tween.start();\r\n\r\n\r\n}\r\n\r\nonComplete(fun)\r\n{\r\n    this.complete = fun;\r\n\r\n}\r\n\r\n    animate() {\r\n\r\n        this.apply2DFrames();\r\n\r\n        this.timer += 1;\r\n\r\n        Quazar.log('ANIMATING with frame count:' + this.frames.length);\r\n\r\n        if(this.timer % this.delay == 0) {\r\n\r\n            if(this.hang)\r\n            {\r\n                this.cix = this.cix + 1;\r\n\r\n                if(this.cix > this.frames.length - 1)\r\n                {\r\n                    this.cix =  this.frames.length - 1;\r\n\r\n                }\r\n\r\n            }\r\n            else\r\n            {\r\n\r\n                this.cix = this.cix >= this.frames.length - 1 ? this.frameBounds.min.x : this.cix + 1;\r\n            }\r\n\r\n            this.update();\r\n\r\n        }\r\n\r\n    }\r\n\r\n};\r\n;/**\r\n * Created by The Blakes on 04-13-2017\r\n *\r\n * Camera : has simple x, y, z, position / Vector, follows a specific sprite\r\n *\r\n * *incomplete as of 07-20-2017\r\n */\r\n\r\n\r\nclass Camera\r\n{\r\n\r\n    constructor(position)\r\n    {\r\n\r\n      this.position = GameStack.getArg(args, 'position', GameStack.getArg(args, 'pos', new Vector3(0, 0, 0) ) );\r\n\r\n    }\r\n\r\n    follow(object, accel, max, distSize)\r\n    {\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n;\r\n/*****************\r\n *  Controls():\r\n *\r\n *  Dependencies: (1) :\r\n *      -Quick2d.GamepadAdapter, HTML5 Gamepad Api\r\n ******************/\r\n\r\nclass Controls {\r\n\r\n    constructor(args) {\r\n\r\n\r\n        this.__controller = args.controller;\r\n\r\n    }\r\n\r\n    extendedCall(call, extension)\r\n    {\r\n\r\n        var formerCall = call;\r\n\r\n        call = function(){ call(); extension(); };\r\n\r\n        return call;\r\n\r\n    }\r\n\r\n    on(key, callback)\r\n    {\r\n\r\n        if(typeof(this.__controller) == 'object' && typeof(this.__controller[key]) == 'function')\r\n        {\r\n\r\n            console.info('applying controller function:' + key);\r\n\r\n            this.__controller[key] = this.extendedCall(this.__controller[key], callback);\r\n\r\n        }\r\n        else\r\n        {\r\n            console.error('could not apply controller function');\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n\r\n\r\n;/**\r\n * Created by The Blakes on 04-13-2017\r\n *\r\n */\r\n\r\n\r\nQuick2d.Extras =  {\r\n\r\n    call(items)\r\n    {\r\n        if(!(items instanceof Array))\r\n        {\r\n\r\n          return console.error('Quick2d.Extras.call(), needs array argument');\r\n\r\n        }\r\n\r\n        //a callable item can be one-time executed: it will have any of the following functions attached\r\n\r\n        for(var x = 0; x < items.length; x++)\r\n        {\r\n            var item = items[x];\r\n\r\n            if(typeof(item.engage) == 'function')\r\n            {\r\n                item.engage();\r\n\r\n            }\r\n\r\n            if(typeof(item.fire) == 'function')\r\n            {\r\n                item.fire();\r\n\r\n            }\r\n\r\n            if(typeof(item.start) == 'function')\r\n            {\r\n                item.start();\r\n\r\n            }\r\n\r\n            if(typeof(item.run) == 'function')\r\n            {\r\n                item.run();\r\n\r\n            }\r\n\r\n            if(typeof(item.process) == 'function')\r\n            {\r\n                item.process();\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n;/**\r\n * Created by The Blakes on 04-13-2017\r\n *\r\n */\r\n\r\nclass Force\r\n{\r\n    constructor(args)\r\n    {\r\n\r\n        this.name = args.name || \"\";\r\n\r\n        this.description = args.description || \"\";\r\n\r\n        this.subjects = args.subjects || [];\r\n        this.origin =  args.origin || {};\r\n        this.massObjects = args.massObjects || [];\r\n\r\n        this.minSpeed = args.minSpeed || new Vector3(1, 1, 1);\r\n\r\n        this.max = args.max || new Vector3(3, 3, 3);\r\n         this.accel = args.accel || new Vector3(1.3, 1.3, 1.3);\r\n\r\n        for(var x in args)\r\n        {\r\n            this[x] = args[x];\r\n\r\n        }\r\n\r\n    }\r\n\r\n    getArg(args, key, fallback) {\r\n\r\n        if (args.hasOwnProperty(key)) {\r\n\r\n            return args[key];\r\n\r\n        }\r\n        else {\r\n            return fallback;\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    gravitateY()\r\n    {\r\n\r\n      var  subjects = this.subjects;\r\n\r\n       var origin =  this.origin || {};\r\n\r\n       var massObjects =  this.massObjects;\r\n\r\n      var  accel =  this.accel || {};\r\n\r\n        var max =  this.max || {};\r\n\r\n        $.each(subjects, function(ix, itemx){\r\n\r\n           itemx.accelY(accel, max);\r\n\r\n           itemx.__falling = true;\r\n\r\n            $.each(massObjects, function(iy, itemy){\r\n\r\n                itemx.collide_stop(itemy);\r\n\r\n\r\n            });\r\n        });\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n;\r\n\r\nclass FrameEffectsApi{\r\n\r\n    constructor()\r\n    {\r\n        this.__effects = [];\r\n\r\n    }\r\n\r\n    add(effect)\r\n    {\r\n        this.__effects.push(effect);\r\n\r\n    }\r\n\r\n};\r\n\r\n;/**\r\n * Created by The Blakes on 7/27/2017.\r\n */\r\n\r\nclass StatEffect{\r\n\r\n    constructor(name, value) {\r\n\r\n        this.__is = \"a game logic effect\";\r\n\r\n        this.name =name;\r\n\r\n        this.value = value;\r\n\r\n    }\r\n\r\n    process(object)\r\n    {\r\n        //if the object has any property by effect.name, the property is incremenented by effect value\r\n        //a health decrease is triggered by Effect('health', -10);\r\n\r\n\r\n        for(var x in object)\r\n        {\r\n            if(x.toLowerCase() == this.name.toLowerCase() && typeof(value) == typeof(object[x]))\r\n            {\r\n\r\n                object[x] += this.value;\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nclass Collision\r\n{\r\n    constructor({object, collideables, extras})\r\n    {\r\n        this.object = object || [];\r\n\r\n        this.collideables = collideables instanceof Array ? collideables : [];\r\n\r\n        this.extras = extras instanceof Array ? extras : []; //anything extra to execute onCollision\r\n        //note: extras are any StatEffect, Animation, Movement to be simultaneously executed with this Collision\r\n\r\n    }\r\n\r\n    Object(object)\r\n    {\r\n        this.object = object;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    Extras(extras)\r\n    {\r\n        this.extras = extras;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    Collideables(collideables)\r\n    {\r\n        this.collideables = collideables;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    onCollide(fun)\r\n    {\r\n        this.callback = fun;\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    collide()\r\n    {\r\n        this.callback();\r\n    }\r\n\r\n    process()\r\n    {\r\n        //if collision, call collide()\r\n\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n\r\nclass GameLogic {\r\n\r\n    constructor(gameEffectList)\r\n    {\r\n        if(!gameEffectList instanceof Array)\r\n        {\r\n\r\n            console.info('GameLogic: gameEffectList was not an array');\r\n\r\n            gameEffectList = [];\r\n\r\n        }\r\n\r\n       this.gameEffects = gameEffectList;\r\n\r\n    }\r\n    process_all()\r\n    {\r\n        //process all game logic objects::\r\n\r\n            for(var x = 0; x < this.gameEffects.length; x++)\r\n            {\r\n\r\n                this.gameEffects[x].process();\r\n\r\n            }\r\n\r\n    }\r\n    add(gameeffect)\r\n    {\r\n\r\n        this.gameEffects.push(gameeffect);\r\n\r\n    }\r\n\r\n}\r\n;\r\n\r\n/*****************\r\n *  GamepadAdapter:\r\n *\r\n *  Dependencies: (1) :\r\n *      -HTML5 Gamepad Api\r\n ******************/\r\n\r\nclass GamepadAdapter {\r\n\r\n    constructor() {\r\n\r\n        this.__gamepads = [];\r\n\r\n        this.intervals = [];\r\n\r\n        let controller_stack = this;\r\n\r\n        let _gpinst = this;\r\n\r\n        this.events = [];\r\n\r\n        window.setInterval(function () {\r\n\r\n            var gps = navigator.getGamepads();\r\n\r\n            _gpinst.gps = gps;\r\n\r\n            for(var x = 0; x < gps.length; x++) {\r\n\r\n            var events = _gpinst.__gamepads[x] ? _gpinst.__gamepads[x] : {};\r\n\r\n             _gpinst.process(gps[x], events);\r\n\r\n            }\r\n\r\n\r\n        }, 20);\r\n\r\n\r\n\r\n    }\r\n\r\n    gamepads()\r\n    {\r\n\r\n        return  navigator.getGamepads();\r\n\r\n    }\r\n\r\n\r\n    disconnect_all() {\r\n\r\n        for (var x = 0; x < this.intervals.length; x++) {\r\n\r\n            window.clearInterval(this.intervals[x]);\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    disconnect_by_index(game_pad_index) {\r\n\r\n        window.clearInterval(this.intervals[game_pad_index]);\r\n\r\n    }\r\n\r\n    hasAnyPad() {\r\n        return \"getGamepads\" in navigator;\r\n\r\n    }\r\n\r\n    Event(key, game_pad, callback) {\r\n        return {\r\n\r\n            key: key, game_pad:game_pad, callback: callback\r\n\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    GamepadEvents(args)\r\n    {\r\n\r\n        var gp = {};\r\n\r\n        gp.stick_left = args.stick_left || function(x, y)\r\n        {\r\n\r\n          //  console.log('Def call');\r\n\r\n        }\r\n\r\n\r\n        gp.stick_right = args.stick_right ||  function(x, y)\r\n        {\r\n\r\n        }\r\n\r\n        gp.buttons = [];\r\n\r\n        gp.extendFunc = function(f1, f2)\r\n        {\r\n\r\n            var fc = f2;\r\n\r\n           return function(x, y){\r\n\r\n                f2(x, y);\r\n\r\n               f1(x, y);\r\n\r\n            }\r\n\r\n\r\n        };\r\n\r\n        gp.on = function(key, callback)\r\n        {\r\n\r\n            if(this[key] && key !== \"on\")\r\n            {\r\n\r\n                var current_cb =  typeof(this[key]) == 'function' ? this[key] : function(x, y){};\r\n\r\n               this[key] = this.extendFunc(callback, current_cb);\r\n\r\n\r\n            }\r\n\r\n            else if(key.indexOf('button') >= 0 && key.indexOf('_') >= 0 )\r\n            {\r\n                var parts = key.split('_');\r\n\r\n                var number;\r\n\r\n                try\r\n                {\r\n\r\n                    number = parseInt(parts[1]);\r\n\r\n\r\n                    var current_cb =  typeof(this['buttons'][number]) == 'function' ? this['buttons'][number] : function(x, y){};\r\n\r\n                    this['buttons'][number] = this.extendFunc(callback, current_cb);\r\n\r\n                }\r\n                catch (e)\r\n                    {\r\n                      console.error('could not parse \"on\" event with ' + key);\r\n\r\n                    }\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n        this.__gamepads.push(gp);\r\n\r\n        return gp;\r\n\r\n    }\r\n\r\n\r\n\r\n    process(gp, gpEvents)\r\n    {\r\n\r\n        this.process_buttons(gp, gpEvents);\r\n\r\n        this.process_axes(gp, gpEvents);\r\n\r\n    }\r\n\r\n\r\n    process_axes(gp, events)\r\n    {\r\n\r\n        if(!gp || !gp['axes'])\r\n        {\r\n\r\n            return false;\r\n\r\n        }\r\n\r\n\r\n        for (var i = 0; i < gp.axes.length; i += 2) {\r\n            var axis1 = gp.axes[i], axia2 = gp.axes[i + 1];\r\n\r\n            var ix = (Math.ceil(i / 2) + 1), x = gp.axes[i], y = gp.axes[i + 1];\r\n\r\n\r\n\r\n            if(ix == 1 && events.stick_left)\r\n            {\r\n                events.stick_left(x, y);\r\n\r\n            }\r\n\r\n            if(ix == 2 && events.stick_right)\r\n            {\r\n                events.stick_right(x, y);\r\n\r\n            }\r\n\r\n            if (this.events && this.events['stick_' + i] && typeof(this.events['stick_' + i].callback) == 'function') {\r\n                this.events['stick_' + i].callback();\r\n\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n    process_buttons(gp, events) {\r\n\r\n        if(!gp || !gp['buttons'])\r\n        {\r\n             return false;\r\n\r\n        }\r\n\r\n        for (var i = 0; i < gp.buttons.length; i++) {\r\n\r\n            if (gp.buttons[i].pressed) {\r\n\r\n               // console.log('button:' + i);\r\n\r\n                    if (typeof(events.buttons[i]) == 'function') {\r\n                        events.buttons[i](gp.buttons[i].pressed);\r\n                    }\r\n                    else if (typeof( events.buttons[i]) == 'object' && typeof(events.buttons[i].update) == 'function') {\r\n                        events.buttons[i].update(events.buttons[i].pressed);\r\n\r\n                    }\r\n\r\n                var clearance_1 = this.events && this.events[i], gpc, bkey = \"button_\" + i;\r\n\r\n                if (clearance_1) {\r\n                    gpc = this.events[bkey] && !isNaN(this.events[bkey].game_pad) ? this.gamepads[this.events[bkey].game_pad] : this.events[bkey].game_pad;\r\n                }\r\n                ;\r\n\r\n                if (clearance_1 && gpc && typeof(this.events[bkey].callback) == 'function') {\r\n                    //call the callback\r\n                    this.events[i].callback();\r\n\r\n                }\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n    on(key, gpix, callback) {\r\n\r\n        if(gpix >= this.__gamepads.length)\r\n        {\r\n\r\n            this.__gamepads.push(this.GamepadEvents({}));\r\n\r\n        }\r\n\r\n        this.__gamepads[gpix].on(key, callback);\r\n\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n\r\n\r\nif(!__gameInstance.GamepadAdapter)\r\n{\r\n    __gameInstance.GamepadAdapter = new GamepadAdapter();\r\n\r\n    __gameInstance.gamepads = [];\r\n\r\n    GameStack.GamepadAdapter = __gameInstance.GamepadAdapter;\r\n\r\n    GameStack.gamepads = __gameInstance.gamepads;\r\n\r\n    GameStack.GamepadAdapter.on('stick_left', 0, function(x, y){\r\n\r\n        console.log('Gamepad stick left');\r\n\r\n    });\r\n\r\n    GameStack.GamepadAdapter.on('button_0', 0, function(x, y){\r\n\r\n        console.log('Gamepad button 0');\r\n\r\n    });\r\n\r\n\r\n    GameStack.GamepadAdapter.on('button_1', 0, function(x, y){\r\n\r\n        console.log('Gamepad button 1');\r\n\r\n    });\r\n\r\n    GameStack.GamepadAdapter.on('button_2', 0, function(x, y){\r\n\r\n        console.log('Gamepad button 2');\r\n\r\n    });\r\n\r\n    GameStack.GamepadAdapter.on('button_3', 0, function(x, y){\r\n\r\n        console.log('Gamepad button 3');\r\n\r\n    });\r\n\r\n   // __gameInstance.gamepads.push(gamepad);\r\n\r\n};\r\n\r\n\r\n\r\n;/**\r\n * Created by Jordan Blake on 04-13-2017\r\n *\r\n */\r\nclass GravityAction\r\n{\r\n    constructor()\r\n    {\r\n\r\n    }\r\n\r\n}\r\n\r\nclass Graviton {\r\n    constructor(args) {\r\n\r\n    }\r\n}\r\n\r\nclass GravitationalRay {\r\n    constructor(args) {\r\n\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n;/**\r\n * Created by The Blakes on 04-13-2017\r\n *\r\n */\r\n\r\nclass Motion {\r\n    constructor(args) {\r\n\r\n        this.getArg = $Q.getArg;\r\n\r\n        this.distance = this.getArg(args, 'distance', this.getArg(args, 'distances', false));\r\n\r\n        this.curvesList = this.curvesObject(); //Tween.Easing\r\n\r\n        this.parent_id = args.parent_id || args.object_id || \"__blank\"; //The parent object\r\n\r\n        this.curve = this.getArg(args, 'curve', TWEEN.Easing.Quadratic.InOut);\r\n\r\n        this.targetRotation = this.getArg(args, 'targetRotation', 0);\r\n\r\n        this.name = this.getArg(args, 'name', \"__\");\r\n\r\n        this.description = this.getArg(args, 'description', false);\r\n\r\n        this.curveString = this.getCurveString(); //store a string key for the Tween.Easing || 'curve'\r\n\r\n        this.setCurve(this.curveString);\r\n\r\n        this.line = this.getArg(args, 'line', false);\r\n\r\n        this.duration = this.getArg(args, 'duration', 500);\r\n\r\n        this.delay = this.getArg(args, 'delay', 0);\r\n\r\n        this.duration = this.getArg(args, 'duration', false);\r\n\r\n\r\n    }\r\n\r\n\r\n    curvesObject() {\r\n\r\n        var c = [];\r\n\r\n        GameStack.each(TWEEN.Easing, function (ix, easing) {\r\n\r\n            GameStack.each(easing, function (iy, easeType) {\r\n\r\n                if (['in', 'out', 'inout'].indexOf(iy.toLowerCase()) >= 0) {\r\n\r\n                    c.push(ix + \"_\" + iy);\r\n\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n\r\n        return c;\r\n\r\n    }\r\n\r\n\r\n    getCurveString() {\r\n\r\n        var __inst = this;\r\n\r\n        var c;\r\n\r\n        $.each(TWEEN.Easing, function (ix, easing) {\r\n\r\n            $.each(TWEEN.Easing[ix], function (iy, easeType) {\r\n\r\n\r\n                if (__inst.curve == TWEEN.Easing[ix][iy]) {\r\n\r\n                    c = ix + \"_\" + iy;\r\n\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n\r\n        return c;\r\n\r\n    }\r\n\r\n\r\n    setCurve(c) {\r\n\r\n        var cps = c.split('_');\r\n\r\n        var s1 = cps[0], s2 = cps[1];\r\n\r\n\r\n        var curve = TWEEN.Easing.Quadratic.InOut;\r\n\r\n\r\n        $.each(TWEEN.Easing, function (ix, easing) {\r\n\r\n            $.each(TWEEN.Easing[ix], function (iy, easeType) {\r\n\r\n\r\n                if (ix == s1 && iy == s2) {\r\n\r\n                    // alert('setting curve');\r\n\r\n                    curve = TWEEN.Easing[ix][iy];\r\n\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n\r\n        this.curve = curve;\r\n\r\n\r\n        return curve;\r\n\r\n    }\r\n\r\n    engage() {\r\n\r\n        var tweens = [];\r\n\r\n        //construct a tween::\r\n\r\n        var __inst = this;\r\n\r\n\r\n        var objects = {};\r\n\r\n        $.each(Game.sprites, function (ix, item) {\r\n\r\n            if (item.id == __inst.parent_id) {\r\n\r\n                objects[ix] = item;\r\n\r\n            }\r\n        });\r\n\r\n\r\n        var target = {\r\n\r\n            x: __inst.distance.x + objects[0].position.x,\r\n            y: __inst.distance.y + objects[0].position.y,\r\n            z: __inst.distance.z + objects[0].position.z\r\n\r\n        };\r\n\r\n        if (__inst.targetRotation > 0 || __inst.targetRotation < 0) {\r\n\r\n\r\n            var targetR = __inst.targetRotation + objects[0].rotation.x;\r\n\r\n            //we have a target\r\n            tweens[0] = new TWEEN.Tween(objects[0].rotation)\r\n                .easing(__inst.curve || TWEEN.Easing.Elastic.InOut)\r\n\r\n                .to({x: targetR}, __inst.duration)\r\n                .onUpdate(function () {\r\n                    //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n\r\n                })\r\n                .onComplete(function () {\r\n                    //console.log(objects[0].position.x, objects[0].position.y);\r\n                    if (__inst.complete) {\r\n\r\n                        __inst.complete();\r\n\r\n                    }\r\n\r\n\r\n                });\r\n\r\n\r\n        }\r\n\r\n        //we have a target\r\n        tweens.push(new TWEEN.Tween(objects[0].position)\r\n            .easing(__inst.curve || TWEEN.Easing.Elastic.InOut)\r\n\r\n            .to(target, __inst.duration)\r\n            .onUpdate(function () {\r\n                //console.log(objects[0].position.x,objects[0].position.y);\r\n\r\n\r\n            })\r\n            .onComplete(function () {\r\n                //console.log(objects[0].position.x, objects[0].position.y);\r\n\r\n                if (__inst.complete) {\r\n\r\n                    __inst.complete();\r\n\r\n                }\r\n\r\n\r\n            }));\r\n\r\n\r\n        __inst.delay = !isNaN(__inst.delay) && __inst.delay > 0 ? __inst.delay : 0;\r\n\r\n\r\n        return {\r\n\r\n            tweens: tweens,\r\n\r\n            delay: __inst.delay,\r\n\r\n            fire: function () {\r\n\r\n                var __tweenObject = this;\r\n\r\n                window.setTimeout(function () {\r\n\r\n                    for (var x = 0; x < __tweenObject.tweens.length; x++) {\r\n\r\n                        __tweenObject.tweens[x].start();\r\n\r\n                    }\r\n\r\n                }, this.delay);\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    start() {\r\n        this.engage().fire();\r\n\r\n    }\r\n\r\n\r\n    onComplete(fun) {\r\n        this.complete = fun;\r\n\r\n    }\r\n\r\n    // obj.getGraphCanvas( $(c.domElement), value.replace('_', '.'), TWEEN.Easing[parts[0]][parts[1]] );\r\n\r\n    getGraphCanvas( t, f, c) {\r\n\r\n        var canvas = document.createElement('canvas');\r\n\r\n        canvas.id = 'curve-display';\r\n\r\n        canvas.width = 180;\r\n        canvas.height = 100;\r\n\r\n\r\n        var context = canvas.getContext('2d');\r\n        context.fillStyle = \"rgb(250,250,250)\";\r\n        context.fillRect(0, 0, 180, 100);\r\n\r\n        context.lineWidth = 0.5;\r\n        context.strokeStyle = \"rgb(230,230,230)\";\r\n\r\n        context.beginPath();\r\n        context.moveTo(0, 20);\r\n        context.lineTo(180, 20);\r\n        context.moveTo(0, 80);\r\n        context.lineTo(180, 80);\r\n        context.closePath();\r\n        context.stroke();\r\n\r\n        context.lineWidth = 2;\r\n        context.strokeStyle = \"rgb(255,127,127)\";\r\n\r\n        var position = {x: 5, y: 80};\r\n        var position_old = {x: 5, y: 80};\r\n\r\n        new TWEEN.Tween(position).to({x: 175}, 2000).easing(TWEEN.Easing.Linear.None).start();\r\n        new TWEEN.Tween(position).to({y: 20}, 2000).easing(f).onUpdate(function () {\r\n\r\n            context.beginPath();\r\n            context.moveTo(position_old.x, position_old.y);\r\n            context.lineTo(position.x, position.y);\r\n            context.closePath();\r\n            context.stroke();\r\n\r\n            position_old.x = position.x;\r\n            position_old.y = position.y;\r\n\r\n        }).start();\r\n\r\n        return canvas;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n;/**\r\n * Created by Administrator on 7/15/2017.\r\n */\r\n\r\n\r\nclass Rectangle {\r\n\r\n    constructor(min, max) {\r\n\r\n        this.min = min;\r\n        this.max = max;\r\n\r\n    }\r\n\r\n\r\n}\r\n;\r\n\r\nlet VectorBounds = Rectangle;\r\n\r\nclass VectorFrameBounds extends Rectangle {\r\n\r\n    constructor(min, max, termPoint) {\r\n\r\n        super(min, max);\r\n\r\n        this.termPoint = termPoint || new Vector3(this.max.x, this.max.y, this.max.z);\r\n\r\n    }\r\n\r\n\r\n}\r\n;\r\n\r\nclass Circle\r\n{\r\n    constructor(args) {\r\n\r\n        this.position = this.getArg(args, 'position', new Vector3(0, 0, 0));\r\n\r\n        this.radius = this.getArgs(args, 'radius', 100);\r\n\r\n    }\r\n\r\n\r\n}\r\n\r\n;class Sprite {\r\n    constructor(name, description, args) {\r\n\r\n        this.active = true; //active sprites are visible\r\n\r\n        if (typeof name == 'object') //accept first argument as full args object\r\n        {\r\n            args = name;\r\n\r\n            this.name = args.name || \"__\";\r\n\r\n            this.description = args.description || \"__\";\r\n\r\n        }\r\n        else {\r\n\r\n            this.name = name || \"__\";\r\n\r\n            this.description = description || \"__\";\r\n\r\n        };\r\n\r\n        this.__initializers = __gameStack.getArg(args, '__initializers', []);\r\n\r\n        var _spr = this;\r\n\r\n        Quazar.each(args, function (ix, item) { //apply all args\r\n\r\n            if (ix !== 'parent') {\r\n                _spr[ix] = item;\r\n            }\r\n\r\n        });\r\n\r\n        this.type = __gameStack.getArg(args, 'type', 'basic');\r\n\r\n        this.animations = __gameStack.getArg(args, 'animations', []);\r\n\r\n        this.motions = __gameStack.getArg(args, 'motions', []);\r\n\r\n        let __inst = this;\r\n\r\n        this.id = __gameStack.getArg(args, 'id', this.create_id());\r\n\r\n        this.sounds = __gameStack.getArg(args, 'sounds', []);\r\n\r\n        this.image = __gameStack.getArg(args, 'image', new GameImage(__gameStack.getArg(args, 'src', false)));\r\n\r\n        this.size = __gameStack.getArg(args, 'size', new Vector3(100, 100));\r\n\r\n        this.position = __gameStack.getArg(args, 'position', new Vector3(0, 0, 0));\r\n\r\n        this.collision_bounds = __gameStack.getArg(args, 'collision_bounds', new VectorBounds(new Vector3(0, 0, 0), new Vector3(0, 0, 0)));\r\n\r\n        this.rotation = __gameStack.getArg(args, 'rotation', new Vector3(0, 0, 0));\r\n\r\n        this.selected_animation = {};\r\n\r\n        this.speed = __gameStack.getArg(args, 'speed', new Vector3(0, 0, 0));\r\n\r\n        this.acceleration = __gameStack.getArg(args, 'acceleration', new Vector3(0, 0, 0));\r\n\r\n        this.rot_speed = __gameStack.getArg(args, 'rot_speed', new Vector3(0, 0, 0));\r\n\r\n        this.rot_accel = __gameStack.getArg(args, 'rot_accel', new Vector3(0, 0, 0));\r\n\r\n        //Apply / instantiate Sound(), Motion(), and Animation() args...\r\n\r\n        $.each(this.sounds, function (ix, item) {\r\n\r\n            __inst.sounds[ix] = new Sound(item);\r\n\r\n        });\r\n\r\n        $.each(this.motions, function (ix, item) {\r\n\r\n            __inst.motions[ix] = new Motion(item);\r\n\r\n        });\r\n\r\n\r\n        $.each(this.animations, function (ix, item) {\r\n\r\n            __inst.animations[ix] = new Animation(item);\r\n\r\n        });\r\n\r\n\r\n        //Apply initializers:\r\n\r\n        $.each(this.__initializers, function(ix, item){\r\n\r\n            __inst.onInit(item);\r\n\r\n        });\r\n\r\n        this.selected_animation = this.animations[0] || new Animation();\r\n\r\n    }\r\n\r\n\r\n    init() {\r\n\r\n\r\n    }\r\n\r\n    onInit(fun) {\r\n\r\n        if (typeof fun == 'string') {\r\n\r\n           if(this.__initializers.indexOf(fun) < 0){ this.__initializers.push(fun) };\r\n\r\n            var __inst = this;\r\n\r\n            var keys = fun.split('.');\r\n\r\n            console.log('finding init from string:' + fun);\r\n\r\n            if(!keys.length >= 2)\r\n            {\r\n                return console.error('need min 2 string keys separated by \".\"');\r\n            }\r\n\r\n            var f = Quazar.options.SpriteInitializers[keys[0]][keys[1]];\r\n\r\n            if(typeof(f) == 'function')\r\n            {\r\n                alert('found func');\r\n\r\n\r\n                __inst.init =   __inst.extendFunc(f, __inst.init);\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n        else if (typeof fun == 'function') {\r\n\r\n            console.log('extending init:');\r\n\r\n            __inst.extendFunc(initializer, this.init);\r\n\r\n\r\n        }\r\n\r\n        else if (typeof fun == 'object') {\r\n\r\n            console.log('extending init:');\r\n\r\n           console.info('Quick2D does not yet implement onInit() from arg of object type');\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     * Getters\r\n     ***************************/\r\n\r\n    get_id() {\r\n        return this.id;\r\n    }\r\n\r\n    to_map_object(size, framesize) {\r\n        this.__mapSize = new Vector3(size || this.size);\r\n\r\n        this.frameSize = new Vector3(framesize || this.size);\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    /*****************************\r\n     * Setters and Creators\r\n     ***************************/\r\n\r\n    create_id() {\r\n\r\n        return Quick2d.create_id();\r\n\r\n    }\r\n\r\n    setSize(size) {\r\n        this.size = new Vector3(size.x, size.y, size.z);\r\n\r\n        this.selected_animation.size = new Vector3(size.x, size.y, size.z);\r\n\r\n    }\r\n\r\n    setPos(pos) {\r\n        this.position = new Vector3(pos.x, pos.y, pos.z || 0);\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  assertSpeed()\r\n     *  -assert the existence of a speed{} object\r\n     ***************************/\r\n\r\n    assertSpeed() {\r\n        if (!this.speed) {\r\n\r\n            this.speed = new Vector3(0, 0, 0);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  setAnimation(anime)\r\n     *  -set the select_animation of this sprite\r\n     ***************************/\r\n\r\n    setAnimation(anime) {\r\n\r\n        if(anime instanceof Animation && this.animations.indexOf(anime) < 0)\r\n        {\r\n            this.animations.push(anime);\r\n        }\r\n\r\n        this.selected_animation = anime;\r\n\r\n        Quazar.log('declared default animation');\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  defaultAnimation(anime)\r\n     *  -set the default_animation of this sprite\r\n     *  -TODO : determine whether to implement a default animatio OR simply use setAnimation() plus selected_animation\r\n     ***************************/\r\n\r\n    defaultAnimation(anime) {\r\n\r\n        this.animations['default'] = anime;\r\n\r\n        Quazar.log('declared default animation');\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    /*****************************\r\n     * onScreen :\r\n     * -returns boolean\r\n     * -takes and requires w, h of screen\r\n     * -detects if object is on the screen\r\n     ***************************/\r\n\r\n    onScreen(w, h) {\r\n        return this.position.x + this.size.x >= 0 && this.position.x < w\r\n            && this.position.y + this.size.y >= 0 && this.position.y < h;\r\n\r\n    }\r\n\r\n    /*****************************\r\n     * Updates\r\n     ***************************/\r\n\r\n    /*****************************\r\n     * update()\r\n     * -starts empty:: is used by Quick2d.js as the main sprite update\r\n     ***************************/\r\n\r\n    update(sprite) {\r\n    }\r\n\r\n    /*****************************\r\n     * def_update()\r\n     * -applies speed and other default factors of movement::\r\n     * -is used by Quick2d.js as the system def_update (default update)\r\n     ***************************/\r\n\r\n    def_update(sprite) {\r\n\r\n        for (var x in this.speed) {\r\n\r\n            if (this.speed[x] > 0 || this.speed[x] < 0) {\r\n\r\n                this.position[x] += this.speed[x];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        for (var x in this.acceleration) {\r\n\r\n            if (this.acceleration[x] > 0 || this.acceleration[x] < 0) {\r\n\r\n                this.speed[x] += this.acceleration[x];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        for (var x in this.rot_speed) {\r\n\r\n            if (this.rot_speed[x] > 0 || this.rot_speed[x] < 0) {\r\n\r\n                this.rotation[x] += this.rot_speed[x];\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n        for (var x in this.rot_accel) {\r\n\r\n\r\n            if (this.rot_accel[x] > 0 || this.rot_accel[x] < 0) {\r\n\r\n                this.rot_speed[x] += this.rot_accel[x];\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    resolveFunctionFromDoubleKeys(keyString1, keyString2, obj, callback) {\r\n\r\n        callback(typeof obj[keyString1][keyString2] == 'function' ? obj[keyString1][keyString2] : {});\r\n\r\n    }\r\n\r\n\r\n    extendFunc(fun, extendedFunc) {\r\n\r\n        console.log('extending func');\r\n\r\n        var ef = extendedFunc;\r\n\r\n        var __inst = this;\r\n\r\n       return function () {\r\n\r\n\r\n            ef(__inst);\r\n\r\n            //any new function comes after\r\n\r\n           fun(__inst);\r\n\r\n\r\n\r\n        };\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  onUpdate(fun)\r\n     * -args: 1 function(sprite){ } //the self-instance/sprite is passed into the function()\r\n     * -overrides and maintains existing code for update(){} function\r\n     ***************************/\r\n\r\n    onUpdate(fun) {\r\n        fun = fun || function () {\r\n            };\r\n\r\n        let update = this.update;\r\n\r\n        let __inst = this;\r\n\r\n        this.update = function (__inst) {\r\n            update(__inst);\r\n            fun(__inst);\r\n        };\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  collidesRectangular(sprite)\r\n     * -args: 1 sprite object\r\n     * -returns boolean of true on collision or false on no-collision\r\n     * -TODO : add options object with highlight=true||false,\r\n     * -TODO:allow stateffects, graphiceffects into the collision function\r\n     ***************************/\r\n\r\n    collidesRectangular(sprite) {\r\n\r\n        return Quazar.Collision.spriteRectanglesCollide(sprite);\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  collidesByPixels(sprite)\r\n     *  -TODO : this function is incomplete\r\n     *  -process collision according to the non-transparent pixels of the sprite::\r\n     *  -provides a more realistic collision than basic rectangular\r\n     ***************************/\r\n\r\n    collidesByPixels(sprite) {\r\n\r\n        return console.info(\"TODO: Sprite().collidesByPixels(sprite): finish this function\");\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  shoot(sprite)\r\n     *  -fire a shot from the sprite:: as in a firing gun or spaceship\r\n     *  -takes options{} for number of shots, anglePerShot, etc...\r\n     *  -TODO: complete and test this code\r\n     ***************************/\r\n\r\n    shoot(options) {\r\n        //character shoots an animation\r\n\r\n        this.prep_key = 'shoot';\r\n\r\n        let spread = options.spread || options.angleSpread || false;\r\n\r\n        let total = options.total || options.totalBullets || options.numberBullets || false;\r\n\r\n        let animation = options.bullet || options.animation || false;\r\n\r\n        let duration = options.duration || options.screenDuration || false;\r\n\r\n        let speed = options.speed || false;\r\n\r\n        if (__gameInstance.isAtPlay) {\r\n\r\n\r\n        }\r\n        else {\r\n\r\n            this.event_arg(this.prep_key, '_', options);\r\n\r\n        }\r\n\r\n        return this;\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  animate(animation)\r\n     *  -simply animate, set the animation to the arg 'animation'\r\n     ***************************/\r\n\r\n    animate(animation) {\r\n\r\n        alert('calling animation');\r\n\r\n        if (__gameInstance.isAtPlay) {\r\n\r\n            if (animation) {\r\n                this.setAnimation(animation)\r\n            }\r\n            ;\r\n\r\n            this.selected_animation.animate();\r\n\r\n            return this;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  accelY\r\n     *  -accelerate on Y-Axis with 'accel' and 'max' (speed) arguments\r\n     *  -example-use: gravitation of sprite || up / down movement\r\n     ***************************/\r\n\r\n    accelY(accel, max) {\r\n\r\n        accel = Math.abs(accel);\r\n\r\n        if (typeof(max) == 'number') {\r\n            max = {y: max};\r\n\r\n        }\r\n\r\n        this.assertSpeed();\r\n\r\n        let diff = max.y - this.speed.y;\r\n\r\n        if (diff > 0) {\r\n            this.speed.y += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n        if (diff < 0) {\r\n            this.speed.y -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  accelX\r\n     *  -accelerate on X-Axis with 'accel' and 'max' (speed) arguments\r\n     *  -example-use: running of sprite || left / right movement\r\n     ***************************/\r\n\r\n    accelX(accel, max) {\r\n\r\n        accel = Math.abs(accel);\r\n\r\n        if (typeof(max) == 'number') {\r\n            max = {x: max};\r\n\r\n        }\r\n\r\n        this.assertSpeed();\r\n\r\n        let diff = max.x - this.speed.x;\r\n\r\n        if (diff > 0) {\r\n            this.speed.x += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n        if (diff < 0) {\r\n            this.speed.x -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    /*****************************\r\n     *  accel\r\n     *  -accelerate any acceleration -key\r\n     ***************************/\r\n\r\n    accel(prop, key, accel, max) {\r\n\r\n        accel = Math.abs(accel);\r\n\r\n        if (typeof(max) == 'number') {\r\n            max = {x: max};\r\n\r\n        }\r\n\r\n        let speed = prop[key];\r\n\r\n       // this.assertSpeed();\r\n\r\n        let diff = max.x - prop[key];\r\n\r\n        if (diff > 0) {\r\n            prop[key] += Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n        if (diff < 0) {\r\n            prop[key] -= Math.abs(diff) >= accel ? accel : diff;\r\n\r\n        }\r\n        ;\r\n\r\n    }\r\n\r\n\r\n\r\n    /*****************************\r\n     *  decel\r\n     *  -deceleration -key\r\n     ***************************/\r\n\r\n    decel(prop, key, rate) {\r\n        if (typeof(rate) == 'object') {\r\n\r\n            rate = rate.rate;\r\n\r\n        }\r\n\r\n        rate = Math.abs(rate);\r\n\r\n        if(Math.abs(prop[key]) <= rate)\r\n        {\r\n            prop[key] = 0;\r\n        }\r\n\r\n       else if (prop[key] > 0) {\r\n            prop[key] -= rate;\r\n\r\n        }\r\n        else if (prop[key] < 0) {\r\n            prop[key] += rate;\r\n\r\n        }\r\n        else {\r\n\r\n            prop[key] = 0;\r\n\r\n        }\r\n    }\r\n\r\n\r\n    /*****************************\r\n         *  decelX\r\n         *  -decelerate on the X axis\r\n         *  -args: 1 float:amt\r\n         ***************************/\r\n\r\n        deccelX(rate) {\r\n            if (typeof(rate) == 'object') {\r\n\r\n            rate = rate.rate;\r\n\r\n        }\r\n\r\n        rate = Math.abs(rate);\r\n\r\n            if(Math.abs(this.speed['x']) <= rate)\r\n            {\r\n                this.speed['x'] = 0;\r\n\r\n            }\r\n\r\n        if (this.speed['x'] > 0) {\r\n            this.speed['x'] -= rate;\r\n\r\n        }\r\n        else if (this.speed['x'] < 0) {\r\n            this.speed['x'] += rate;\r\n\r\n        }\r\n        else {\r\n\r\n            this.speed['x'] = 0;\r\n\r\n        }\r\n\r\n    }\r\n\r\n\r\n    /*****************************\r\n     *  decelY\r\n     *  -decelerate on the Y axis\r\n     *  -args: 1 float:amt\r\n     ***************************/\r\n\r\n    decelY(amt) {\r\n\r\n        amt = Math.abs(amt);\r\n\r\n        if (Math.abs(this.speed.y) <= amt) {\r\n            this.speed.y = 0;\r\n\r\n        }\r\n        else if (this.speed.y > amt) {\r\n\r\n            this.speed.y -= amt;\r\n        }\r\n        else if (this.speed.y < amt * -1) {\r\n\r\n            this.speed.y += amt;\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  decelX\r\n     *  -decelerate on the X axis\r\n     *  -args: 1 float:amt\r\n     ***************************/\r\n\r\n    decelX(amt) {\r\n\r\n        amt = Math.abs(amt);\r\n\r\n\r\n        if (this.speed.x > amt) {\r\n\r\n            this.speed.x -= amt;\r\n        }\r\n        else if (this.speed.x < amt * -1) {\r\n\r\n            this.speed.x += amt;\r\n        }\r\n\r\n        if (Math.abs(this.speed.x) <= amt) {\r\n\r\n            this.speed.x = 0;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  collide_stop(item)\r\n     *  -both collide and stop on the object, when falling on Y axis::\r\n     *  -sets the special property: __falling to false on stop :: helps to control Sprite() state\r\n     *  -TODO : rename to fallstop || something that resembles a function strictly on Y-Axis\r\n     ***************************/\r\n\r\n    collide_stop(item) {\r\n\r\n        var max_y = item.max ? item.max.y : item.position.y;\r\n\r\n        if (this.position.y + this.size.y >= max_y) {\r\n\r\n            this.position.y = max_y - this.size.y;\r\n\r\n            this.__falling = false;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /*****************************\r\n     *  fromFile(file_path)\r\n     *  -TODO : complete this function based on code to load Sprite() from file, located in the spritemaker.html file\r\n     *  -TODO: test this function\r\n     ***************************/\r\n\r\n    fromFile(file_path) {\r\n        var __inst = this;\r\n\r\n        $.getJSON(file_path, function (data) {\r\n\r\n            __inst = new Sprite(data);\r\n\r\n        });\r\n\r\n    }\r\n\r\n};\r\n\r\n/****************\r\n * TODO : Complete SpritePresetsOptions::\r\n *  Use these as options for Sprite Control, etc...\r\n ****************/\r\n\r\n\r\nlet SpriteInitializersOptions = {\r\n\r\n    ControllerStickMotion: {\r\n\r\n        __args: {},\r\n\r\n        player_move_x: function (sprite) {\r\n\r\n            alert('applying initializer');\r\n\r\n            console.log('side_scroll_player_run:init-ing');\r\n\r\n            let __lib = Quazar || Quick2d;\r\n\r\n            Quazar.GamepadAdapter.on('stick_left', 0, function (x, y) {\r\n\r\n                console.log('stick-x:' + x);\r\n\r\n                if(Math.abs(x) < 0.2)\r\n                {\r\n                    return 0;\r\n                }\r\n\r\n                var  accel =  0.2; //todo : options for accel\r\n                var  max =  7;\r\n\r\n                sprite.accelX(accel, x * max);\r\n\r\n                if (x < -0.2) {\r\n                    sprite.flipX = true;\r\n\r\n                }\r\n                else if (x > 0.2) {\r\n                    sprite.flipX = false;\r\n\r\n                }\r\n\r\n            });\r\n\r\n            sprite.onUpdate(function (spr) {\r\n\r\n                spr.decelX(0.1);\r\n\r\n                if (!spr.__falling) {\r\n                    spr.decelY(0.2)\r\n                }\r\n                ;\r\n\r\n            });\r\n\r\n\r\n        },\r\n\r\n        player_move_xy: function (sprite) {\r\n\r\n            alert('applying initializer');\r\n\r\n            console.log('side_scroll_player_run:init-ing');\r\n\r\n            let __lib = Quazar || Quick2d;\r\n\r\n            Quazar.GamepadAdapter.on('stick_left', 0, function (x, y) {\r\n\r\n                console.log('stick-x:' + x);\r\n\r\n                if(Math.abs(x) < 0.2)\r\n                {\r\n                    x = 0;\r\n                }\r\n\r\n                if(Math.abs(y) < 0.2)\r\n                {\r\n                    y = 0;\r\n                }\r\n\r\n                var  accel =  0.2; //todo : options for accel\r\n                var  max =  7;\r\n\r\n                sprite.accelX(accel, x * max);\r\n\r\n                sprite.accelY(accel, y * max);\r\n\r\n                if (x < -0.2) {\r\n                    sprite.flipX = true;\r\n\r\n                }\r\n                else if (x > 0.2) {\r\n                    sprite.flipX = false;\r\n\r\n                }\r\n\r\n            });\r\n\r\n            sprite.onUpdate(function (spr) {\r\n\r\n                sprite.decel(sprite.speed, 'x', 0.1);\r\n\r\n                sprite.decel(sprite.speed, 'y', 0.1);\r\n\r\n            });\r\n\r\n\r\n        },\r\n\r\n        player_rotate_x: function (sprite) {\r\n\r\n            alert('applying initializer');\r\n\r\n\r\n            let __lib = Quazar || Quick2d;\r\n\r\n            Quazar.GamepadAdapter.on('stick_left', 0, function (x, y) {\r\n\r\n                console.log('stick-x:' + x);\r\n\r\n                if(Math.abs(x) < 0.2)\r\n                {\r\n                    return 0;\r\n                }\r\n\r\n                var  accel =  0.25; //todo : options for accel\r\n                var  max =  7;\r\n\r\n                sprite.accel(sprite.rot_speed, 'x', accel, x * max);\r\n\r\n                if (x < -0.2) {\r\n                    sprite.flipX = true;\r\n\r\n                }\r\n                else if (x > 0.2) {\r\n                    sprite.flipX = false;\r\n\r\n                }\r\n\r\n            });\r\n\r\n            sprite.onUpdate(function (spr) {\r\n\r\n                sprite.decel(sprite.rot_speed, 'x', 0.1);\r\n\r\n                if (!spr.__falling) {\r\n                    spr.decelY(0.2)\r\n                }\r\n                ;\r\n\r\n            });\r\n\r\n\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n};\r\n\r\nQuazar.options = Quazar.options || {};\r\n\r\nQuazar.options.SpriteInitializers = SpriteInitializersOptions;;\r\n//Vector3:\r\n\r\nclass Vector3 {\r\n    constructor(x, y, z, r) {\r\n\r\n        if(typeof(x) == 'object' && x.x && x.y) //optionally pass vector3\r\n        {\r\n            this.x = x.x;\r\n            this.y = x.y;\r\n            this.z = x.z || 0;\r\n\r\n            return this;\r\n        }\r\n\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n        this.r = r;\r\n\r\n        this.__relativeTo = false;\r\n\r\n    }\r\n\r\n    relativeTo(v)\r\n    {\r\n        this.__relativeTo = v;\r\n    }\r\n\r\n    sub(v)\r\n    {\r\n        if(typeof(v) == 'number')\r\n        {\r\n            v = {x:v, y:v, z:v};\r\n        };\r\n\r\n        return new Vector3(this.x - v.x, this.y - v.y, this.z - v.z);\r\n\r\n    }\r\n\r\n    add(v)\r\n    {\r\n        if(typeof(v) == 'number')\r\n        {\r\n            v = {x:v, y:v, z:v};\r\n        };\r\n\r\n        return new Vector3(this.x + v.x, this.y + v.y, this.z + v.z);\r\n\r\n    }\r\n\r\n    mult(v)\r\n    {\r\n        if(typeof(v) == 'number')\r\n        {\r\n            v = {x:v, y:v, z:v};\r\n        };\r\n\r\n        return new Vector3(this.x * v.x, this.y * v.y, this.z * v.z);\r\n\r\n    }\r\n    div(v)\r\n    {\r\n        if(typeof(v) == 'number')\r\n        {\r\n            v = {x:v, y:v, z:v};\r\n        };\r\n\r\n        return new Vector3(this.x / v.x, this.y / v.y, this.z / v.z);\r\n    }\r\n\r\n    round()\r\n    {\r\n        return new Vector3(Math.round(this.x), Math.round(this.y), Math.round(this.z));\r\n\r\n    }\r\n    floor()\r\n    {\r\n        return new Vector3(Math.floor(this.x), Math.floor(this.y), Math.floor(this.z));\r\n\r\n    }\r\n    ceil()\r\n    {\r\n        return new Vector3(Math.ceil(this.x), Math.ceil(this.y), Math.ceil(this.z));\r\n\r\n    }\r\n\r\n    diff()\r\n    {\r\n        //TODO:this function\r\n\r\n\r\n    }\r\n\r\n    abs_diff()\r\n    {\r\n        //TODO:this function\r\n\r\n    }\r\n\r\n    is_between(v1, v2)\r\n    {\r\n       //TODO : overlap vectors return boolean\r\n\r\n    }\r\n\r\n}\r\n;\r\n\r\nlet Pos = Vector3, Size = Vector3, Position = Vector3, Vector2 = Vector3, Vector = Vector3, Rotation = Vector3;\r\n\r\n//The above are a list of synonymous expressions for Vector3. All of these do the same thing in this library (store x,y,z values)\r\n;/**\r\n * Created by The Blakes on 04-13-2017\r\n *\r\n */\r\n\r\n\r\nclass InterfaceCallback\r\n{\r\n    constructor({name, description, callback})\r\n    {\r\n\r\n       this.name = name;\r\n\r\n       this.description = description;\r\n\r\n       this.callback = callback || function(){ console.info('The call was empty'); };\r\n\r\n    }\r\n\r\n    run()\r\n    {\r\n\r\n        this.callback();\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nclass SpeechInterfaceStructure\r\n{\r\n    constructor({name, description})\r\n    {\r\n        this.name = name || \"Program helper.\";\r\n\r\n        this.description = description || \"An interface for the game-builder program.\";\r\n\r\n        this.options_structure = {\r\n\r\n        scroll:function(x, y){}, //simple scroll controller\r\n\r\n\r\n\r\n        create_object_resource:{\r\n\r\n            constructors:Quazar.IF.__allConstructors(),\r\n\r\n            selectedType:false,\r\n\r\n            selectByName:Quazar.IF.selectByName,\r\n\r\n            apply_speech_value:Quazar.IF.applySpeechValue()\r\n\r\n        }, //apply each class in the program, with means of creating / instantiating\r\n\r\n        save_object_resource:{\r\n\r\n            selected_object:false,\r\n\r\n            confirm:Quazar.IF.confirmation()\r\n\r\n        }, //apply each class in the program, with means of saving\r\n\r\n        retrieve_object_resource:{}, //retrieve\r\n\r\n        browse_object_resources:{}, //browsing\r\n\r\n        search_object_resources:{}, //searching\r\n\r\n        delete_object_resources:{}, //delete\r\n\r\n        apply_value:{} //apply a value to an object resource\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]}