{"version":3,"sources":["../../../ecma/Protocol/concat/Protocol.js"],"names":["Game","__gameInstance","ResourceApi","args","__constructors","constructors","__onGet","onGet","Array","constructor","callback","get","__inst","$","each","ix","item","get_all_by_type","name","c","String","data","contents","indexOf","e","alert","console","error","post","filename","info","jstr"],"mappings":";;;;;;AACA,IAAIA,OAAOC,kBAAkB,EAA7B;;AAEA;;;;;;;IAOMC,W;AAEF,6BAAYC,IAAZ,EAAkB;AAAA;;AAEd,qBAAKC,cAAL,GAAsBD,KAAKE,YAA3B;;AAEA,qBAAKC,OAAL,GAAeH,KAAKI,KAAL,IAAc,YAAU,CAAE,CAAzC;;AAEA,oBAAG,CAAC,KAAKH,cAAN,YAAgCI,KAAnC,EACA;;AAEI,6BAAKJ,cAAL,GAAsB,EAAtB;AAEH;AAEJ;;;;gDAEeK,W,EAAaC,Q,EAC7B;AACI,6BAAKC,GAAL,CAASF,WAAT,EAAsB,GAAtB,EAA2BC,QAA3B;AAEH;;;wCAEOA,Q,EACR;AACI,4BAAIE,SAAS,IAAb;;AAEAC,0BAAEC,IAAF,CAAO,KAAKV,cAAZ,EAA4B,UAASW,EAAT,EAAaC,IAAb,EAAkB;;AAE1CJ,uCAAOK,eAAP,CAAuBD,IAAvB,EAA6BN,QAA7B;AAEH,yBAJD;AAMH;;;oCAEGD,W,EAAaS,I,EAAMR,Q,EACvB;AACI,4BAAIS,IAAIV,uBAAuBW,MAAvB,GAAgCD,CAAhC,GAAoCA,EAAED,IAA9C;;AAEA,4BAAIN,SAAS,IAAb;;AAEAC,0BAAEF,GAAF,CAAM,gBAAgBQ,CAAhB,GAAoB,GAApB,GAA0BD,IAAhC,EAAsC,UAASG,IAAT,EAAc;;AAEhDX,yCAASW,IAAT;;AAEA,oCAAG,OAAOT,OAAON,OAAd,IAA0B,UAA7B,EACA;AACIM,+CAAOL,KAAP,CAAac,IAAb;AAEH;AAEJ,yBAVD;AAYH;;;qCAEIZ,W,EAAaS,I,EAAMI,Q,EAAU;AAClC;AACI,4BAAIH,IAAIV,uBAAuBW,MAAvB,GAAgCD,CAAhC,GAAoCA,EAAED,IAA9C;;AAEA,4BAAGA,KAAKK,OAAL,CAAa,OAAb,KAAyB,CAA5B,EACA;AACI,oCAAIC,IAAI,qDAAR;;AAEAC,sCAAOD,CAAP;;AAEA,uCAAOE,QAAQC,KAAR,CAAcH,CAAd,CAAP;AAEH;;AAEDX,0BAAEe,IAAF,CAAO,gBAAgBT,CAAhB,GAAoB,GAApB,GAA0BD,IAA1B,GAAiC,GAAxC,EAA6C,EAACW,UAASX,IAAV,EAAgBI,UAASA,QAAzB,EAA7C,EAAiF,UAASD,IAAT,EAAc;;AAE3FK,wCAAQI,IAAR,CAAaC,KAAKV,IAAL,CAAb;AAEH,yBAJD;AAMH;;;;;;AAEJ","file":"Protocol.js","sourcesContent":["\r\nlet Game = __gameInstance || {};\r\n\r\n/*****************\r\n *  ResourceApi():\r\n *\r\n *  Dependencies: (1) :\r\n *      -$JQuery : ajax\r\n ******************/\r\n\r\nclass ResourceApi {\r\n\r\n    constructor(args) {\r\n\r\n        this.__constructors = args.constructors;\r\n\r\n        this.__onGet = args.onGet || function(){};\r\n\r\n        if(!this.__constructors instanceof Array)\r\n        {\r\n\r\n            this.__constructors = [];\r\n\r\n        }\r\n\r\n    }\r\n\r\n    get_all_by_type(constructor, callback)\r\n    {\r\n        this.get(constructor, '*', callback);\r\n\r\n    }\r\n\r\n    get_all(callback)\r\n    {\r\n        let __inst = this;\r\n\r\n        $.each(this.__constructors, function(ix, item){\r\n\r\n            __inst.get_all_by_type(item, callback);\r\n\r\n        });\r\n\r\n    }\r\n\r\n    get(constructor, name, callback)\r\n    {\r\n        var c = constructor instanceof String ? c : c.name;\r\n\r\n        var __inst = this;\r\n\r\n        $.get('/resources/' + c + '/' + name, function(data){\r\n\r\n            callback(data);\r\n\r\n            if(typeof(__inst.__onGet) == 'function')\r\n            {\r\n                __inst.onGet(data);\r\n\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    save(constructor, name, contents) //TOTEST:\r\n    {\r\n        var c = constructor instanceof String ? c : c.name;\r\n\r\n        if(name.indexOf('.json') >= 0)\r\n        {\r\n            var e = '\".json\" is not allowed in the name of saved objects';\r\n\r\n            alert( e );\r\n\r\n            return console.error(e);\r\n\r\n        }\r\n\r\n        $.post('/resources/' + c + '/' + name + '?', {filename:name, contents:contents}, function(data){\r\n\r\n            console.info(jstr(data));\r\n\r\n        });\r\n\r\n    }\r\n\r\n};\r\n\r\n\r\n\r\n\r\n"]}