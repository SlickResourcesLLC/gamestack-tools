{"version":3,"sources":["../ecma/Quazar.js"],"names":["Vector3","x","y","z","r","Vector2","Point","Size","Vertex","Rotation","Rot","Position","Pos","VectorBounds","min","max","Force","args","orect","subjects","force","decay","orientation","physicalForceCallback","object","keys","boolCall","p","v","eval_props","value","position","ActionStack","GameSound","src","onCreate","parts","split","ext","length","indexOf","Quazar","log","sound","Audio","play","GameImage","image","document","createElement","domElement","onload","__gameInstance","DEBUG","samples","log_modes","log_mode","recursionCount","interlog","message","div","isNaN","error","quit","Error","console","req","m","REQS","info","mustHave","obj","keytypes","callback","each","ix","item","TWEEN","_gameWindow","setGameWindow","gameWindow","getGameWindow","assignAll","$Q","list","onResult","onComplete","i","ready_callstack","ready","push","onReady","funx","lib","call","isAtPlay","getArg","key","fallback","hasOwnProperty","QUAZAR","$q","InputEvents","mousemove","leftclick","rightclick","middleclick","wheelup","wheelDown","space","tab","shift","enter","extend","evt_key","onFinish","toLowerCase","cleanKey","down","up","init","getMousePos","e","pageX","pageY","clientX","body","scrollLeft","documentElement","clientY","scrollTop","canvas","offsetLeft","offsetTop","fullMoveInputEvents","event","pos","Array","el","onkeydown","String","fromCharCode","keyCode","onkeyup","onmousedown","which","preventDefault","onmouseup","addEventListener","window","_preQuazar_windowLoad","Canvas","draw","sprite","ctx","active","onScreen","Game","WIDTH","HEIGHT","drawPortion","drawFrameWithRotation","img","fx","fy","fw","fh","width","height","deg","canvasContextObj","flip","save","Math","round","rad","PI","translate","rotate","scale","drawImage","restore","frame","selected_animation","selected_frame","camera","targetSize","gameSize","size","realWidth","realHeight","offset","rotation","framePos","frameSize","flipX","Collection","type","__flyingIndex","splice","gui","fui","addFolder","testObject","o","add","onChange","updateDisplay","__prev","__checkbox","checked","GameWindow","sprites","backgrounds","interactives","forces","update","sprite_set","background_set","interactive_set","force_set","actionstack_set","c","constructor","Sprite","Background","Interactive","stackables","sound_set","animation_set","tweenstack_set","allchecks","concat","_gw","TweenStack","tweens","curves","JSON","parse","stringify","Curves","property","target","duration","cancel","repeat","curve","targetObject","start","tweenObject","Easing","cs","TextDisplay","font","text","color","VideoDisplay","undefined","Animation_Samples","Animation","parent","frameBounds","Sprite_Samples","frog","setAnimation","barrel","event_args_list"],"mappings":"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","file":"Quazar.js","sourcesContent":["/**\r\n * Created by The Blakes on 3/16/2017.\r\n */\r\n\r\n\r\n/**\r\n * Created by The Blakes on 3/16/2017.\r\n */\r\n\r\n\r\n\r\n/*\r\n * Vector3\r\n *\r\n *    multi instantiator for size, pos, rotation, anything with X,Y, and Z (or just x and y)\r\n *\r\n *\r\n * */\r\n\r\n\r\n\r\n\r\n\r\nclass Vector3 {\r\n    constructor(x, y, z, r) {\r\n\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n        this.r = r;\r\n\r\n    }\r\n\r\n\r\n}\r\n;\r\n\r\nlet Vector2 = Vector3, Point = Vector3, Size = Vector3, Vertex = Vector3, Rotation = Vector3, Rot = Vector3, Position = Vector3,\r\n\r\n    Pos = Vector3;\r\n\r\n\r\n\r\n\r\nclass VectorBounds {\r\n\r\n    constructor(min, max) {\r\n\r\n        this.min = min;\r\n        this.max = max;\r\n\r\n    }\r\n\r\n\r\n}\r\n;\r\n\r\n\r\n\r\n\r\nclass Force {\r\n\r\n    constructor(args) {\r\n\r\n        this.orect = args.orect || VectorBounds();\r\n\r\n        this.subjects = args.subjects;\r\n\r\n        this.force = args.force || 0; //-1.0 to 1.0\r\n\r\n        this.decay = args.decay || 0;\r\n\r\n        this.orientation = args.orientation || 'long';\r\n\r\n        //TODO: process physics such that orntn of 'long' and force of 1.0 will push objects away at full force\r\n\r\n        this.physicalForceCallback = args.physicalForceCallback;\r\n\r\n    }\r\n\r\n    eval_props(object, keys, boolCall) {\r\n\r\n        for (var x in keys) {\r\n\r\n            if (boolCall(object[x])) {\r\n\r\n                return object;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return false;\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        for (var p in this.subjects) {\r\n\r\n\r\n            var v = this.physicalForceCallback(p, this);\r\n\r\n            if (this.eval_props(v, function (value) {\r\n                    return value >= 0.1 || false\r\n                })) {\r\n\r\n                p.position.x += v.x;\r\n\r\n                p.position.y += v.y;\r\n\r\n                p.position.z += v.z;\r\n\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n;\r\n\r\n\r\n\r\nclass ActionStack {\r\n    constructor() {\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nclass GameSound {\r\n\r\n    constructor(src, onCreate) {\r\n\r\n        if (src) {\r\n\r\n            this.src = src;\r\n\r\n            let parts = src.split('.'), ext = parts[parts.length - 1];\r\n\r\n            if (['mp3', 'wav', 'flac'].indexOf(ext) >= 0) {\r\n                //treat as sound\r\n\r\n                Quazar.log('initializing audio sound');\r\n\r\n                this.sound = new Audio(src);\r\n\r\n                this.onCreate = onCreate;\r\n\r\n                if (typeof(this.onCreate) == 'function') {\r\n\r\n                    this.onCreate(this.sound);\r\n\r\n                }\r\n\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    play() {\r\n        if (typeof(this.sound) == 'object' && typeof(this.sound.play) == 'function') {\r\n\r\n            this.sound.play();\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nclass GameImage {\r\n\r\n    constructor(src, onCreate) {\r\n\r\n        if (src) {\r\n\r\n            this.src = src;\r\n\r\n            let parts = src.split('.'), ext = parts[parts.length - 1];\r\n\r\n            if (['png', 'jpg', 'gif'].indexOf(ext) >= 0) {\r\n\r\n                this.image = document.createElement('IMG');\r\n\r\n                this.image.src = src;\r\n\r\n                Quazar.log('initializing image');\r\n\r\n\r\n                this.domElement = this.image;\r\n\r\n                this.image.onload = function () {\r\n\r\n                    if (typeof(this.onCreate) == 'function') {\r\n\r\n                        this.onCreate(this.image);\r\n\r\n                    }\r\n\r\n\r\n                }\r\n\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    getImage() {\r\n\r\n        return this.image;\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n//Quazar: a main / game lib object::\r\n\r\n\r\nlet __gameInstance = __gameInstance || {};\r\n\r\n\r\n\r\nlet Quazar = {\r\n\r\n    DEBUG: false,\r\n\r\n\r\n\r\n    samples: {},\r\n\r\n    log_modes:['reqs', 'info', 'warning'],\r\n\r\n    log_mode:\"all\",\r\n\r\n    recursionCount:0,\r\n\r\n    interlog:function(message, div) //recursive safe :: won't go crazy with recursive logs\r\n    {\r\n        this.recursionCount++;\r\n\r\n        if(!isNaN(div) && this.recursionCount % div == 0)\r\n        {\r\n         //   console.log('Interval Log:'+  message);\r\n\r\n        }\r\n\r\n    },\r\n\r\n    error:function(quit, message)\r\n    {\r\n\r\n        if(quit)\r\n        {\r\n            throw new Error(message);\r\n\r\n        }\r\n        else\r\n        {\r\n            console.error('E!' + message);\r\n\r\n        }\r\n\r\n    },\r\n\r\n    req: function (m) {\r\n\r\n\r\n        if (this.REQS) {\r\n\r\n            console.info('Requirement:' + m); //info is logged like \"program guide\"\r\n\r\n\r\n        }\r\n\r\n    },\r\n\r\n    info: function (m) {\r\n\r\n            console.info('Info:' + m); //info is logged like \"program guide\"\r\n\r\n\r\n    },\r\n\r\n\r\n    log: function (m) {\r\n\r\n      //  console.log('Quazar:' + m); //info is logged like \"program guide\"\r\n\r\n\r\n    },\r\n\r\n\r\n    mustHave: function (obj, keytypes, callback) {\r\n\r\n        this.each(keytypes, function (ix, item) {\r\n\r\n            callback(false);\r\n\r\n\r\n        });\r\n\r\n\r\n        callback(true);\r\n\r\n    },\r\n\r\n\r\n\r\n    TWEEN: TWEEN,\r\n\r\n    _gameWindow: {},\r\n\r\n    setGameWindow: function (gameWindow) {\r\n\r\n        this._gameWindow = gameWindow;\r\n\r\n    },\r\n\r\n    getGameWindow: function () {\r\n\r\n\r\n        return this._gameWindow;\r\n\r\n    },\r\n\r\n    assignAll: function (object, args, keys) {\r\n        $Q.each(keys, function (ix, item) {\r\n\r\n            object[ix] = args[ix];\r\n\r\n        });\r\n\r\n\r\n    },\r\n\r\n\r\n    each: function (list, onResult, onComplete) {\r\n        for (var i in list) {\r\n            onResult(i, list[i]);\r\n        }\r\n\r\n        if (typeof(onComplete) === 'function') {\r\n            onComplete(false, list)\r\n        }\r\n        ;\r\n\r\n    },\r\n\r\n    ready_callstack: [],\r\n\r\n    ready: function (callback) {\r\n\r\n\r\n        this.ready_callstack.push(callback);\r\n\r\n    },\r\n\r\n    onReady: function () {\r\n        var funx = this.ready_callstack;\r\n\r\n        var lib = this;\r\n\r\n        this.each(funx, function (ix, call) {\r\n\r\n            call(lib);\r\n\r\n        });\r\n\r\n\r\n        __gameInstance.isAtPlay = true;\r\n\r\n\r\n    },\r\n\r\n    getArg: function (args, key, fallback) {\r\n        if (args && args.hasOwnProperty(key)) {\r\n            return args[key];\r\n\r\n        }\r\n        else {\r\n            return fallback;\r\n\r\n        }\r\n\r\n    }\r\n\r\n};\r\n\r\n__gameInstance = Quazar;\r\n\r\nlet QUAZAR = Quazar;\r\n\r\nlet $q = Quazar; let $Q = Quazar;\r\n\r\n\r\n//Store events here, including callable events\r\n\r\n\r\nQuazar.InputEvents = {\r\n    mousemove: [],\r\n    leftclick: [],\r\n    rightclick: [],\r\n    middleclick: [],\r\n    wheelup: [],\r\n    wheelDown: [],\r\n    space: [],\r\n    tab: [],\r\n    shift: [],\r\n    1: [], 2: [], 3: [],\r\n    enter: [],\r\n    extend: function (evt_key, callback, onFinish) {\r\n\r\n        if (evt_key.toLowerCase().indexOf('key_') >= 0) {\r\n            //process this as a key event\r\n\r\n            var cleanKey = evt_key.toLowerCase();\r\n            Quazar.InputEvents[cleanKey] = Quazar.InputEvents[cleanKey] || [];\r\n            return Quazar.InputEvents[cleanKey].push({down: callback, up: onFinish});\r\n        } else {\r\n\r\n            Quazar.InputEvents[evt_key] = Quazar.InputEvents[evt_key] || [];\r\n            return Quazar.InputEvents[evt_key].push({down: callback, up: onFinish});\r\n        }\r\n\r\n    },\r\n    init: function () {\r\n\r\n\r\n        function getMousePos(e) {\r\n\r\n            var x;\r\n            var y;\r\n            if (e.pageX || e.pageY) {\r\n                x = e.pageX;\r\n                y = e.pageY;\r\n            } else {\r\n                x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n                y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n            }\r\n            x -= Quazar.canvas.offsetLeft;\r\n            y -= Quazar.canvas.offsetTop;\r\n            return {x: x, y: y};\r\n        }\r\n\r\n\r\n        function fullMoveInputEvents(event) {\r\n\r\n            var pos = getMousePos(event);\r\n            var InputEvents = Quazar.InputEvents;\r\n            for (var x in InputEvents) {\r\n\r\n\r\n                if (InputEvents[x] instanceof Array && x == 'mousemove') {\r\n\r\n\r\n                    Quazar.each(InputEvents[x], function (ix, el) {\r\n\r\n                        el.down(pos.x, pos.y);\r\n                    });\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n        ;\r\n        document.onkeydown = function (e) {\r\n\r\n            //    alert(JSON.stringify(Quazar.InputEvents, true, 2));\r\n\r\n            Quazar.log('Got e');\r\n\r\n            var value = 'key_' + String.fromCharCode(e.keyCode).toLowerCase();\r\n            if (Quazar.InputEvents[value] instanceof Array) {\r\n\r\n                Quazar.log('Got []');\r\n\r\n                Quazar.each(Quazar.InputEvents[value], function (ix, item) {\r\n\r\n                    if (typeof (item.down) == 'function') {\r\n\r\n                        //   alert('RUNNING');\r\n\r\n                        item.down();\r\n                    }\r\n\r\n\r\n                });\r\n            }\r\n\r\n        }\r\n\r\n\r\n        document.onkeyup = function (e) {\r\n\r\n            //    alert(JSON.stringify(Quazar.InputEvents, true, 2));\r\n\r\n            var value = 'key_' + String.fromCharCode(e.keyCode).toLowerCase();\r\n            if (Quazar.InputEvents[value] instanceof Array) {\r\n\r\n                Quazar.each(Quazar.InputEvents[value], function (ix, item) {\r\n\r\n                    if (typeof (item.up) == 'function') {\r\n\r\n                        //   alert('RUNNING');\r\n\r\n                        item.up();\r\n                    }\r\n\r\n\r\n                });\r\n            }\r\n\r\n        };\r\n\r\n\r\n\r\n        Quazar.canvas.onmousedown = function (e) {\r\n\r\n            //    alert(JSON.stringify(Quazar.InputEvents, true, 2));\r\n\r\n            var value = e.which;\r\n            var pos = getMousePos(e);\r\n            var InputEvents = Quazar.InputEvents;\r\n\r\n\r\n            e.preventDefault();\r\n\r\n            switch (e.which) {\r\n                case 1:\r\n\r\n                    for (var x in InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'leftclick') {\r\n\r\n\r\n                            Quazar.each(InputEvents[x], function (ix, el) {\r\n\r\n\r\n                                el.down(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                case 2:\r\n                    // alert('Middle Mouse button pressed.');\r\n\r\n\r\n                    for (var x in Quazar.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'middleclick') {\r\n\r\n\r\n                            Quazar.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.down(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n                    break;\r\n                case 3:\r\n                    //  alert('Right Mouse button pressed.');\r\n\r\n\r\n                    for (var x in Quazar.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                            Quazar.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.down(pos.x, pos.y);\r\n                            });\r\n\r\n                            return false;\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                default:\r\n\r\n                    return 0;\r\n                //alert('You have a strange Mouse!');\r\n\r\n            }\r\n\r\n\r\n            e.preventDefault();\r\n            return 0;\r\n        };\r\n        Quazar.canvas.onmouseup = function (e) {\r\n\r\n            //    alert(JSON.stringify(Quazar.InputEvents, true, 2));\r\n\r\n            var value = e.which;\r\n            var pos = getMousePos(e);\r\n            var InputEvents = Quazar.InputEvents;\r\n\r\n\r\n            e.preventDefault();\r\n\r\n            switch (e.which) {\r\n                case 1:\r\n\r\n                    for (var x in InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'leftclick') {\r\n\r\n\r\n                            Quazar.each(InputEvents[x], function (ix, el) {\r\n\r\n\r\n                                el.up(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                case 2:\r\n                    // alert('Middle Mouse button pressed.');\r\n\r\n\r\n                    for (var x in Quazar.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'middleclick') {\r\n\r\n\r\n                            Quazar.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.up(pos.x, pos.y);\r\n                            });\r\n                        }\r\n\r\n\r\n                    }\r\n                    break;\r\n                case 3:\r\n                    //  alert('Right Mouse button pressed.');\r\n\r\n\r\n                    for (var x in Quazar.InputEvents) {\r\n\r\n\r\n                        if (InputEvents[x] instanceof Array && x == 'rightclick') {\r\n\r\n\r\n                            Quazar.each(InputEvents[x], function (ix, el) {\r\n\r\n                                el.up(pos.x, pos.y);\r\n                            });\r\n\r\n\r\n                            return false;\r\n\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    break;\r\n                default:\r\n\r\n                    return 0;\r\n                //alert('You have a strange Mouse!');\r\n\r\n            }\r\n\r\n\r\n        };\r\n        document.addEventListener(\"mousemove\", fullMoveInputEvents);\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n$Q = QUAZAR;\r\n\r\nwindow._preQuazar_windowLoad = window.onload;\r\n\r\nwindow.onload = function () {\r\n\r\n    //alert('window load');\r\n\r\n    if (typeof(window._preQuazar_windowLoad) == 'function') {\r\n        window._preQuazar_windowLoad();\r\n\r\n    }\r\n\r\n    $Q.onReady();\r\n\r\n}\r\n\r\n\r\n/*\r\n * Canvas\r\n *\r\n *    draw animations, textures to the screen\r\n *\r\n *\r\n * */\r\n\r\n\r\nvar Canvas = {\r\n    draw: function (sprite, ctx) {\r\n\r\n        if (sprite.active && sprite.onScreen(Game.WIDTH, Game.HEIGHT)) {\r\n\r\n            this.drawPortion(sprite, ctx);\r\n\r\n        }\r\n\r\n    },\r\n    drawFrameWithRotation: function (img, fx, fy, fw, fh, x, y, width, height, deg, canvasContextObj, flip) {\r\n\r\n        canvasContextObj.save();\r\n        deg = Math.round(deg);\r\n        deg = deg % 360;\r\n        var rad = deg * Math.PI / 180;\r\n        //Set the origin to the center of the image\r\n        canvasContextObj.translate(x, y);\r\n        canvasContextObj.rotate(rad);\r\n        //Rotate the canvas around the origin\r\n\r\n        canvasContextObj.translate(0, canvasContextObj.width);\r\n        if (flip) {\r\n\r\n            canvasContextObj.scale(-1, 1);\r\n        } else {\r\n\r\n        }\r\n\r\n        //draw the image\r\n        canvasContextObj.drawImage(img, fx, fy, fw, fh, width / 2 * (-1), height / 2 * (-1), width, height);\r\n        //reset the canvas\r\n\r\n        canvasContextObj.restore();\r\n    },\r\n\r\n\r\n    /*\r\n     * drawPortion:\r\n     *\r\n     *   expects: (sprite{selected_animation{selected_frame{frameSize, framePos } offset?, gameSize? }  })\r\n     *\r\n     *\r\n     * */\r\n\r\n\r\n    drawPortion: function (sprite, ctx) {\r\n\r\n        var frame;\r\n\r\n        if (sprite.active) {\r\n\r\n            if (sprite.selected_animation && sprite.selected_animation.selected_frame) {\r\n\r\n                frame = sprite.selected_animation.selected_frame;\r\n\r\n            }\r\n            else {\r\n\r\n                throw new Error('Sprite is missing arguments');\r\n\r\n            }\r\n\r\n\r\n            var x = sprite.pos.x;\r\n            var y = sprite.pos.y;\r\n\r\n            var camera = $Q.camera || {pos: {x: 0, y: 0, z: 0}};\r\n\r\n\r\n            if (true) {\r\n\r\n                if (!isNaN(camera.pos.x)) {\r\n\r\n                    x += camera.pos.x;\r\n                }\r\n\r\n                if (!isNaN(camera.pos.y)) {\r\n\r\n                    y += camera.pos.y;\r\n                }\r\n\r\n            }\r\n            ;\r\n\r\n\r\n            //optional animation : gameSize\r\n\r\n            var targetSize = sprite.selected_animation.gameSize ? sprite.selected_animation.gameSize : sprite.size;\r\n\r\n\r\n            var realWidth = targetSize.x;\r\n            var realHeight = targetSize.y;\r\n\r\n            //optional animation : offset\r\n\r\n            if (sprite.selected_animation.offset) {\r\n                x += sprite.selected_animation.offset.x;\r\n\r\n                y += sprite.selected_animation.offset.y;\r\n\r\n            }\r\n\r\n\r\n            var rotation = sprite.rotation;\r\n\r\n\r\n            this.drawFrameWithRotation(sprite.selected_animation.image.domElement, frame.framePos.x, frame.framePos.y, frame.frameSize.x, frame.frameSize.y, Math.round(x + (realWidth / 2)), Math.round(y + (realHeight / 2)), realWidth, realHeight, rotation % 360, ctx, sprite.flipX);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\nQuazar.ready(function (lib) {\r\n\r\n    Quazar.log('Quazar:lib :: ready');\r\n\r\n\r\n});\r\n\r\n\r\n\r\n/**\r\n *\r\n *  class: Collection:\r\n *\r\n *      Defines a Collection of objects\r\n *      #extended by  class\r\n *      functions:\r\n *          add()\r\n *          remove()GameWindow\r\n *          next()\r\n *          all()\r\n *\r\n */\r\n\r\n\r\nclass Collection {\r\n\r\n    constructor(list, type) {\r\n\r\n\r\n        this.list = list;\r\n\r\n        //if type is undefined, then no type profile is needed (assume basic array, object types)\r\n\r\n        //else the type profile must exist ::\r\n\r\n\r\n        this.type = type;\r\n\r\n\r\n\r\n        this.__flyingIndex = 0;\r\n\r\n    }\r\n\r\n    add(object) {\r\n\r\n        this.list.push(object);\r\n\r\n    }\r\n\r\n    remove(object) {\r\n\r\n        var ix = this.list.indexOf(object);\r\n\r\n        if (ix >= 0)\r\n            this.list = this.list.splice(ix, 1);\r\n\r\n    }\r\n\r\n    next(callback) {\r\n        var object = this.list(this.__flyingIndex % this.list.length);\r\n\r\n        if (callback) {\r\n            return callback(object);\r\n        }//run callback with reference to the object\r\n\r\n\r\n    }\r\n\r\n    all(callback) {\r\n        Quazar.each(this.list, function (ix, item) {\r\n\r\n            callback(item); //run callback with reference to the object\r\n\r\n        });\r\n\r\n    }\r\n\r\n    toCheckableGui(gui, list, key) {\r\n\r\n        let fui = gui.addFolder(this.type);\r\n\r\n        Quazar.each(this.list, function (ix, el) {\r\n\r\n// store this reference somewhere reasonable or just look it up in\r\n// __controllers or __folders like other examples show\r\n\r\n            let testObject = {};\r\n\r\n            testObject[key] = {};\r\n\r\n            let o = fui.add(testObject, key).onChange(function (value) {\r\n\r\n              //  alert('Value changed to:' + value);\r\n\r\n                list.push(value);\r\n\r\n\r\n            });\r\n\r\n// some later time you manually update\r\n            o.updateDisplay();\r\n            o.__prev = o.__checkbox.checked;\r\n\r\n\r\n        });\r\n\r\n\r\n        return gui;\r\n\r\n\r\n    }\r\n\r\n\r\n};\r\n\r\n\r\n\r\n\r\n/**\r\n *\r\n *  class: GameWindow:\r\n *\r\n *      Requires a canvas, all sprites on canvas, and physical collective_forces on screen\r\n *\r\n *\r\n */\r\n\r\n\r\nclass GameWindow {\r\n\r\n    constructor({canvas, ctx, sprites, backgrounds, interactives, forces, update}) {\r\n\r\n        this.sprite_set = new Collection(sprites || [], 'Sprite');\r\n\r\n\r\n        this.background_set = new Collection(backgrounds || [], 'Sprite');\r\n\r\n        this.interactive_set = new Collection(interactives || [], 'Sprite');\r\n\r\n        this.force_set = new Collection(forces || [], 'Force');\r\n\r\n        this.actionstack_set = new Collection(forces || [], 'ActionStack');\r\n\r\n        this.canvas = canvas;\r\n\r\n        this.ctx = ctx;\r\n\r\n\r\n        Quazar.canvas = canvas;\r\n\r\n        Quazar.ctx = ctx;\r\n\r\n\r\n        this.update = update || function () {\r\n            };\r\n\r\n\r\n    }\r\n\r\n    add(object)\r\n    {\r\n\r\n        var c = object.constructor;\r\n\r\n        switch(c)\r\n        {\r\n\r\n            case Sprite:\r\n\r\n                this.sprite_set.add(object);\r\n\r\n                break;\r\n\r\n            case Background:\r\n\r\n                this.background_set.add(object);\r\n\r\n                break;\r\n\r\n            case Interactive:\r\n\r\n                this.interactive_set.add(object);\r\n\r\n                break;\r\n\r\n            case Force:\r\n\r\n                this.force_set.add(object);\r\n\r\n                break;\r\n\r\n\r\n            case ActionStack:\r\n\r\n                this.actionstack_set.add(object);\r\n\r\n                break;\r\n\r\n\r\n        }\r\n\r\n    }\r\n\r\n    all_checkables() {\r\n        let stackables = [\r\n\r\n            this.sound_set.list,\r\n\r\n            this.animation_set.list,\r\n\r\n            this.tweenstack_set.list\r\n\r\n        ];\r\n\r\n        let allchecks = [];\r\n\r\n        for (let x in stackables) {\r\n\r\n            allchecks = allchecks.concat(stackables[x]);\r\n\r\n        }\r\n\r\n        return allchecks;\r\n\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n\r\n        Quazar.each(this.sprite_set.list, function (ix, item) {\r\n\r\n\r\n           item.update();\r\n\r\n        });\r\n\r\n\r\n        Quazar.each(this.force_set.list, function (ix, item) {\r\n\r\n\r\n            item.update();\r\n\r\n        });\r\n\r\n        this.update();\r\n\r\n\r\n    }\r\n\r\n    update()\r\n    {\r\n\r\n        Quazar.each(this.sprite_set.list, function (ix, item) {\r\n\r\n\r\n            item.update();\r\n\r\n        });\r\n\r\n\r\n    }\r\n\r\n    draw() {\r\n\r\n        var _gw = this;\r\n\r\n        Quazar.each(this.sprite_set.list, function (ix, item) {\r\n\r\n\r\n            Canvas.draw(item, _gw.ctx);\r\n\r\n        });\r\n\r\n    }\r\n\r\n}\r\n;\r\n\r\n\r\n\r\n\r\nclass TweenStack {\r\n    constructor() {\r\n\r\n        this.tweens = [];\r\n\r\n    }\r\n\r\n    getCurveFromKey(key)\r\n    {\r\n\r\n        let keys = key.split('.');\r\n\r\n        let curves = JSON.parse(JSON.stringify(this.Curves()));\r\n\r\n\r\n\r\n        for(let x in keys)\r\n        {\r\n\r\n            if(curves[x])\r\n            {\r\n                curves = curves[x];\r\n\r\n            }\r\n\r\n\r\n        }\r\n\r\n        return curves;\r\n\r\n    }\r\n\r\n    custom_tween(args)\r\n    {\r\n\r\n        return args;\r\n\r\n    }\r\n\r\n    add(args) {\r\n\r\n        // create the tween\r\n\r\n\r\n        let property = Quazar.getArg(args, 'prop', Quazar.getArg(args, 'property', false));\r\n\r\n\r\n        let target = Quazar.getArg(args, 'target', false);\r\n        let object = Quazar.getArg(args, 'object', false);\r\n\r\n        let duration = Quazar.getArg(args, 'duration', false);\r\n\r\n        let cancel = Quazar.getArg(args, 'cancel', false);\r\n\r\n        let repeat = Quazar.getArg(args, 'repeat', false);\r\n\r\n        let curve = Quazar.getArg(args, 'curve', 'Linear');\r\n\r\n\r\n        let targetObject = {};\r\n\r\n        targetObject[property] = target;\r\n\r\n        this.tweens.push({object, targetObject, property, duration, curve});\r\n\r\n\r\n\r\n    }\r\n\r\n    simultan()\r\n    {\r\n        Quazar.each(this.tweens, function (ix, item) {\r\n\r\n            console('');\r\n\r\n            item.start();\r\n\r\n        });\r\n\r\n    }\r\n    synchro()\r\n    {\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    start() {\r\n\r\n        this.tweenObject.start();\r\n\r\n\r\n    }\r\n\r\n    onUpdate(callback) {\r\n\r\n\r\n    }\r\n\r\n    onComplete(callback) {\r\n\r\n    }\r\n\r\n    resolveCurve(key) {\r\n\r\n    }\r\n\r\n    Curves() {\r\n\r\n        return $Q.TWEEN.Easing;\r\n\r\n    }\r\n\r\n\r\n    curveOptionsToArray() {\r\n        let cs = [];\r\n\r\n        Quazar.each(TWEEN.Easing, function (ix, item) {\r\n\r\n            if (item.hasOwnProperty('In')) {\r\n                cs.push(ix + '.In');\r\n\r\n            }\r\n\r\n            if (item.hasOwnProperty('Out')) {\r\n                cs.push(ix + '.Out');\r\n\r\n            }\r\n            if (item.hasOwnProperty('InOut')) {\r\n                cs.push(ix + '.InOut');\r\n\r\n            }\r\n\r\n\r\n        });\r\n\r\n\r\n        return cs;\r\n\r\n\r\n    }\r\n\r\n\r\n}\r\n;\r\n\r\n\r\n\r\n\r\nclass TextDisplay //show a text element\r\n{\r\n    constructor({font, size, text /*single text or array of text*/, color}) {\r\n\r\n\r\n    }\r\n\r\n    next() {\r\n\r\n    }\r\n\r\n    show() {\r\n\r\n    }\r\n}\r\n\r\nclass VideoDisplay //show a video sequence\r\n{\r\n    constructor({src, size}) {\r\n\r\n        this.domElement = undefined;\r\n\r\n        this.src = src || \"__NO-SRC!\";\r\n\r\n        this.size = new Vector3(size.x, size.y, size.z || 0);\r\n\r\n\r\n        Quazar.log('VideoDisplay():: TODO: create dom element');\r\n\r\n    }\r\n\r\n    play() {\r\n\r\n    }\r\n}\r\n\r\n\r\nlet Animation_Samples = [\r\n\r\n\r\n    function(){return  new Animation({\r\n        src: \"../assets/texture/2d/char/frogman1.png\",\r\n        duration: 1000, repeat: true,\r\n        parent: {},\r\n        frameSize: new Vector2(100, 120),\r\n        frameBounds: new VectorBounds(new Vector2(0, 0),\r\n            new Vector2(0, 0))\r\n    })}\r\n,\r\n\r\n    function(){return  new Animation({\r\n        src: \"../assets/texture/2d/char/frogman1.png\",\r\n        duration: 1000, repeat: true,\r\n        parent: {},\r\n        frameSize: new Vector2(100, 120),\r\n        frameBounds: new VectorBounds(new Vector2(0, 0),\r\n            new Vector2(0, 0))\r\n    })}\r\n\r\n];\r\n\r\n\r\nvar Sprite_Samples = [function() {\r\n\r\n\r\n\r\n    let frog = new Sprite('frog', 'a frog sprite');\r\n\r\n\r\n    frog.setAnimation(new Animation({\r\n        src: \"../assets/texture/2d/char/frogman1.png\",\r\n        duration: 1000, repeat: true,\r\n        parent: {},\r\n        frameSize: new Vector2(100, 120),\r\n        frameBounds: new VectorBounds(new Vector2(0, 0),\r\n            new Vector2(9, 0))\r\n    }));\r\n\r\n\r\nreturn frog;\r\n\r\n},\r\n\r\n\r\n    function(){\r\n\r\n\r\n\r\n\r\n        let barrel = new Sprite('barrel', 'a barrel, interactive sprite');\r\n\r\n\r\n        barrel.setAnimation(new Animation({\r\n            src: \"../assets/texture/2d/object/barrel1.png\",\r\n            duration: 1000, repeat: true,\r\n            parent: {},\r\n            frameSize: new Vector2(100, 100),\r\n            frameBounds: new VectorBounds(new Vector2(0, 0),\r\n                new Vector2(0, 0))\r\n        }));\r\n\r\n\r\n        return barrel;\r\n\r\n\r\n    }\r\n\r\n];\r\n\r\n\r\n__gameInstance.event_args_list = [];"]}